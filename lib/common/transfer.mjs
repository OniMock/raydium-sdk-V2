import r from"bn.js";var f=1e4;function x(e,n,s,d){if(n===void 0)return{amount:e,fee:void 0,expirationTime:void 0};let t=s.epoch<n.newerTransferFee.epoch?n.olderTransferFee:n.newerTransferFee,i=new r(t.maximumFee.toString()),u=s.epoch<n.newerTransferFee.epoch?(Number(n.newerTransferFee.epoch)*s.slotsInEpoch-s.absoluteSlot)*400/1e3:void 0;if(d)if(t.transferFeeBasisPoints===f){let a=new r(t.maximumFee.toString());return{amount:e.add(a),fee:a,expirationTime:u}}else{let a=F(e.mul(new r(f)),new r(f-t.transferFeeBasisPoints)),o=new r(t.maximumFee.toString()),m=a.sub(e).gt(o)?e.add(o):a,c=F(m.mul(new r(t.transferFeeBasisPoints)),new r(f)),w=c.gt(i)?i:c;return{amount:m,fee:w,expirationTime:u}}else{let a=F(e.mul(new r(t.transferFeeBasisPoints)),new r(f)),o=a.gt(i)?i:a;return{amount:e,fee:o,expirationTime:u}}}function h(e,n,s,d){if(n===void 0)return{amount:e,fee:void 0,expirationTime:void 0};let t={...n,olderTransferFee:{epoch:BigInt(n.olderTransferFee.epoch),maximumFee:BigInt(n.olderTransferFee.maximumFee),transferFeeBasisPoints:n.olderTransferFee.transferFeeBasisPoints},newerTransferFee:{epoch:BigInt(n.newerTransferFee.epoch),maximumFee:BigInt(n.newerTransferFee.maximumFee),transferFeeBasisPoints:n.newerTransferFee.transferFeeBasisPoints}},i=s.epoch<t.newerTransferFee.epoch?t.olderTransferFee:t.newerTransferFee,u=new r(i.maximumFee.toString()),a=s.epoch<t.newerTransferFee.epoch?(Number(t.newerTransferFee.epoch)*s.slotsInEpoch-s.absoluteSlot)*400/1e3:void 0;if(d)if(i.transferFeeBasisPoints===f){let o=new r(i.maximumFee.toString());return{amount:e.add(o),fee:o,expirationTime:a}}else{let o=F(e.mul(new r(f)),new r(f-i.transferFeeBasisPoints)),m=new r(i.maximumFee.toString()),c=o.sub(e).gt(m)?e.add(m):o,w=F(c.mul(new r(i.transferFeeBasisPoints)),new r(f)),T=w.gt(u)?u:w;return{amount:c,fee:T,expirationTime:a}}else{let o=F(e.mul(new r(i.transferFeeBasisPoints)),new r(f)),m=o.gt(u)?u:o;return{amount:e,fee:m,expirationTime:a}}}function N(e,n){return e===void 0?n:n===void 0?e:Math.min(e,n)}function F(e,n){let{div:s,mod:d}=e.divmod(n);return d.gt(new r(0))?s.add(new r(1)):s}function b(e,n){if(e.isZero())return new r(0);let s=e.div(n);return s.isZero()?new r(1):e.mod(n).gt(new r(0))?s.add(new r(1)):s}export{F as BNDivCeil,b as ceilDivBN,x as getTransferAmountFee,h as getTransferAmountFeeV2,N as minExpirationTime};
//# sourceMappingURL=transfer.mjs.map