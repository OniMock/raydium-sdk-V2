var kn=Object.defineProperty;var Bn=(n,e,t)=>e in n?kn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var qe=(n,e,t)=>(Bn(n,typeof e!="symbol"?e+"":e,t),t);import Q from"bn.js";var re=new Q(0),xe=new Q(1),_t=new Q(-1),Ge=new Q(1).shln(64),Ve=new Q(1).shln(128),In=Ge.sub(xe),it=64,vt=Ve.subn(1),ee=-443636,ie=-ee,ot=new Q("4295048016"),st=new Q("79226673521066979257578248091"),Pi=new Q("4295048017"),ki=new Q("79226673521066979257578248090"),Ot=16,Dt="59543866431248",Kt="184467440737095516",qt="15793534762490258745",Nn=new Q(10).pow(new Q(6));var Bi=new Q("18446744073700000000");import Ti from"bn.js";var Ae=9e15,ge=1e9,at="0123456789abcdef",We="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Xe="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ut={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ae,maxE:Ae,crypto:!1},Wt,ue,w=!0,ze="[DecimalError] ",pe=ze+"Invalid argument: ",Xt=ze+"Precision limit exceeded",Ht=ze+"crypto unavailable",zt="[object Decimal]",W=Math.floor,O=Math.pow,Sn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Cn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Ln=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,jt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ne=1e7,h=7,En=9007199254740991,Rn=We.length-1,ct=Xe.length-1,f={toStringTag:zt};f.absoluteValue=f.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),g(n)};f.ceil=function(){return g(new this.constructor(this),this.e+1,2)};f.clampedTo=f.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(pe+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};f.comparedTo=f.cmp=function(n){var e,t,r,i,o=this,s=o.d,a=(n=new o.constructor(n)).d,c=o.s,u=n.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==n.e)return o.e>n.e^c<0?1:-1;for(r=s.length,i=a.length,e=0,t=r<i?r:i;e<t;++e)if(s[e]!==a[e])return s[e]>a[e]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};f.cosine=f.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+h,r.rounding=1,t=Mn(r,$t(r,t)),r.precision=n,r.rounding=e,g(ue==2||ue==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};f.cubeRoot=f.cbrt=function(){var n,e,t,r,i,o,s,a,c,u,m=this,l=m.constructor;if(!m.isFinite()||m.isZero())return new l(m);for(w=!1,o=m.s*O(m.s*m,1/3),!o||Math.abs(o)==1/0?(t=G(m.d),n=m.e,(o=(n-t.length+1)%3)&&(t+=o==1||o==-2?"0":"00"),o=O(t,1/3),n=W((n+1)/3)-(n%3==(n<0?-1:2)),o==1/0?t="5e"+n:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new l(t),r.s=m.s):r=new l(o.toString()),s=(n=l.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(m),r=N(u.plus(m).times(a),u.plus(c),s+2,1),G(a.d).slice(0,s)===(t=G(r.d)).slice(0,s))if(t=t.slice(s-3,s+1),t=="9999"||!i&&t=="4999"){if(!i&&(g(a,n+1,0),a.times(a).times(a).eq(m))){r=a;break}s+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(g(r,n+1,1),e=!r.times(r).times(r).eq(m));break}return w=!0,g(r,n,l.rounding,e)};f.decimalPlaces=f.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-W(this.e/h))*h,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};f.dividedBy=f.div=function(n){return N(this,new this.constructor(n))};f.dividedToIntegerBy=f.divToInt=function(n){var e=this,t=e.constructor;return g(N(e,new t(n),0,1,1),t.precision,t.rounding)};f.equals=f.eq=function(n){return this.cmp(n)===0};f.floor=function(){return g(new this.constructor(this),this.e+1,3)};f.greaterThan=f.gt=function(n){return this.cmp(n)>0};f.greaterThanOrEqualTo=f.gte=function(n){var e=this.cmp(n);return e==1||e===0};f.hyperbolicCosine=f.cosh=function(){var n,e,t,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;t=s.precision,r=s.rounding,s.precision=t+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(n=Math.ceil(i/3),e=(1/Ze(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),o=Pe(s,1,o.times(e),new s(1),!0);for(var c,u=n,m=new s(8);u--;)c=o.times(o),o=a.minus(c.times(m.minus(c.times(m))));return g(o,s.precision=t,s.rounding=r,!0)};f.hyperbolicSine=f.sinh=function(){var n,e,t,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(e=o.precision,t=o.rounding,o.precision=e+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=Pe(o,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/Ze(5,n)),i=Pe(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);n--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=e,o.rounding=t,g(i,e,t,!0)};f.hyperbolicTangent=f.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,N(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};f.inverseCosine=f.acos=function(){var n,e=this,t=e.constructor,r=e.abs().cmp(1),i=t.precision,o=t.rounding;return r!==-1?r===0?e.isNeg()?te(t,i,o):new t(0):new t(NaN):e.isZero()?te(t,i+4,o).times(.5):(t.precision=i+6,t.rounding=1,e=e.asin(),n=te(t,i+4,o).times(.5),t.precision=i,t.rounding=o,n.minus(e))};f.inverseHyperbolicCosine=f.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,w=!1,t=t.times(t).minus(1).sqrt().plus(t),w=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};f.inverseHyperbolicSine=f.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,w=!1,t=t.times(t).plus(1).sqrt().plus(t),w=!0,r.precision=n,r.rounding=e,t.ln())};f.inverseHyperbolicTangent=f.atanh=function(){var n,e,t,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=o.precision,e=o.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?g(new o(i),n,e,!0):(o.precision=t=r-i.e,i=N(i.plus(1),new o(1).minus(i),t+n,1),o.precision=n+4,o.rounding=1,i=i.ln(),o.precision=n,o.rounding=e,i.times(.5))):new o(NaN)};f.inverseSine=f.asin=function(){var n,e,t,r,i=this,o=i.constructor;return i.isZero()?new o(i):(e=i.abs().cmp(1),t=o.precision,r=o.rounding,e!==-1?e===0?(n=te(o,t+4,r).times(.5),n.s=i.s,n):new o(NaN):(o.precision=t+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=t,o.rounding=r,i.times(2)))};f.inverseTangent=f.atan=function(){var n,e,t,r,i,o,s,a,c,u=this,m=u.constructor,l=m.precision,d=m.rounding;if(u.isFinite()){if(u.isZero())return new m(u);if(u.abs().eq(1)&&l+4<=ct)return s=te(m,l+4,d).times(.25),s.s=u.s,s}else{if(!u.s)return new m(NaN);if(l+4<=ct)return s=te(m,l+4,d).times(.5),s.s=u.s,s}for(m.precision=a=l+10,m.rounding=1,t=Math.min(28,a/h+2|0),n=t;n;--n)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(w=!1,e=Math.ceil(a/h),r=1,c=u.times(u),s=new m(u),i=u;n!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[e]!==void 0)for(n=e;s.d[n]===o.d[n]&&n--;);return t&&(s=s.times(2<<t-1)),w=!0,g(s,m.precision=l,m.rounding=d,!0)};f.isFinite=function(){return!!this.d};f.isInteger=f.isInt=function(){return!!this.d&&W(this.e/h)>this.d.length-2};f.isNaN=function(){return!this.s};f.isNegative=f.isNeg=function(){return this.s<0};f.isPositive=f.isPos=function(){return this.s>0};f.isZero=function(){return!!this.d&&this.d[0]===0};f.lessThan=f.lt=function(n){return this.cmp(n)<0};f.lessThanOrEqualTo=f.lte=function(n){return this.cmp(n)<1};f.logarithm=f.log=function(n){var e,t,r,i,o,s,a,c,u=this,m=u.constructor,l=m.precision,d=m.rounding,p=5;if(n==null)n=new m(10),e=!0;else{if(n=new m(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new m(NaN);e=n.eq(10)}if(t=u.d,u.s<0||!t||!t[0]||u.eq(1))return new m(t&&!t[0]?-1/0:u.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)o=!0;else{for(i=t[0];i%10===0;)i/=10;o=i!==1}if(w=!1,a=l+p,s=fe(u,a),r=e?He(m,a+10):fe(n,a),c=N(s,r,a,1),Se(c.d,i=l,d))do if(a+=10,s=fe(u,a),r=e?He(m,a+10):fe(n,a),c=N(s,r,a,1),!o){+G(c.d).slice(i+1,i+15)+1==1e14&&(c=g(c,l+1,0));break}while(Se(c.d,i+=10,d));return w=!0,g(c,l,d)};f.minus=f.sub=function(n){var e,t,r,i,o,s,a,c,u,m,l,d,p=this,T=p.constructor;if(n=new T(n),!p.d||!n.d)return!p.s||!n.s?n=new T(NaN):p.d?n.s=-n.s:n=new T(n.d||p.s!==n.s?p:NaN),n;if(p.s!=n.s)return n.s=-n.s,p.plus(n);if(u=p.d,d=n.d,a=T.precision,c=T.rounding,!u[0]||!d[0]){if(d[0])n.s=-n.s;else if(u[0])n=new T(p);else return new T(c===3?-0:0);return w?g(n,a,c):n}if(t=W(n.e/h),m=W(p.e/h),u=u.slice(),o=m-t,o){for(l=o<0,l?(e=u,o=-o,s=d.length):(e=d,t=m,s=u.length),r=Math.max(Math.ceil(a/h),s)+2,o>r&&(o=r,e.length=1),e.reverse(),r=o;r--;)e.push(0);e.reverse()}else{for(r=u.length,s=d.length,l=r<s,l&&(s=r),r=0;r<s;r++)if(u[r]!=d[r]){l=u[r]<d[r];break}o=0}for(l&&(e=u,u=d,d=e,n.s=-n.s),s=u.length,r=d.length-s;r>0;--r)u[s++]=0;for(r=d.length;r>o;){if(u[--r]<d[r]){for(i=r;i&&u[--i]===0;)u[i]=ne-1;--u[i],u[r]+=ne}u[r]-=d[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--t;return u[0]?(n.d=u,n.e=je(u,t),w?g(n,a,c):n):new T(c===3?-0:0)};f.modulo=f.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?g(new r(t),r.precision,r.rounding):(w=!1,r.modulo==9?(e=N(t,n.abs(),0,3,1),e.s*=n.s):e=N(t,n,0,r.modulo,1),e=e.times(n),w=!0,t.minus(e))};f.naturalExponential=f.exp=function(){return mt(this)};f.naturalLogarithm=f.ln=function(){return fe(this)};f.negated=f.neg=function(){var n=new this.constructor(this);return n.s=-n.s,g(n)};f.plus=f.add=function(n){var e,t,r,i,o,s,a,c,u,m,l=this,d=l.constructor;if(n=new d(n),!l.d||!n.d)return!l.s||!n.s?n=new d(NaN):l.d||(n=new d(n.d||l.s===n.s?l:NaN)),n;if(l.s!=n.s)return n.s=-n.s,l.minus(n);if(u=l.d,m=n.d,a=d.precision,c=d.rounding,!u[0]||!m[0])return m[0]||(n=new d(l)),w?g(n,a,c):n;if(o=W(l.e/h),r=W(n.e/h),u=u.slice(),i=o-r,i){for(i<0?(t=u,i=-i,s=m.length):(t=m,r=o,s=u.length),o=Math.ceil(a/h),s=o>s?o+1:s+1,i>s&&(i=s,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(s=u.length,i=m.length,s-i<0&&(i=s,t=m,m=u,u=t),e=0;i;)e=(u[--i]=u[i]+m[i]+e)/ne|0,u[i]%=ne;for(e&&(u.unshift(e),++r),s=u.length;u[--s]==0;)u.pop();return n.d=u,n.e=je(u,r),w?g(n,a,c):n};f.precision=f.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(pe+n);return t.d?(e=Zt(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};f.round=function(){var n=this,e=n.constructor;return g(new e(n),n.e+1,e.rounding)};f.sine=f.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+h,r.rounding=1,t=_n(r,$t(r,t)),r.precision=n,r.rounding=e,g(ue>2?t.neg():t,n,e,!0)):new r(NaN)};f.squareRoot=f.sqrt=function(){var n,e,t,r,i,o,s=this,a=s.d,c=s.e,u=s.s,m=s.constructor;if(u!==1||!a||!a[0])return new m(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(w=!1,u=Math.sqrt(+s),u==0||u==1/0?(e=G(a),(e.length+c)%2==0&&(e+="0"),u=Math.sqrt(e),c=W((c+1)/2)-(c<0||c%2),u==1/0?e="5e"+c:(e=u.toExponential(),e=e.slice(0,e.indexOf("e")+1)+c),r=new m(e)):r=new m(u.toString()),t=(c=m.precision)+3;;)if(o=r,r=o.plus(N(s,o,t+2,1)).times(.5),G(o.d).slice(0,t)===(e=G(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(g(o,c+1,0),o.times(o).eq(s))){r=o;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(g(r,c+1,1),n=!r.times(r).eq(s));break}return w=!0,g(r,c,m.rounding,n)};f.tangent=f.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=N(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,g(ue==2||ue==4?t.neg():t,n,e,!0)):new r(NaN)};f.times=f.mul=function(n){var e,t,r,i,o,s,a,c,u,m=this,l=m.constructor,d=m.d,p=(n=new l(n)).d;if(n.s*=m.s,!d||!d[0]||!p||!p[0])return new l(!n.s||d&&!d[0]&&!p||p&&!p[0]&&!d?NaN:!d||!p?n.s/0:n.s*0);for(t=W(m.e/h)+W(n.e/h),c=d.length,u=p.length,c<u&&(o=d,d=p,p=o,s=c,c=u,u=s),o=[],s=c+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(e=0,i=c+r;i>r;)a=o[i]+p[r]*d[i-r-1]+e,o[i--]=a%ne|0,e=a/ne|0;o[i]=(o[i]+e)%ne|0}for(;!o[--s];)o.pop();return e?++t:o.shift(),n.d=o,n.e=je(o,t),w?g(n,l.precision,l.rounding):n};f.toBinary=function(n,e){return dt(this,2,n,e)};f.toDecimalPlaces=f.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(z(n,0,ge),e===void 0?e=r.rounding:z(e,0,8),g(t,n+t.e+1,e))};f.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=oe(r,!0):(z(n,0,ge),e===void 0?e=i.rounding:z(e,0,8),r=g(new i(r),n+1,e),t=oe(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};f.toFixed=function(n,e){var t,r,i=this,o=i.constructor;return n===void 0?t=oe(i):(z(n,0,ge),e===void 0?e=o.rounding:z(e,0,8),r=g(new o(i),n+i.e+1,e),t=oe(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};f.toFraction=function(n){var e,t,r,i,o,s,a,c,u,m,l,d,p=this,T=p.d,b=p.constructor;if(!T)return new b(p);if(u=t=new b(1),r=c=new b(0),e=new b(r),o=e.e=Zt(T)-p.e-1,s=o%h,e.d[0]=O(10,s<0?h+s:s),n==null)n=o>0?e:u;else{if(a=new b(n),!a.isInt()||a.lt(u))throw Error(pe+a);n=a.gt(e)?o>0?e:u:a}for(w=!1,a=new b(G(T)),m=b.precision,b.precision=o=T.length*h*2;l=N(a,e,0,1,1),i=t.plus(l.times(r)),i.cmp(n)!=1;)t=r,r=i,i=u,u=c.plus(l.times(i)),c=i,i=e,e=a.minus(l.times(i)),a=i;return i=N(n.minus(t),r,0,1,1),c=c.plus(i.times(u)),t=t.plus(i.times(r)),c.s=u.s=p.s,d=N(u,r,o,1).minus(p).abs().cmp(N(c,t,o,1).minus(p).abs())<1?[u,r]:[c,t],b.precision=m,w=!0,d};f.toHexadecimal=f.toHex=function(n,e){return dt(this,16,n,e)};f.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:z(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(w=!1,t=N(t,n,0,e,1).times(n),w=!0,g(t)):(n.s=t.s,t=n),t};f.toNumber=function(){return+this};f.toOctal=function(n,e){return dt(this,8,n,e)};f.toPower=f.pow=function(n){var e,t,r,i,o,s,a=this,c=a.constructor,u=+(n=new c(n));if(!a.d||!n.d||!a.d[0]||!n.d[0])return new c(O(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,o=c.rounding,n.eq(1))return g(a,r,o);if(e=W(n.e/h),e>=n.d.length-1&&(t=u<0?-u:u)<=En)return i=Qt(c,a,t,r),n.s<0?new c(1).div(i):g(i,r,o);if(s=a.s,s<0){if(e<n.d.length-1)return new c(NaN);if((n.d[e]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return t=O(+a,u),e=t==0||!isFinite(t)?W(u*(Math.log("0."+G(a.d))/Math.LN10+a.e+1)):new c(t+"").e,e>c.maxE+1||e<c.minE-1?new c(e>0?s/0:0):(w=!1,c.rounding=a.s=1,t=Math.min(12,(e+"").length),i=mt(n.times(fe(a,r+t)),r),i.d&&(i=g(i,r+5,1),Se(i.d,r,o)&&(e=r+10,i=g(mt(n.times(fe(a,e+t)),e),e+5,1),+G(i.d).slice(r+1,r+15)+1==1e14&&(i=g(i,r+1,0)))),i.s=s,w=!0,c.rounding=o,g(i,r,o))};f.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=oe(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(z(n,1,ge),e===void 0?e=i.rounding:z(e,0,8),r=g(new i(r),n,e),t=oe(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};f.toSignificantDigits=f.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(z(n,1,ge),e===void 0?e=r.rounding:z(e,0,8)),g(new r(t),n,e)};f.toString=function(){var n=this,e=n.constructor,t=oe(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};f.truncated=f.trunc=function(){return g(new this.constructor(this),this.e+1,1)};f.valueOf=f.toJSON=function(){var n=this,e=n.constructor,t=oe(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function G(n){var e,t,r,i=n.length-1,o="",s=n[0];if(i>0){for(o+=s,e=1;e<i;e++)r=n[e]+"",t=h-r.length,t&&(o+=de(t)),o+=r;s=n[e],r=s+"",t=h-r.length,t&&(o+=de(t))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function z(n,e,t){if(n!==~~n||n<e||n>t)throw Error(pe+n)}function Se(n,e,t,r){var i,o,s,a;for(o=n[0];o>=10;o/=10)--e;return--e<0?(e+=h,i=0):(i=Math.ceil((e+1)/h),e%=h),o=O(10,h-e),a=n[i]%o|0,r==null?e<3?(e==0?a=a/100|0:e==1&&(a=a/10|0),s=t<4&&a==99999||t>3&&a==49999||a==5e4||a==0):s=(t<4&&a+1==o||t>3&&a+1==o/2)&&(n[i+1]/o/100|0)==O(10,e-2)-1||(a==o/2||a==0)&&(n[i+1]/o/100|0)==0:e<4?(e==0?a=a/1e3|0:e==1?a=a/100|0:e==2&&(a=a/10|0),s=(r||t<4)&&a==9999||!r&&t>3&&a==4999):s=((r||t<4)&&a+1==o||!r&&t>3&&a+1==o/2)&&(n[i+1]/o/1e3|0)==O(10,e-3)-1,s}function Ue(n,e,t){for(var r,i=[0],o,s=0,a=n.length;s<a;){for(o=i.length;o--;)i[o]*=e;for(i[0]+=at.indexOf(n.charAt(s++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function Mn(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/Ze(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=Pe(n,1,e.times(i),new n(1));for(var o=t;o--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return n.precision-=t,e}var N=function(){function n(r,i,o){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+a,r[c]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function e(r,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function t(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,c){var u,m,l,d,p,T,b,q,L,J,I,V,ve,ae,tt,Oe,Ne,nt,$,De,Ke=r.constructor,rt=r.s==i.s?1:-1,U=r.d,S=i.d;if(!U||!U[0]||!S||!S[0])return new Ke(!r.s||!i.s||(U?S&&U[0]==S[0]:!S)?NaN:U&&U[0]==0||!S?rt*0:rt/0);for(c?(p=1,m=r.e-i.e):(c=ne,p=h,m=W(r.e/p)-W(i.e/p)),$=S.length,Ne=U.length,L=new Ke(rt),J=L.d=[],l=0;S[l]==(U[l]||0);l++);if(S[l]>(U[l]||0)&&m--,o==null?(ae=o=Ke.precision,s=Ke.rounding):a?ae=o+(r.e-i.e)+1:ae=o,ae<0)J.push(1),T=!0;else{if(ae=ae/p+2|0,l=0,$==1){for(d=0,S=S[0],ae++;(l<Ne||d)&&ae--;l++)tt=d*c+(U[l]||0),J[l]=tt/S|0,d=tt%S|0;T=d||l<Ne}else{for(d=c/(S[0]+1)|0,d>1&&(S=n(S,d,c),U=n(U,d,c),$=S.length,Ne=U.length),Oe=$,I=U.slice(0,$),V=I.length;V<$;)I[V++]=0;De=S.slice(),De.unshift(0),nt=S[0],S[1]>=c/2&&++nt;do d=0,u=e(S,I,$,V),u<0?(ve=I[0],$!=V&&(ve=ve*c+(I[1]||0)),d=ve/nt|0,d>1?(d>=c&&(d=c-1),b=n(S,d,c),q=b.length,V=I.length,u=e(b,I,q,V),u==1&&(d--,t(b,$<q?De:S,q,c))):(d==0&&(u=d=1),b=S.slice()),q=b.length,q<V&&b.unshift(0),t(I,b,V,c),u==-1&&(V=I.length,u=e(S,I,$,V),u<1&&(d++,t(I,$<V?De:S,V,c))),V=I.length):u===0&&(d++,I=[0]),J[l++]=d,u&&I[0]?I[V++]=U[Oe]||0:(I=[U[Oe]],V=1);while((Oe++<Ne||I[0]!==void 0)&&ae--);T=I[0]!==void 0}J[0]||J.shift()}if(p==1)L.e=m,Wt=T;else{for(l=1,d=J[0];d>=10;d/=10)l++;L.e=l+m*p-1,g(L,a?o+L.e+1:o,s,T)}return L}}();function g(n,e,t,r){var i,o,s,a,c,u,m,l,d,p=n.constructor;e:if(e!=null){if(l=n.d,!l)return n;for(i=1,a=l[0];a>=10;a/=10)i++;if(o=e-i,o<0)o+=h,s=e,m=l[d=0],c=m/O(10,i-s-1)%10|0;else if(d=Math.ceil((o+1)/h),a=l.length,d>=a)if(r){for(;a++<=d;)l.push(0);m=c=0,i=1,o%=h,s=o-h+1}else break e;else{for(m=a=l[d],i=1;a>=10;a/=10)i++;o%=h,s=o-h+i,c=s<0?0:m/O(10,i-s-1)%10|0}if(r=r||e<0||l[d+1]!==void 0||(s<0?m:m%O(10,i-s-1)),u=t<4?(c||r)&&(t==0||t==(n.s<0?3:2)):c>5||c==5&&(t==4||r||t==6&&(o>0?s>0?m/O(10,i-s):0:l[d-1])%10&1||t==(n.s<0?8:7)),e<1||!l[0])return l.length=0,u?(e-=n.e+1,l[0]=O(10,(h-e%h)%h),n.e=-e||0):l[0]=n.e=0,n;if(o==0?(l.length=d,a=1,d--):(l.length=d+1,a=O(10,h-o),l[d]=s>0?(m/O(10,i-s)%O(10,s)|0)*a:0),u)for(;;)if(d==0){for(o=1,s=l[0];s>=10;s/=10)o++;for(s=l[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(n.e++,l[0]==ne&&(l[0]=1));break}else{if(l[d]+=a,l[d]!=ne)break;l[d--]=0,a=1}for(o=l.length;l[--o]===0;)l.pop()}return w&&(n.e>p.maxE?(n.d=null,n.e=NaN):n.e<p.minE&&(n.e=0,n.d=[0])),n}function oe(n,e,t){if(!n.isFinite())return Jt(n);var r,i=n.e,o=G(n.d),s=o.length;return e?(t&&(r=t-s)>0?o=o.charAt(0)+"."+o.slice(1)+de(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(n.e<0?"e":"e+")+n.e):i<0?(o="0."+de(-i-1)+o,t&&(r=t-s)>0&&(o+=de(r))):i>=s?(o+=de(i+1-s),t&&(r=t-i-1)>0&&(o=o+"."+de(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),t&&(r=t-s)>0&&(i+1===s&&(o+="."),o+=de(r))),o}function je(n,e){var t=n[0];for(e*=h;t>=10;t/=10)e++;return e}function He(n,e,t){if(e>Rn)throw w=!0,t&&(n.precision=t),Error(Xt);return g(new n(We),e,1,!0)}function te(n,e,t){if(e>ct)throw Error(Xt);return g(new n(Xe),e,t,!0)}function Zt(n){var e=n.length-1,t=e*h+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function de(n){for(var e="";n--;)e+="0";return e}function Qt(n,e,t,r){var i,o=new n(1),s=Math.ceil(r/h+4);for(w=!1;;){if(t%2&&(o=o.times(e),Vt(o.d,s)&&(i=!0)),t=W(t/2),t===0){t=o.d.length-1,i&&o.d[t]===0&&++o.d[t];break}e=e.times(e),Vt(e.d,s)}return w=!0,o}function Gt(n){return n.d[n.d.length-1]&1}function Yt(n,e,t){for(var r,i=new n(e[0]),o=0;++o<e.length;)if(r=new n(e[o]),r.s)i[t](r)&&(i=r);else{i=r;break}return i}function mt(n,e){var t,r,i,o,s,a,c,u=0,m=0,l=0,d=n.constructor,p=d.rounding,T=d.precision;if(!n.d||!n.d[0]||n.e>17)return new d(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:0/0);for(e==null?(w=!1,c=T):c=e,a=new d(.03125);n.e>-2;)n=n.times(a),l+=5;for(r=Math.log(O(2,l))/Math.LN10*2+5|0,c+=r,t=o=s=new d(1),d.precision=c;;){if(o=g(o.times(n),c,1),t=t.times(++m),a=s.plus(N(o,t,c,1)),G(a.d).slice(0,c)===G(s.d).slice(0,c)){for(i=l;i--;)s=g(s.times(s),c,1);if(e==null)if(u<3&&Se(s.d,c-r,p,u))d.precision=c+=10,t=o=a=new d(1),m=0,u++;else return g(s,d.precision=T,p,w=!0);else return d.precision=T,s}s=a}}function fe(n,e){var t,r,i,o,s,a,c,u,m,l,d,p=1,T=10,b=n,q=b.d,L=b.constructor,J=L.rounding,I=L.precision;if(b.s<0||!q||!q[0]||!b.e&&q[0]==1&&q.length==1)return new L(q&&!q[0]?-1/0:b.s!=1?NaN:q?0:b);if(e==null?(w=!1,m=I):m=e,L.precision=m+=T,t=G(q),r=t.charAt(0),Math.abs(o=b.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)b=b.times(n),t=G(b.d),r=t.charAt(0),p++;o=b.e,r>1?(b=new L("0."+t),o++):b=new L(r+"."+t.slice(1))}else return u=He(L,m+2,I).times(o+""),b=fe(new L(r+"."+t.slice(1)),m-T).plus(u),L.precision=I,e==null?g(b,I,J,w=!0):b;for(l=b,c=s=b=N(b.minus(1),b.plus(1),m,1),d=g(b.times(b),m,1),i=3;;){if(s=g(s.times(d),m,1),u=c.plus(N(s,new L(i),m,1)),G(u.d).slice(0,m)===G(c.d).slice(0,m))if(c=c.times(2),o!==0&&(c=c.plus(He(L,m+2,I).times(o+""))),c=N(c,new L(p),m,1),e==null)if(Se(c.d,m-T,J,a))L.precision=m+=T,u=s=b=N(l.minus(1),l.plus(1),m,1),d=g(b.times(b),m,1),i=a=1;else return g(c,L.precision=I,J,w=!0);else return L.precision=I,c;c=u,i+=2}}function Jt(n){return String(n.s*n.s/0)}function lt(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%h,t<0&&(r+=h),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=h;r<i;)n.d.push(+e.slice(r,r+=h));e=e.slice(r),r=h-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),w&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function Fn(n,e){var t,r,i,o,s,a,c,u,m;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),jt.test(e))return lt(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(Cn.test(e))t=16,e=e.toLowerCase();else if(Sn.test(e))t=2;else if(Ln.test(e))t=8;else throw Error(pe+e);for(o=e.search(/p/i),o>0?(c=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),s=o>=0,r=n.constructor,s&&(e=e.replace(".",""),a=e.length,o=a-o,i=Qt(r,new r(t),o,o*2)),u=Ue(e,t,ne),m=u.length-1,o=m;u[o]===0;--o)u.pop();return o<0?new r(n.s*0):(n.e=je(u,m),n.d=u,w=!1,s&&(n=N(n,i,a*4)),c&&(n=n.times(Math.abs(c)<54?O(2,c):Ce.pow(2,c))),w=!0,n)}function _n(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:Pe(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/Ze(5,t)),e=Pe(n,2,e,e);for(var i,o=new n(5),s=new n(16),a=new n(20);t--;)i=e.times(e),e=e.times(o.plus(i.times(s.times(i).minus(a))));return e}function Pe(n,e,t,r,i){var o,s,a,c,u=1,m=n.precision,l=Math.ceil(m/h);for(w=!1,c=t.times(t),a=new n(r);;){if(s=N(a.times(c),new n(e++*e++),m,1),a=i?r.plus(s):r.minus(s),r=N(s.times(c),new n(e++*e++),m,1),s=a.plus(r),s.d[l]!==void 0){for(o=l;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,u++}return w=!0,s.d.length=l+1,s}function Ze(n,e){for(var t=n;--e;)t*=n;return t}function $t(n,e){var t,r=e.s<0,i=te(n,n.precision,1),o=i.times(.5);if(e=e.abs(),e.lte(o))return ue=r?4:1,e;if(t=e.divToInt(i),t.isZero())ue=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(o))return ue=Gt(t)?r?2:3:r?4:1,e;ue=Gt(t)?r?1:4:r?3:2}return e.minus(i).abs()}function dt(n,e,t,r){var i,o,s,a,c,u,m,l,d,p=n.constructor,T=t!==void 0;if(T?(z(t,1,ge),r===void 0?r=p.rounding:z(r,0,8)):(t=p.precision,r=p.rounding),!n.isFinite())m=Jt(n);else{for(m=oe(n),s=m.indexOf("."),T?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,s>=0&&(m=m.replace(".",""),d=new p(1),d.e=m.length-s,d.d=Ue(oe(d),10,i),d.e=d.d.length),l=Ue(m,10,i),o=c=l.length;l[--c]==0;)l.pop();if(!l[0])m=T?"0p+0":"0";else{if(s<0?o--:(n=new p(n),n.d=l,n.e=o,n=N(n,d,t,r,0,i),l=n.d,o=n.e,u=Wt),s=l[t],a=i/2,u=u||l[t+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(n.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&l[t-1]&1||r===(n.s<0?8:7)),l.length=t,u)for(;++l[--t]>i-1;)l[t]=0,t||(++o,l.unshift(1));for(c=l.length;!l[c-1];--c);for(s=0,m="";s<c;s++)m+=at.charAt(l[s]);if(T){if(c>1)if(e==16||e==8){for(s=e==16?4:3,--c;c%s;c++)m+="0";for(l=Ue(m,i,e),c=l.length;!l[c-1];--c);for(s=1,m="1.";s<c;s++)m+=at.charAt(l[s])}else m=m.charAt(0)+"."+m.slice(1);m=m+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)m="0"+m;m="0."+m}else if(++o>c)for(o-=c;o--;)m+="0";else o<c&&(m=m.slice(0,o)+"."+m.slice(o))}m=(e==16?"0x":e==2?"0b":e==8?"0o":"")+m}return n.s<0?"-"+m:m}function Vt(n,e){if(n.length>e)return n.length=e,!0}function vn(n){return new this(n).abs()}function On(n){return new this(n).acos()}function Dn(n){return new this(n).acosh()}function Kn(n,e){return new this(n).plus(e)}function qn(n){return new this(n).asin()}function Gn(n){return new this(n).asinh()}function Vn(n){return new this(n).atan()}function Un(n){return new this(n).atanh()}function Wn(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,o=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=te(this,o,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?te(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=te(this,o,1).times(.5),t.s=n.s):e.s<0?(this.precision=o,this.rounding=1,t=this.atan(N(n,e,o,1)),e=te(this,o,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(N(n,e,o,1)),t}function Xn(n){return new this(n).cbrt()}function Hn(n){return g(n=new this(n),n.e+1,2)}function zn(n,e,t){return new this(n).clamp(e,t)}function jn(n){if(!n||typeof n!="object")throw Error(ze+"Object expected");var e,t,r,i=n.defaults===!0,o=["precision",1,ge,"rounding",0,8,"toExpNeg",-Ae,0,"toExpPos",0,Ae,"maxE",0,Ae,"minE",-Ae,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(t=o[e],i&&(this[t]=ut[t]),(r=n[t])!==void 0)if(W(r)===r&&r>=o[e+1]&&r<=o[e+2])this[t]=r;else throw Error(pe+t+": "+r);if(t="crypto",i&&(this[t]=ut[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(Ht);else this[t]=!1;else throw Error(pe+t+": "+r);return this}function Zn(n){return new this(n).cos()}function Qn(n){return new this(n).cosh()}function en(n){var e,t,r;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,Ut(o)){u.s=o.s,w?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;w?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return lt(u,o.toString())}else if(c!=="string")throw Error(pe+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),jt.test(o)?lt(u,o):Fn(u,o)}if(i.prototype=f,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=jn,i.clone=en,i.isDecimal=Ut,i.abs=vn,i.acos=On,i.acosh=Dn,i.add=Kn,i.asin=qn,i.asinh=Gn,i.atan=Vn,i.atanh=Un,i.atan2=Wn,i.cbrt=Xn,i.ceil=Hn,i.clamp=zn,i.cos=Zn,i.cosh=Qn,i.div=Yn,i.exp=Jn,i.floor=$n,i.hypot=er,i.ln=tr,i.log=nr,i.log10=ir,i.log2=rr,i.max=or,i.min=sr,i.mod=ar,i.mul=ur,i.pow=cr,i.random=mr,i.round=lr,i.sign=dr,i.sin=fr,i.sinh=pr,i.sqrt=gr,i.sub=hr,i.sum=br,i.tan=wr,i.tanh=yr,i.trunc=Tr,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function Yn(n,e){return new this(n).div(e)}function Jn(n){return new this(n).exp()}function $n(n){return g(n=new this(n),n.e+1,3)}function er(){var n,e,t=new this(0);for(w=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return w=!0,new this(1/0);t=e}return w=!0,t.sqrt()}function Ut(n){return n instanceof Ce||n&&n.toStringTag===zt||!1}function tr(n){return new this(n).ln()}function nr(n,e){return new this(n).log(e)}function rr(n){return new this(n).log(2)}function ir(n){return new this(n).log(10)}function or(){return Yt(this,arguments,"lt")}function sr(){return Yt(this,arguments,"gt")}function ar(n,e){return new this(n).mod(e)}function ur(n,e){return new this(n).mul(e)}function cr(n,e){return new this(n).pow(e)}function mr(n){var e,t,r,i,o=0,s=new this(1),a=[];if(n===void 0?n=this.precision:z(n,1,ge),r=Math.ceil(n/h),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));o<r;)i=e[o],i>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);o<r;)i=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((e[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(Ht);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],n%=h,r&&n&&(i=O(10,h-n),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)t=0,a=[0];else{for(t=-1;a[0]===0;t-=h)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<h&&(t-=h-r)}return s.e=t,s.d=a,s}function lr(n){return g(n=new this(n),n.e+1,this.rounding)}function dr(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function fr(n){return new this(n).sin()}function pr(n){return new this(n).sinh()}function gr(n){return new this(n).sqrt()}function hr(n,e){return new this(n).sub(e)}function br(){var n=0,e=arguments,t=new this(e[n]);for(w=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return w=!0,g(t,this.precision,this.rounding)}function wr(n){return new this(n).tan()}function yr(n){return new this(n).tanh()}function Tr(n){return g(n=new this(n),n.e+1,1)}f[Symbol.for("nodejs.util.inspect.custom")]=f.toString;f[Symbol.toStringTag]="Decimal";var Ce=f.constructor=en(ut);We=new Ce(We);Xe=new Ce(Xe);var X=Ce;import B from"bn.js";import Ci from"bn.js";import{PublicKey as Pr}from"@solana/web3.js";import{get as tn,set as xr}from"lodash";var ft=class{logLevel;name;constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},nn={},Ar={};function Y(n){let e=tn(nn,n);if(!e){let t=tn(Ar,n);e=new ft({name:n,logLevel:t}),xr(nn,n,e)}return e}import{MINT_SIZE as qi,TOKEN_PROGRAM_ID as Gi,getTransferFeeConfig as Vi,unpackMint as Ui}from"@solana/spl-token";var pt=Y("Raydium_accountInfo_util");async function Qe(n,e,t){let{batchRequest:r,commitment:i="confirmed",chunkCount:o=100}={batchRequest:!1,...t},s=gt(e,o),a=new Array(s.length).fill([]);if(r){let c=s.map(l=>{let d=n._buildArgs([l.map(p=>p.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:d}}),u=gt(c,10);a=(await(await Promise.all(u.map(async l=>await n._rpcBatchRequest(l)))).flat()).map(l=>(l.error&&pt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${l.error.message}`),l.result.value.map(d=>{if(d){let{data:p,executable:T,lamports:b,owner:q,rentEpoch:L}=d;return p.length!==2&&p[1]!=="base64"&&pt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:T,lamports:b,owner:new Pr(q),rentEpoch:L}}return null})))}else try{a=await Promise.all(s.map(c=>n.getMultipleAccountsInfo(c,i)))}catch(c){c instanceof Error&&pt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}import me from"bn.js";import Rr from"big.js";import so from"bn.js";import Br from"toformat";var Ir=Br,Le=Ir;import Je from"big.js";import Sr from"bn.js";import Cr from"decimal.js-light";import Ee from"bn.js";var rn=9007199254740991;function ce(n){let e=Y("Raydium_parseBigNumberish");if(n instanceof Ee)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new Ee(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=rn||n<=-rn)&&e.logWithError(`BigNumberish number overflow: ${n}`),new Ee(String(n))):typeof n=="bigint"?new Ee(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new Ee(0))}var Ye=Y("module/fraction"),bt=Le(Je),Re=Le(Cr),Lr={[0]:Re.ROUND_DOWN,[1]:Re.ROUND_HALF_UP,[2]:Re.ROUND_UP},Er={[0]:Je.roundDown,[1]:Je.roundHalfUp,[2]:Je.roundUp},E=class{numerator;denominator;constructor(e,t=new Sr(1)){this.numerator=ce(e),this.denominator=ce(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new E(this.denominator,this.numerator)}add(e){let t=e instanceof E?e:new E(ce(e));return this.denominator.eq(t.denominator)?new E(this.numerator.add(t.numerator),this.denominator):new E(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof E?e:new E(ce(e));return this.denominator.eq(t.denominator)?new E(this.numerator.sub(t.numerator),this.denominator):new E(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof E?e:new E(ce(e));return new E(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof E?e:new E(ce(e));return new E(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||Ye.logWithError(`${e} is not an integer.`),e<=0&&Ye.logWithError(`${e} is not positive.`),Re.set({precision:e+1,rounding:Lr[r]});let i=new Re(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||Ye.logWithError(`${e} is not an integer.`),e<0&&Ye.logWithError(`${e} is negative.`),bt.DP=e,bt.RM=Er[r]||1,new bt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var ho=Y("Raydium_amount"),bo=Le(Rr);import{PublicKey as Fr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as on}from"@solana/spl-token";var sn={chainId:101,address:Fr.default.toBase58(),programId:on.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},be={chainId:101,address:"So11111111111111111111111111111111111111112",programId:on.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as yt}from"@solana/web3.js";import{PublicKey as R,SystemProgram as an,SYSVAR_RENT_PUBKEY as _r}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as vr}from"@solana/spl-token";function wt({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var Bo=[wt({pubkey:vr,isWritable:!1}),wt({pubkey:an.programId,isWritable:!1}),wt({pubkey:_r,isWritable:!1})];function un({publicKey:n,transformSol:e}){let t=cn(n.toString());if(t instanceof R)return e&&t.equals(Me)?ht:t;if(e&&t.toString()===Me.toBase58())return ht;if(typeof t=="string"){if(t===R.default.toBase58())return R.default;try{return new R(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function cn(n){try{return new R(n)}catch{return n}}var Io=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),No=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),So=new R("SysvarRent111111111111111111111111111111111"),Co=new R("SysvarC1ock11111111111111111111111111111111"),Or=new R("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Lo=new R("Sysvar1nstructions1111111111111111111111111"),Eo=an.programId,Ro=new R("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Mo=new R("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Fo=new R("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),_o=new R("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),vo=new R("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Oo=new R("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Do=new R("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Ko=new R("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),qo=new R("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Go=new R("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Vo=new R("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ht=new R("So11111111111111111111111111111111111111112"),Me=R.default;var Tt=class{symbol;name;decimals;isToken2022;mint;constructor({mint:e,decimals:t,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(e===Me.toBase58()||e instanceof yt&&Me.equals(e)){this.decimals=be.decimals,this.symbol=be.symbol,this.name=be.name,this.mint=new yt(be.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=o?yt.default:un({publicKey:e}),this.isToken2022=s}equals(e){return this===e?!0:this.mint.equals(e.mint)}},we=Tt;qe(we,"WSOL",new Tt({...be,mint:be.address}));var xt=class{symbol;name;decimals;constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},$e=xt;qe($e,"SOL",new xt(sn));import Dr from"bn.js";var es=new E(new Dr(100));var ss=Y("Raydium_price");import{PublicKey as Ps}from"@solana/web3.js";import Bs from"bn.js";var Kr=new me(0),Us=new me(1),Ws=new me(2),Xs=new me(3),Hs=new me(5),Mr=new me(10),zs=new me(100),js=new me(1e3),Zs=new me(1e4);function gt(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}import{PublicKey as ya}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as xa}from"@solana/spl-token";import{ComputeBudgetProgram as ra,Keypair as sa,PublicKey as Gr,Transaction as ua,TransactionMessage as ma,VersionedTransaction as la}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as ga}from"@solana/spl-token";var ha=Y("Raydium_txUtil");function Bt(n,e){let[t,r]=Gr.findProgramAddressSync(n,e);return{publicKey:t,nonce:r}}import{PublicKey as y}from"@solana/web3.js";var Ba=new y("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Ia=new y("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Na=new y("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Sa=new y("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Ca=new y("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),La=new y("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Ea=new y("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Ra=new y("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Ma=new y("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Fa=new y("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),_a=new y("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),va=new y("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Oa=new y("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Da=new y("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ka=new y("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),qa=new y("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Ga=new y("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Va=new y("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Ua=new y("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Wa=new y("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Xa=new y("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Ha=new y("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Vr=new y("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),Ur=new y("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),Wr=new y("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),za=new y("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Xr=new y("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),ja=new y("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Hr=new y("7AFUeLVRjBfzqK3tTGw8hN48KLQWSk6DTE8xprWdPqix"),Za=new y("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Qa=new y("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),zr=new y("LanD8FpTBBvzZFXjTxsAoipkFsxPUCDB4qAqKxYDiNP"),jr=new y("HYNHiyKJ3gGVFvyxJAurK7qr7P2o5J9THmvCGMdULtpW");var Ya={SERUM_MARKET:y.default,OPENBOOK_MARKET:new y("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:y.default,FarmV3:new y("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new y("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new y("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new y("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new y("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new y("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),CLMM_LOCK_PROGRAM_ID:new y("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),CLMM_LOCK_AUTH_ID:new y("8qmHNvu2Kr2C7U8mJL4Vz1vTDxMhVuXKREwU7TNoaVEo"),Router:new y("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:Vr,CREATE_CPMM_POOL_AUTH:Ur,CREATE_CPMM_POOL_FEE_ACC:Wr,FEE_DESTINATION_ID:new y("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR"),LOCK_CPMM_PROGRAM:Xr,LCOK_CPMM_AUTH:Hr,LAUNCHPAD_PROGRAM:zr,LAUNCHPAD_AUTH:jr};import{PublicKey as Zr,AddressLookupTableAccount as mn}from"@solana/web3.js";var Qr={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new mn({key:new Zr("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:mn.deserialize(Buffer.from("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","base64"))})};import{PublicKey as pu,sendAndConfirmTransaction as gu,SystemProgram as wu,Transaction as yu,TransactionMessage as xu,VersionedTransaction as Au}from"@solana/web3.js";import ku from"axios";import Yr from"bn.js";var Eu=new Yr(1e6);function ln(n){let e=new ArrayBuffer(4);return new DataView(e).setInt32(0,n,!1),new Uint8Array(e)}function It(n,e){let t=0;for(let r=n-1;r>=0&&!e.testn(r);r--)t++;return t}function Nt(n,e){let t=0;for(let r=0;r<n&&!e.testn(r);r++)t++;return t}function Fe(n,e){for(let t=0;t<n;t++)if(e.testn(t))return!1;return!0}function dn(n,e){return Fe(n,e)?null:It(n,e)}function fn(n,e){return Fe(n,e)?null:Nt(n,e)}var nc=Buffer.from("amm_config","utf8"),rc=Buffer.from("pool","utf8"),ic=Buffer.from("pool_vault","utf8"),oc=Buffer.from("pool_reward_vault","utf8"),sc=Buffer.from("position","utf8"),Jr=Buffer.from("tick_array","utf8"),ac=Buffer.from("operation","utf8"),uc=Buffer.from("pool_tick_array_bitmap_extension","utf8"),cc=Buffer.from("observation","utf8");function le(n,e,t){return Bt([Jr,e.toBuffer(),ln(t)],n)}var mc=Buffer.from("locked_position","utf8");var lc=Buffer.from("support_mint","utf8");import{PublicKey as Vm}from"@solana/web3.js";import{TOKEN_2022_PROGRAM_ID as Wm}from"@solana/spl-token";import Hm from"bn.js";import{PublicKey as ai}from"@solana/web3.js";import bn,{isBN as wn}from"bn.js";import{bits as pc,BitStructure as gc,blob as $r,Blob as hc,cstr as bc,f32 as wc,f32be as yc,f64 as Tc,f64be as xc,greedy as Ac,Layout as ei,ns64 as Pc,ns64be as kc,nu64 as Bc,nu64be as Ic,offset as Nc,s16 as Sc,s16be as Cc,s24 as Lc,s24be as Ec,s32 as ti,s32be as Rc,s40 as Mc,s40be as Fc,s48 as _c,s48be as vc,s8 as Oc,seq as ni,struct as Dc,Structure as ri,u16 as ii,u16be as Kc,u24 as qc,u24be as Gc,u32 as Vc,u32be as Uc,u40 as Wc,u40be as Xc,u48 as Hc,u48be as zc,u8 as oi,UInt as si,union as jc,Union as Zc,unionLayoutDiscriminator as Qc,utf8 as Yc}from"@solana/buffer-layout";var St=ei,pn=ri;var Ct=si;var gn=oi,_e=ii;var he=ti;var hn=ni;var Z=$r;var ke=class extends St{blob;signed;constructor(e,t,r){super(e,r),this.blob=Z(e),this.signed=t}decode(e,t=0){let r=new bn(this.blob.decode(e,t),10,"le");return this.signed?r.fromTwos(this.span*8).clone():r}encode(e,t,r=0){return typeof e=="number"&&(e=new bn(e)),this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),t,r)}};function j(n){return new Ct(1,n)}function Be(n){return new Ct(4,n)}function P(n){return new ke(8,!1,n)}function F(n){return new ke(16,!1,n)}function yn(n){return new ke(8,!0,n)}function Tn(n){return new ke(16,!0,n)}var et=class extends St{layout;decoder;encoder;constructor(e,t,r,i){super(e.span,i),this.layout=e,this.decoder=t,this.encoder=r}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,r){return this.layout.encode(this.encoder(e),t,r)}getSpan(e,t){return this.layout.getSpan(e,t)}};function k(n){return new et(Z(32),e=>new ai(e),e=>e.toBuffer(),n)}function xn(n){return new et(gn(),ui,ci,n)}function ui(n){if(n===0)return!1;if(n===1)return!0;throw new Error("Invalid bool: "+n)}function ci(n){return n?1:0}var Lt=class extends pn{decode(e,t){return super.decode(e,t)}};function H(n,e,t){return new Lt(n,e,t)}function M(n,e,t){let r,i=typeof e=="number"?e:wn(e)?e.toNumber():new Proxy(e,{get(o,s){if(!r){let a=Reflect.get(o,"count");r=wn(a)?a.toNumber():a,Reflect.set(o,"count",r)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(r=a),Reflect.set(o,s,a)}});return hn(n,i,t)}var fm=H([Z(8),j("bump"),_e("index"),k(""),Be("protocolFeeRate"),Be("tradeFeeRate"),_e("tickSpacing"),M(P(),8,"")]),mi=H([Be("blockTimestamp"),yn("tickCumulative"),M(P(),4)]),pm=H([Z(8),xn("initialized"),P("recentEpoch"),_e("observationIndex"),k("poolId"),M(mi,100,"observations"),M(P(),4)]),li=H([j("rewardState"),P("openTime"),P("endTime"),P("lastUpdateTime"),F("emissionsPerSecondX64"),P("rewardTotalEmissioned"),P("rewardClaimed"),k("tokenMint"),k("tokenVault"),k("creator"),F("rewardGrowthGlobalX64")]),di=H([Z(8),j("bump"),k("ammConfig"),k("creator"),k("mintA"),k("mintB"),k("vaultA"),k("vaultB"),k("observationId"),j("mintDecimalsA"),j("mintDecimalsB"),_e("tickSpacing"),F("liquidity"),F("sqrtPriceX64"),he("tickCurrent"),Be(),F("feeGrowthGlobalX64A"),F("feeGrowthGlobalX64B"),P("protocolFeesTokenA"),P("protocolFeesTokenB"),F("swapInAmountTokenA"),F("swapOutAmountTokenB"),F("swapInAmountTokenB"),F("swapOutAmountTokenA"),j("status"),M(j(),7,""),M(li,3,"rewardInfos"),M(P(),16,"tickArrayBitmap"),P("totalFeesTokenA"),P("totalFeesClaimedTokenA"),P("totalFeesTokenB"),P("totalFeesClaimedTokenB"),P("fundFeesTokenA"),P("fundFeesTokenB"),P("startTime"),M(P(),15*4-3,"padding")]),fi=H([F("growthInsideLastX64"),P("rewardAmountOwed")]),pi=H([Z(8),j("bump"),k("nftMint"),k("poolId"),he("tickLower"),he("tickUpper"),F("liquidity"),F("feeGrowthInsideLastX64A"),F("feeGrowthInsideLastX64B"),P("tokenFeesOwedA"),P("tokenFeesOwedB"),M(fi,3,"rewardInfos"),M(P(),8,"")]),gm=H([Z(8),j("bump"),k("poolId"),he("tickLowerIndex"),he("tickUpperIndex"),F("liquidity"),F("feeGrowthInsideLastX64A"),F("feeGrowthInsideLastX64B"),P("tokenFeesOwedA"),P("tokenFeesOwedB"),M(F(),3,"rewardGrowthInside"),M(P(),8,"")]),gi=H([he("tick"),Tn("liquidityNet"),F("liquidityGross"),F("feeGrowthOutsideX64A"),F("feeGrowthOutsideX64B"),M(F(),3,"rewardGrowthsOutsideX64"),M(Be(),13,"")]),Rt=H([Z(8),k("poolId"),he("startTickIndex"),M(gi,D,"ticks"),j("initializedTickCount"),M(j(),115,"")]),hm=H([Z(329),M(k(),100,"whitelistMints")]),hi=H([Z(8),k("poolId"),M(M(P(),8),Et,"positiveTickArrayBitmap"),M(M(P(),8),Et,"negativeTickArrayBitmap")]),bm=H([P(),j("bump"),k("owner"),k("poolId"),k("positionId"),k("nftAccount"),M(P(),8)]),wm=H([Z(8),j("bump"),k("lockOwner"),k("poolId"),k("positionId"),k("nftAccount"),k("lockNftMint"),P("recentEpoch"),M(P(),8)]);import xm from"bn.js";var wi=15,_=class{static async getTickArrays(e,t,r,i,o,s,a){let c=[],u=C.getTickArrayStartIndexByTick(i,o),m=C.getInitializedTickArrayInRange(s,a,o,u,Math.floor(wi/2));for(let p=0;p<m.length;p++){let{publicKey:T}=le(t,r,m[p]);c.push(T)}let l=(await Qe(e,c)).map(p=>p!==null?Rt.decode(p.data):null),d={};for(let p=0;p<c.length;p++){let T=l[p];T!==null&&(d[T.startTickIndex]={...T,address:c[p]})}return d}static nextInitializedTick(e,t,r,i,o,s){let{initializedTick:a,tickArrayAddress:c,tickArrayStartTickIndex:u}=this.nextInitializedTickInOneArray(e,t,r,i,o,s);for(;a==null||a.liquidityGross.lten(0);){if(u=C.getNextTickArrayStartIndex(u,o,s),this.checkIsValidStartIndex(u,o))throw new Error("No enough initialized tickArray");let m=r[u];if(m===void 0)continue;let{nextTick:l,tickArrayAddress:d,tickArrayStartTickIndex:p}=this.firstInitializedTickInOneArray(e,t,m,s);[a,c,u]=[l,d,p]}if(a==null)throw new Error("No invaild tickArray cache");return{nextTick:a,tickArrayAddress:c,tickArrayStartTickIndex:u}}static nextInitializedTickArray(e,t,r,i,o){let s=Math.floor(e/_.tickCount(t)),a=r?C.searchLowBitFromStart(i,o,s-1,1,t):C.searchHightBitFromStart(i,o,s+1,1,t);return a.length>0?{isExist:!0,nextStartIndex:a[0]}:{isExist:!1,nextStartIndex:0}}static firstInitializedTickInOneArray(e,t,r,i){let o;if(i){let a=D-1;for(;a>=0;){let c=r.ticks[a];if(c.liquidityGross.gtn(0)){o=c;break}a=a-1}}else{let a=0;for(;a<D;){let c=r.ticks[a];if(c.liquidityGross.gtn(0)){o=c;break}a=a+1}}let{publicKey:s}=le(e,t,r.startTickIndex);return{nextTick:o,tickArrayAddress:s,tickArrayStartTickIndex:r.startTickIndex}}static nextInitializedTickInOneArray(e,t,r,i,o,s){let a=C.getTickArrayStartIndexByTick(i,o),c=Math.floor((i-a)/o),u=r[a];if(u==null)return{initializedTick:void 0,tickArrayAddress:void 0,tickArrayStartTickIndex:a};let m;if(s)for(;c>=0;){let d=u.ticks[c];if(d.liquidityGross.gtn(0)){m=d;break}c=c-1}else for(c=c+1;c<D;){let d=u.ticks[c];if(d.liquidityGross.gtn(0)){m=d;break}c=c+1}let{publicKey:l}=le(e,t,a);return{initializedTick:m,tickArrayAddress:l,tickArrayStartTickIndex:u.startTickIndex}}static getArrayStartIndex(e,t){let r=this.tickCount(t);return Math.floor(e/r)*r}static checkIsValidStartIndex(e,t){if(C.checkIsOutOfBoundary(e)){if(e>ie)return!1;let r=C.getTickArrayStartIndexByTick(ee,t);return e==r}return e%this.tickCount(t)==0}static tickCount(e){return D*e}};var se=class{static mulDivRoundingUp(e,t,r){let i=e.mul(t),o=i.div(r);return i.mod(r).eq(re)||(o=o.add(xe)),o}static mulDivFloor(e,t,r){if(r.eq(re))throw new Error("division by 0");return e.mul(t).div(r)}static mulDivCeil(e,t,r){if(r.eq(re))throw new Error("division by 0");return e.mul(t).add(r.sub(xe)).div(r)}static x64ToDecimal(e,t){return new X(e.toString()).div(X.pow(2,64)).toDecimalPlaces(t)}static decimalToX64(e){return new B(e.mul(X.pow(2,64)).floor().toFixed())}static wrappingSubU128(e,t){return e.add(Ve).sub(t).mod(Ve)}};function K(n,e){return Ft(n.mul(e),64,256)}function yi(n,e,t){let r=n.toTwos(t).shln(e);return r.imaskn(t+1),r.fromTwos(t)}function Ft(n,e,t){let r=n.toTwos(t).shrn(e);return r.imaskn(t-e+1),r.fromTwos(t-e)}var v=class{static sqrtPriceX64ToPrice(e,t,r){return se.x64ToDecimal(e).pow(2).mul(X.pow(10,t-r))}static priceToSqrtPriceX64(e,t,r){return se.decimalToX64(e.mul(X.pow(10,r-t)).sqrt())}static getNextSqrtPriceX64FromInput(e,t,r,i){if(!e.gt(re))throw new Error("sqrtPriceX64 must greater than 0");if(!t.gt(re))throw new Error("liquidity must greater than 0");return i?this.getNextSqrtPriceFromTokenAmountARoundingUp(e,t,r,!0):this.getNextSqrtPriceFromTokenAmountBRoundingDown(e,t,r,!0)}static getNextSqrtPriceX64FromOutput(e,t,r,i){if(!e.gt(re))throw new Error("sqrtPriceX64 must greater than 0");if(!t.gt(re))throw new Error("liquidity must greater than 0");return i?this.getNextSqrtPriceFromTokenAmountBRoundingDown(e,t,r,!1):this.getNextSqrtPriceFromTokenAmountARoundingUp(e,t,r,!1)}static getNextSqrtPriceFromTokenAmountARoundingUp(e,t,r,i){if(r.eq(re))return e;let o=t.shln(it);if(i){let s=o,a=o.add(r.mul(e));return a.gte(s)?se.mulDivCeil(s,e,a):se.mulDivRoundingUp(s,xe,s.div(e).add(r))}else{let s=r.mul(e);if(!o.gt(s))throw new Error("getNextSqrtPriceFromTokenAmountARoundingUp,liquidityLeftShift must gt amountMulSqrtPrice");let a=o.sub(s);return se.mulDivCeil(o,e,a)}}static getNextSqrtPriceFromTokenAmountBRoundingDown(e,t,r,i){let o=r.shln(it);if(i)return e.add(o.div(t));{let s=se.mulDivRoundingUp(o,xe,t);if(!e.gt(s))throw new Error("getNextSqrtPriceFromTokenAmountBRoundingDown sqrtPriceX64 must gt amountDivLiquidity");return e.sub(s)}}static getSqrtPriceX64FromTick(e){if(!Number.isInteger(e))throw new Error("tick must be integer");if(e<ee||e>ie)throw new Error("tick must be in MIN_TICK and MAX_TICK");let t=e<0?e*-1:e,r=(t&1)!=0?new B("18445821805675395072"):new B("18446744073709551616");return(t&2)!=0&&(r=K(r,new B("18444899583751176192"))),(t&4)!=0&&(r=K(r,new B("18443055278223355904"))),(t&8)!=0&&(r=K(r,new B("18439367220385607680"))),(t&16)!=0&&(r=K(r,new B("18431993317065453568"))),(t&32)!=0&&(r=K(r,new B("18417254355718170624"))),(t&64)!=0&&(r=K(r,new B("18387811781193609216"))),(t&128)!=0&&(r=K(r,new B("18329067761203558400"))),(t&256)!=0&&(r=K(r,new B("18212142134806163456"))),(t&512)!=0&&(r=K(r,new B("17980523815641700352"))),(t&1024)!=0&&(r=K(r,new B("17526086738831433728"))),(t&2048)!=0&&(r=K(r,new B("16651378430235570176"))),(t&4096)!=0&&(r=K(r,new B("15030750278694412288"))),(t&8192)!=0&&(r=K(r,new B("12247334978884435968"))),(t&16384)!=0&&(r=K(r,new B("8131365268886854656"))),(t&32768)!=0&&(r=K(r,new B("3584323654725218816"))),(t&65536)!=0&&(r=K(r,new B("696457651848324352"))),(t&131072)!=0&&(r=K(r,new B("26294789957507116"))),(t&262144)!=0&&(r=K(r,new B("37481735321082"))),e>0&&(r=vt.div(r)),r}static getTickFromPrice(e,t,r){return v.getTickFromSqrtPriceX64(v.priceToSqrtPriceX64(e,t,r))}static getTickFromSqrtPriceX64(e){if(e.gt(st)||e.lt(ot))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");let t=e.bitLength()-1,r=new B(t-64),i=yi(r,32,128),o=new B("8000000000000000","hex"),s=0,a=new B(0),c=t>=64?e.shrn(t-63):e.shln(63-t);for(;o.gt(new B(0))&&s<Ot;){c=c.mul(c);let T=c.shrn(127);c=c.shrn(63+T.toNumber()),a=a.add(o.mul(T)),o=o.shrn(1),s+=1}let u=a.shrn(32),l=i.add(u).mul(new B(Dt)),d=Ft(l.sub(new B(Kt)),64,128).toNumber(),p=Ft(l.add(new B(qt)),64,128).toNumber();return d==p?d:v.getSqrtPriceX64FromTick(p).lte(e)?p:d}},Te=class{static getTickWithPriceAndTickspacing(e,t,r,i){let s=v.getTickFromSqrtPriceX64(v.priceToSqrtPriceX64(e,r,i))/t;return s<0?s=Math.floor(s):s=Math.ceil(s),s*t}static roundPriceWithTickspacing(e,t,r,i){let o=Te.getTickWithPriceAndTickspacing(e,t,r,i),s=v.getSqrtPriceX64FromTick(o);return v.sqrtPriceX64ToPrice(s,r,i)}};var D=60,Ie=512,C=class{static getTickArrayAddressByTick(e,t,r,i){let o=C.getTickArrayStartIndexByTick(r,i),{publicKey:s}=le(e,t,o);return s}static getTickOffsetInArray(e,t){if(e%t!=0)throw new Error("tickIndex % tickSpacing not equal 0");let r=C.getTickArrayStartIndexByTick(e,t),i=Math.floor((e-r)/t);if(i<0||i>=D)throw new Error("tick offset in array overflow");return i}static getTickArrayBitIndex(e,t){let r=_.tickCount(t),i=e/r;return e<0&&e%r!=0?i=Math.ceil(i)-1:i=Math.floor(i),i}static getTickArrayStartIndexByTick(e,t){return this.getTickArrayBitIndex(e,t)*_.tickCount(t)}static getTickArrayOffsetInBitmapByTick(e,t){let r=t*D,i=Math.floor(e/r)+512;return Math.abs(i)}static checkTickArrayIsInitialized(e,t,r){let i=r*D,o=Math.floor(t/i)+512,s=Math.abs(o);return{isInitialized:e.testn(s),startIndex:(s-512)*i}}static getNextTickArrayStartIndex(e,t,r){return r?e-t*D:e+t*D}static mergeTickArrayBitmap(e){let t=new Ti(0);for(let r=0;r<e.length;r++)t=t.add(e[r].shln(64*r));return t}static getInitializedTickArrayInRange(e,t,r,i,o){let s=Math.floor(i/(r*D));return[...C.searchLowBitFromStart(e,t,s-1,o,r),...C.searchHightBitFromStart(e,t,s,o,r)]}static getAllInitializedTickArrayStartIndex(e,t,r){return C.searchHightBitFromStart(e,t,-7680,Ie,r)}static getAllInitializedTickArrayInfo(e,t,r,i,o){let s=[],a=C.getAllInitializedTickArrayStartIndex(r,i,o);for(let c of a){let{publicKey:u}=le(e,t,c);s.push({tickArrayStartIndex:c,tickArrayAddress:u})}return s}static getAllInitializedTickInTickArray(e){return e.ticks.filter(t=>t.liquidityGross.gtn(0))}static searchLowBitFromStart(e,t,r,i,o){let s=[...[...t.negativeTickArrayBitmap].reverse(),e.slice(0,8),e.slice(8,16),...t.positiveTickArrayBitmap].map(u=>C.mergeTickArrayBitmap(u)),a=[];for(;r>=-7680;){let u=Math.floor((r+7680)/512),m=(r+7680)%512;if(s[u].testn(m)&&a.push(r),r--,a.length===i)break}let c=_.tickCount(o);return a.map(u=>u*c)}static searchHightBitFromStart(e,t,r,i,o){let s=[...[...t.negativeTickArrayBitmap].reverse(),e.slice(0,8),e.slice(8,16),...t.positiveTickArrayBitmap].map(u=>C.mergeTickArrayBitmap(u)),a=[];for(;r<7680;){let u=Math.floor((r+7680)/512),m=(r+7680)%512;if(s[u].testn(m)&&a.push(r),r++,a.length===i)break}let c=_.tickCount(o);return a.map(u=>u*c)}static checkIsOutOfBoundary(e){return e<ee||e>ie}static nextInitTick(e,t,r,i,o){if(_.getArrayStartIndex(t,r)!=e.startTickIndex)return null;let a=Math.floor((t-e.startTickIndex)/r);if(i)for(;a>=0;){if(e.ticks[a].liquidityGross.gtn(0))return e.ticks[a];a=a-1}else for(o||(a=a+1);a<D;){if(e.ticks[a].liquidityGross.gtn(0))return e.ticks[a];a=a+1}return null}static firstInitializedTick(e,t){if(t){let r=D-1;for(;r>=0;){if(e.ticks[r].liquidityGross.gtn(0))return e.ticks[r];r=r-1}}else{let r=0;for(;r<D;){if(e.ticks[r].liquidityGross.gtn(0))return e.ticks[r];r=r+1}}throw Error(`firstInitializedTick check error: ${e} - ${t}`)}static _getTickPriceLegacy({poolInfo:e,tick:t,baseIn:r}){let i=v.getSqrtPriceX64FromTick(t),o=v.sqrtPriceX64ToPrice(i,e.mintA.decimals,e.mintB.decimals);return r?{tick:t,price:o,tickSqrtPriceX64:i}:{tick:t,price:new X(1).div(o),tickSqrtPriceX64:i}}static _getPriceAndTickLegacy({poolInfo:e,price:t,baseIn:r}){let i=r?t:new X(1).div(t),o=Te.getTickWithPriceAndTickspacing(i,e.ammConfig.tickSpacing,e.mintA.decimals,e.mintB.decimals),s=v.getSqrtPriceX64FromTick(o),a=v.sqrtPriceX64ToPrice(s,e.mintA.decimals,e.mintB.decimals);return r?{tick:o,price:a}:{tick:o,price:new X(1).div(a)}}static getTickPrice({poolInfo:e,tick:t,baseIn:r}){let i=v.getSqrtPriceX64FromTick(t),o=v.sqrtPriceX64ToPrice(i,e.mintA.decimals,e.mintB.decimals);return r?{tick:t,price:o,tickSqrtPriceX64:i}:{tick:t,price:new X(1).div(o),tickSqrtPriceX64:i}}static getPriceAndTick({poolInfo:e,price:t,baseIn:r}){let i=r?t:new X(1).div(t),o=Te.getTickWithPriceAndTickspacing(i,e.config.tickSpacing,e.mintA.decimals,e.mintB.decimals),s=v.getSqrtPriceX64FromTick(o),a=v.sqrtPriceX64ToPrice(s,e.mintA.decimals,e.mintB.decimals);return r?{tick:o,price:a}:{tick:o,price:new X(1).div(a)}}};var Et=14,ye=class{static maxTickInTickarrayBitmap(e){return e*D*Ie}static getBitmapTickBoundary(e,t){let r=this.maxTickInTickarrayBitmap(t),i=Math.floor(Math.abs(e)/r);e<0&&Math.abs(e)%r!=0&&(i+=1);let o=r*i;return e<0?{minValue:-o,maxValue:-o+r}:{minValue:o,maxValue:o+r}}static nextInitializedTickArrayStartIndex(e,t,r,i){if(!_.checkIsValidStartIndex(t,r))throw Error("nextInitializedTickArrayStartIndex check error");let o=this.maxTickInTickarrayBitmap(r),s=i?t-_.tickCount(r):t+_.tickCount(r);if(s<-o||s>=o)return{isInit:!1,tickIndex:t};let a=r*D,c=s/a+512;s<0&&s%a!=0&&c--;let u=Math.abs(c);if(i){let m=e.shln(1024-u-1),l=dn(1024,m);if(l!==null){let d=(u-l-512)*a;return{isInit:!0,tickIndex:d}}else return{isInit:!1,tickIndex:-o}}else{let m=e.shrn(u),l=fn(1024,m);if(l!==null){let d=(u+l-512)*a;return{isInit:!0,tickIndex:d}}else return{isInit:!1,tickIndex:o-_.tickCount(r)}}}},Mt=class{static getBitmapOffset(e,t){if(!_.checkIsValidStartIndex(e,t))throw new Error("No enough initialized tickArray");this.checkExtensionBoundary(e,t);let r=ye.maxTickInTickarrayBitmap(t),i=Math.floor(Math.abs(e)/r)-1;return e<0&&Math.abs(e)%r===0&&i--,i}static getBitmap(e,t,r){let i=this.getBitmapOffset(e,t);return e<0?{offset:i,tickarrayBitmap:r.negativeTickArrayBitmap[i]}:{offset:i,tickarrayBitmap:r.positiveTickArrayBitmap[i]}}static checkExtensionBoundary(e,t){let{positiveTickBoundary:r,negativeTickBoundary:i}=this.extensionTickBoundary(t);if(e>=i&&e<r)throw Error("checkExtensionBoundary -> InvalidTickArrayBoundary")}static extensionTickBoundary(e){let t=ye.maxTickInTickarrayBitmap(e),r=-t;if(ie<=t)throw Error(`extensionTickBoundary check error: ${ie}, ${t}`);if(r<=ee)throw Error(`extensionTickBoundary check error: ${r}, ${ee}`);return{positiveTickBoundary:t,negativeTickBoundary:r}}static checkTickArrayIsInit(e,t,r){let{tickarrayBitmap:i}=this.getBitmap(e,t,r),o=this.tickArrayOffsetInBitmap(e,t);return{isInitialized:C.mergeTickArrayBitmap(i).testn(o),startIndex:e}}static nextInitializedTickArrayFromOneBitmap(e,t,r,i){let o=_.tickCount(t),s=r?e-o:e+o,{tickarrayBitmap:a}=this.getBitmap(s,t,i);return this.nextInitializedTickArrayInBitmap(a,s,t,r)}static nextInitializedTickArrayInBitmap(e,t,r,i){let{minValue:o,maxValue:s}=ye.getBitmapTickBoundary(t,r),a=this.tickArrayOffsetInBitmap(t,r);if(i){let c=C.mergeTickArrayBitmap(e).shln(Ie-1-a),u=Fe(512,c)?null:It(512,c);if(u!==null){let m=t-u*_.tickCount(r);return{isInit:!0,tickIndex:m}}else return{isInit:!1,tickIndex:o}}else{let c=C.mergeTickArrayBitmap(e).shrn(a),u=Fe(512,c)?null:Nt(512,c);if(u!==null){let m=t+u*_.tickCount(r);return{isInit:!0,tickIndex:m}}else return{isInit:!1,tickIndex:s-_.tickCount(r)}}}static tickArrayOffsetInBitmap(e,t){let r=Math.abs(e)%ye.maxTickInTickarrayBitmap(t),i=Math.floor(r/_.tickCount(t));return e<0&&r!=0&&(i=Ie-i),i}};export{Et as EXTENSION_TICKARRAY_BITMAP_SIZE,ye as TickArrayBitmap,Mt as TickArrayBitmapExtensionUtils};
//# sourceMappingURL=tickarrayBitmap.mjs.map