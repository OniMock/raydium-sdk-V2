var fn=Object.defineProperty;var mn=(e,t,n)=>t in e?fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Le=(e,t,n)=>(mn(e,typeof t!="symbol"?t+"":t,n),n);import G from"bn.js";import{PublicKey as hn}from"@solana/web3.js";import{get as pt,set as pn}from"lodash";var He=class{logLevel;name;constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},gt={},gn={};function O(e){let t=pt(gt,e);if(!t){let n=pt(gn,e);t=new He({name:e,logLevel:n}),pn(gt,e,t)}return t}import{MINT_SIZE as yo,TOKEN_PROGRAM_ID as bo,getTransferFeeConfig as To,unpackMint as xo}from"@solana/spl-token";var je=O("Raydium_accountInfo_util");async function ht(e,t,n){let{batchRequest:r,commitment:o="confirmed",chunkCount:i=100}={batchRequest:!1,...n},s=Ze(t,i),a=new Array(s.length).fill([]);if(r){let c=s.map(d=>{let f=e._buildArgs([d.map(p=>p.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:f}}),u=Ze(c,10);a=(await(await Promise.all(u.map(async d=>await e._rpcBatchRequest(d)))).flat()).map(d=>(d.error&&je.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${d.error.message}`),d.result.value.map(f=>{if(f){let{data:p,executable:x,lamports:y,owner:B,rentEpoch:S}=f;return p.length!==2&&p[1]!=="base64"&&je.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:x,lamports:y,owner:new hn(B),rentEpoch:S}}return null})))}else try{a=await Promise.all(s.map(c=>e.getMultipleAccountsInfo(c,o)))}catch(c){c instanceof Error&&je.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}async function wt(e,t,n){let r=await ht(e,t.map(o=>o.pubkey),n);return t.map((o,i)=>({...o,accountInfo:r[i]}))}import $ from"bn.js";var ue=9e15,oe=1e9,Qe="0123456789abcdef",Be="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",ke="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Xe={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-ue,maxE:ue,crypto:!1},xt,X,b=!0,Ie="[DecimalError] ",re=Ie+"Invalid argument: ",Pt=Ie+"Precision limit exceeded",St=Ie+"crypto unavailable",Lt="[object Decimal]",W=Math.floor,V=Math.pow,wn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,yn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,bn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,At=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Z=1e7,w=7,Tn=9007199254740991,xn=Be.length-1,Je=ke.length-1,m={toStringTag:Lt};m.absoluteValue=m.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),h(e)};m.ceil=function(){return h(new this.constructor(this),this.e+1,2)};m.clampedTo=m.clamp=function(e,t){var n,r=this,o=r.constructor;if(e=new o(e),t=new o(t),!e.s||!t.s)return new o(NaN);if(e.gt(t))throw Error(re+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new o(r)};m.comparedTo=m.cmp=function(e){var t,n,r,o,i=this,s=i.d,a=(e=new i.constructor(e)).d,c=i.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(i.e!==e.e)return i.e>e.e^c<0?1:-1;for(r=s.length,o=a.length,t=0,n=r<o?r:o;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return r===o?0:r>o^c<0?1:-1};m.cosine=m.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+w,r.rounding=1,n=Pn(r,Nt(r,n)),r.precision=e,r.rounding=t,h(X==2||X==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};m.cubeRoot=m.cbrt=function(){var e,t,n,r,o,i,s,a,c,u,l=this,d=l.constructor;if(!l.isFinite()||l.isZero())return new d(l);for(b=!1,i=l.s*V(l.s*l,1/3),!i||Math.abs(i)==1/0?(n=K(l.d),e=l.e,(i=(e-n.length+1)%3)&&(n+=i==1||i==-2?"0":"00"),i=V(n,1/3),e=W((e+1)/3)-(e%3==(e<0?-1:2)),i==1/0?n="5e"+e:(n=i.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new d(n),r.s=l.s):r=new d(i.toString()),s=(e=d.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(l),r=I(u.plus(l).times(a),u.plus(c),s+2,1),K(a.d).slice(0,s)===(n=K(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!o&&n=="4999"){if(!o&&(h(a,e+1,0),a.times(a).times(a).eq(l))){r=a;break}s+=4,o=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(h(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return b=!0,h(r,e,d.rounding,t)};m.decimalPlaces=m.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-W(this.e/w))*w,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};m.dividedBy=m.div=function(e){return I(this,new this.constructor(e))};m.dividedToIntegerBy=m.divToInt=function(e){var t=this,n=t.constructor;return h(I(t,new n(e),0,1,1),n.precision,n.rounding)};m.equals=m.eq=function(e){return this.cmp(e)===0};m.floor=function(){return h(new this.constructor(this),this.e+1,3)};m.greaterThan=m.gt=function(e){return this.cmp(e)>0};m.greaterThanOrEqualTo=m.gte=function(e){var t=this.cmp(e);return t==1||t===0};m.hyperbolicCosine=m.cosh=function(){var e,t,n,r,o,i=this,s=i.constructor,a=new s(1);if(!i.isFinite())return new s(i.s?1/0:NaN);if(i.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(i.e,i.sd())+4,s.rounding=1,o=i.d.length,o<32?(e=Math.ceil(o/3),t=(1/Re(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),i=ce(s,1,i.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=i.times(i),i=a.minus(c.times(l.minus(c.times(l))));return h(i,s.precision=n,s.rounding=r,!0)};m.hyperbolicSine=m.sinh=function(){var e,t,n,r,o=this,i=o.constructor;if(!o.isFinite()||o.isZero())return new i(o);if(t=i.precision,n=i.rounding,i.precision=t+Math.max(o.e,o.sd())+4,i.rounding=1,r=o.d.length,r<3)o=ce(i,2,o,o,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,o=o.times(1/Re(5,e)),o=ce(i,2,o,o,!0);for(var s,a=new i(5),c=new i(16),u=new i(20);e--;)s=o.times(o),o=o.times(a.plus(s.times(c.times(s).plus(u))))}return i.precision=t,i.rounding=n,h(o,t,n,!0)};m.hyperbolicTangent=m.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,I(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};m.inverseCosine=m.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),o=n.precision,i=n.rounding;return r!==-1?r===0?t.isNeg()?j(n,o,i):new n(0):new n(NaN):t.isZero()?j(n,o+4,i).times(.5):(n.precision=o+6,n.rounding=1,t=t.asin(),e=j(n,o+4,i).times(.5),n.precision=o,n.rounding=i,e.minus(t))};m.inverseHyperbolicCosine=m.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,b=!1,n=n.times(n).minus(1).sqrt().plus(n),b=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};m.inverseHyperbolicSine=m.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,b=!1,n=n.times(n).plus(1).sqrt().plus(n),b=!0,r.precision=e,r.rounding=t,n.ln())};m.inverseHyperbolicTangent=m.atanh=function(){var e,t,n,r,o=this,i=o.constructor;return o.isFinite()?o.e>=0?new i(o.abs().eq(1)?o.s/0:o.isZero()?o:NaN):(e=i.precision,t=i.rounding,r=o.sd(),Math.max(r,e)<2*-o.e-1?h(new i(o),e,t,!0):(i.precision=n=r-o.e,o=I(o.plus(1),new i(1).minus(o),n+e,1),i.precision=e+4,i.rounding=1,o=o.ln(),i.precision=e,i.rounding=t,o.times(.5))):new i(NaN)};m.inverseSine=m.asin=function(){var e,t,n,r,o=this,i=o.constructor;return o.isZero()?new i(o):(t=o.abs().cmp(1),n=i.precision,r=i.rounding,t!==-1?t===0?(e=j(i,n+4,r).times(.5),e.s=o.s,e):new i(NaN):(i.precision=n+6,i.rounding=1,o=o.div(new i(1).minus(o.times(o)).sqrt().plus(1)).atan(),i.precision=n,i.rounding=r,o.times(2)))};m.inverseTangent=m.atan=function(){var e,t,n,r,o,i,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&d+4<=Je)return s=j(l,d+4,f).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(d+4<=Je)return s=j(l,d+4,f).times(.5),s.s=u.s,s}for(l.precision=a=d+10,l.rounding=1,n=Math.min(28,a/w+2|0),e=n;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(b=!1,t=Math.ceil(a/w),r=1,c=u.times(u),s=new l(u),o=u;e!==-1;)if(o=o.times(c),i=s.minus(o.div(r+=2)),o=o.times(c),s=i.plus(o.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===i.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),b=!0,h(s,l.precision=d,l.rounding=f,!0)};m.isFinite=function(){return!!this.d};m.isInteger=m.isInt=function(){return!!this.d&&W(this.e/w)>this.d.length-2};m.isNaN=function(){return!this.s};m.isNegative=m.isNeg=function(){return this.s<0};m.isPositive=m.isPos=function(){return this.s>0};m.isZero=function(){return!!this.d&&this.d[0]===0};m.lessThan=m.lt=function(e){return this.cmp(e)<0};m.lessThanOrEqualTo=m.lte=function(e){return this.cmp(e)<1};m.logarithm=m.log=function(e){var t,n,r,o,i,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding,p=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=u.d,u.s<0||!n||!n[0]||u.eq(1))return new l(n&&!n[0]?-1/0:u.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)i=!0;else{for(o=n[0];o%10===0;)o/=10;i=o!==1}if(b=!1,a=d+p,s=ne(u,a),r=t?Ce(l,a+10):ne(e,a),c=I(s,r,a,1),me(c.d,o=d,f))do if(a+=10,s=ne(u,a),r=t?Ce(l,a+10):ne(e,a),c=I(s,r,a,1),!i){+K(c.d).slice(o+1,o+15)+1==1e14&&(c=h(c,d+1,0));break}while(me(c.d,o+=10,f));return b=!0,h(c,d,f)};m.minus=m.sub=function(e){var t,n,r,o,i,s,a,c,u,l,d,f,p=this,x=p.constructor;if(e=new x(e),!p.d||!e.d)return!p.s||!e.s?e=new x(NaN):p.d?e.s=-e.s:e=new x(e.d||p.s!==e.s?p:NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(u=p.d,f=e.d,a=x.precision,c=x.rounding,!u[0]||!f[0]){if(f[0])e.s=-e.s;else if(u[0])e=new x(p);else return new x(c===3?-0:0);return b?h(e,a,c):e}if(n=W(e.e/w),l=W(p.e/w),u=u.slice(),i=l-n,i){for(d=i<0,d?(t=u,i=-i,s=f.length):(t=f,n=l,s=u.length),r=Math.max(Math.ceil(a/w),s)+2,i>r&&(i=r,t.length=1),t.reverse(),r=i;r--;)t.push(0);t.reverse()}else{for(r=u.length,s=f.length,d=r<s,d&&(s=r),r=0;r<s;r++)if(u[r]!=f[r]){d=u[r]<f[r];break}i=0}for(d&&(t=u,u=f,f=t,e.s=-e.s),s=u.length,r=f.length-s;r>0;--r)u[s++]=0;for(r=f.length;r>i;){if(u[--r]<f[r]){for(o=r;o&&u[--o]===0;)u[o]=Z-1;--u[o],u[r]+=Z}u[r]-=f[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=Ne(u,n),b?h(e,a,c):e):new x(c===3?-0:0)};m.modulo=m.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?h(new r(n),r.precision,r.rounding):(b=!1,r.modulo==9?(t=I(n,e.abs(),0,3,1),t.s*=e.s):t=I(n,e,0,r.modulo,1),t=t.times(e),b=!0,n.minus(t))};m.naturalExponential=m.exp=function(){return Ye(this)};m.naturalLogarithm=m.ln=function(){return ne(this)};m.negated=m.neg=function(){var e=new this.constructor(this);return e.s=-e.s,h(e)};m.plus=m.add=function(e){var t,n,r,o,i,s,a,c,u,l,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return!d.s||!e.s?e=new f(NaN):d.d||(e=new f(e.d||d.s===e.s?d:NaN)),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(u=d.d,l=e.d,a=f.precision,c=f.rounding,!u[0]||!l[0])return l[0]||(e=new f(d)),b?h(e,a,c):e;if(i=W(d.e/w),r=W(e.e/w),u=u.slice(),o=i-r,o){for(o<0?(n=u,o=-o,s=l.length):(n=l,r=i,s=u.length),i=Math.ceil(a/w),s=i>s?i+1:s+1,o>s&&(o=s,n.length=1),n.reverse();o--;)n.push(0);n.reverse()}for(s=u.length,o=l.length,s-o<0&&(o=s,n=l,l=u,u=n),t=0;o;)t=(u[--o]=u[o]+l[o]+t)/Z|0,u[o]%=Z;for(t&&(u.unshift(t),++r),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=Ne(u,r),b?h(e,a,c):e};m.precision=m.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(re+e);return n.d?(t=Bt(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};m.round=function(){var e=this,t=e.constructor;return h(new t(e),e.e+1,t.rounding)};m.sine=m.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+w,r.rounding=1,n=Ln(r,Nt(r,n)),r.precision=e,r.rounding=t,h(X>2?n.neg():n,e,t,!0)):new r(NaN)};m.squareRoot=m.sqrt=function(){var e,t,n,r,o,i,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(b=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=K(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=W((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new l(t)):r=new l(u.toString()),n=(c=l.precision)+3;;)if(i=r,r=i.plus(I(s,i,n+2,1)).times(.5),K(i.d).slice(0,n)===(t=K(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!o&&t=="4999"){if(!o&&(h(i,c+1,0),i.times(i).eq(s))){r=i;break}n+=4,o=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(h(r,c+1,1),e=!r.times(r).eq(s));break}return b=!0,h(r,c,l.rounding,e)};m.tangent=m.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=I(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,h(X==2||X==4?n.neg():n,e,t,!0)):new r(NaN)};m.times=m.mul=function(e){var t,n,r,o,i,s,a,c,u,l=this,d=l.constructor,f=l.d,p=(e=new d(e)).d;if(e.s*=l.s,!f||!f[0]||!p||!p[0])return new d(!e.s||f&&!f[0]&&!p||p&&!p[0]&&!f?NaN:!f||!p?e.s/0:e.s*0);for(n=W(l.e/w)+W(e.e/w),c=f.length,u=p.length,c<u&&(i=f,f=p,p=i,s=c,c=u,u=s),i=[],s=c+u,r=s;r--;)i.push(0);for(r=u;--r>=0;){for(t=0,o=c+r;o>r;)a=i[o]+p[r]*f[o-r-1]+t,i[o--]=a%Z|0,t=a/Z|0;i[o]=(i[o]+t)%Z|0}for(;!i[--s];)i.pop();return t?++n:i.shift(),e.d=i,e.e=Ne(i,n),b?h(e,d.precision,d.rounding):e};m.toBinary=function(e,t){return et(this,2,e,t)};m.toDecimalPlaces=m.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(q(e,0,oe),t===void 0?t=r.rounding:q(t,0,8),h(n,e+n.e+1,t))};m.toExponential=function(e,t){var n,r=this,o=r.constructor;return e===void 0?n=z(r,!0):(q(e,0,oe),t===void 0?t=o.rounding:q(t,0,8),r=h(new o(r),e+1,t),n=z(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toFixed=function(e,t){var n,r,o=this,i=o.constructor;return e===void 0?n=z(o):(q(e,0,oe),t===void 0?t=i.rounding:q(t,0,8),r=h(new i(o),e+o.e+1,t),n=z(r,!1,e+r.e+1)),o.isNeg()&&!o.isZero()?"-"+n:n};m.toFraction=function(e){var t,n,r,o,i,s,a,c,u,l,d,f,p=this,x=p.d,y=p.constructor;if(!x)return new y(p);if(u=n=new y(1),r=c=new y(0),t=new y(r),i=t.e=Bt(x)-p.e-1,s=i%w,t.d[0]=V(10,s<0?w+s:s),e==null)e=i>0?t:u;else{if(a=new y(e),!a.isInt()||a.lt(u))throw Error(re+a);e=a.gt(t)?i>0?t:u:a}for(b=!1,a=new y(K(x)),l=y.precision,y.precision=i=x.length*w*2;d=I(a,t,0,1,1),o=n.plus(d.times(r)),o.cmp(e)!=1;)n=r,r=o,o=u,u=c.plus(d.times(o)),c=o,o=t,t=a.minus(d.times(o)),a=o;return o=I(e.minus(n),r,0,1,1),c=c.plus(o.times(u)),n=n.plus(o.times(r)),c.s=u.s=p.s,f=I(u,r,i,1).minus(p).abs().cmp(I(c,n,i,1).minus(p).abs())<1?[u,r]:[c,n],y.precision=l,b=!0,f};m.toHexadecimal=m.toHex=function(e,t){return et(this,16,e,t)};m.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:q(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(b=!1,n=I(n,e,0,t,1).times(e),b=!0,h(n)):(e.s=n.s,n=e),n};m.toNumber=function(){return+this};m.toOctal=function(e,t){return et(this,8,e,t)};m.toPower=m.pow=function(e){var t,n,r,o,i,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(V(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,i=c.rounding,e.eq(1))return h(a,r,i);if(t=W(e.e/w),t>=e.d.length-1&&(n=u<0?-u:u)<=Tn)return o=kt(c,a,n,r),e.s<0?new c(1).div(o):h(o,r,i);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=V(+a,u),t=n==0||!isFinite(n)?W(u*(Math.log("0."+K(a.d))/Math.LN10+a.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(b=!1,c.rounding=a.s=1,n=Math.min(12,(t+"").length),o=Ye(e.times(ne(a,r+n)),r),o.d&&(o=h(o,r+5,1),me(o.d,r,i)&&(t=r+10,o=h(Ye(e.times(ne(a,t+n)),t),t+5,1),+K(o.d).slice(r+1,r+15)+1==1e14&&(o=h(o,r+1,0)))),o.s=s,b=!0,c.rounding=i,h(o,r,i))};m.toPrecision=function(e,t){var n,r=this,o=r.constructor;return e===void 0?n=z(r,r.e<=o.toExpNeg||r.e>=o.toExpPos):(q(e,1,oe),t===void 0?t=o.rounding:q(t,0,8),r=h(new o(r),e,t),n=z(r,e<=r.e||r.e<=o.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toSignificantDigits=m.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(q(e,1,oe),t===void 0?t=r.rounding:q(t,0,8)),h(new r(n),e,t)};m.toString=function(){var e=this,t=e.constructor,n=z(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};m.truncated=m.trunc=function(){return h(new this.constructor(this),this.e+1,1)};m.valueOf=m.toJSON=function(){var e=this,t=e.constructor,n=z(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function K(e){var t,n,r,o=e.length-1,i="",s=e[0];if(o>0){for(i+=s,t=1;t<o;t++)r=e[t]+"",n=w-r.length,n&&(i+=te(n)),i+=r;s=e[t],r=s+"",n=w-r.length,n&&(i+=te(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}function q(e,t,n){if(e!==~~e||e<t||e>n)throw Error(re+e)}function me(e,t,n,r){var o,i,s,a;for(i=e[0];i>=10;i/=10)--t;return--t<0?(t+=w,o=0):(o=Math.ceil((t+1)/w),t%=w),i=V(10,w-t),a=e[o]%i|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==i||n>3&&a+1==i/2)&&(e[o+1]/i/100|0)==V(10,t-2)-1||(a==i/2||a==0)&&(e[o+1]/i/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==i||!r&&n>3&&a+1==i/2)&&(e[o+1]/i/1e3|0)==V(10,t-3)-1,s}function Ae(e,t,n){for(var r,o=[0],i,s=0,a=e.length;s<a;){for(i=o.length;i--;)o[i]*=t;for(o[0]+=Qe.indexOf(e.charAt(s++)),r=0;r<o.length;r++)o[r]>n-1&&(o[r+1]===void 0&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}function Pn(e,t){var n,r,o;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),o=(1/Re(4,n)).toString()):(n=16,o="2.3283064365386962890625e-10"),e.precision+=n,t=ce(e,1,t.times(o),new e(1));for(var i=n;i--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var I=function(){function e(r,o,i){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*o+a,r[c]=s%i|0,a=s/i|0;return a&&r.unshift(a),r}function t(r,o,i,s){var a,c;if(i!=s)c=i>s?1:-1;else for(a=c=0;a<i;a++)if(r[a]!=o[a]){c=r[a]>o[a]?1:-1;break}return c}function n(r,o,i,s){for(var a=0;i--;)r[i]-=a,a=r[i]<o[i]?1:0,r[i]=a*s+r[i]-o[i];for(;!r[0]&&r.length>1;)r.shift()}return function(r,o,i,s,a,c){var u,l,d,f,p,x,y,B,S,_,C,D,Te,Q,We,xe,fe,qe,H,Pe,Se=r.constructor,Ge=r.s==o.s?1:-1,U=r.d,N=o.d;if(!U||!U[0]||!N||!N[0])return new Se(!r.s||!o.s||(U?N&&U[0]==N[0]:!N)?NaN:U&&U[0]==0||!N?Ge*0:Ge/0);for(c?(p=1,l=r.e-o.e):(c=Z,p=w,l=W(r.e/p)-W(o.e/p)),H=N.length,fe=U.length,S=new Se(Ge),_=S.d=[],d=0;N[d]==(U[d]||0);d++);if(N[d]>(U[d]||0)&&l--,i==null?(Q=i=Se.precision,s=Se.rounding):a?Q=i+(r.e-o.e)+1:Q=i,Q<0)_.push(1),x=!0;else{if(Q=Q/p+2|0,d=0,H==1){for(f=0,N=N[0],Q++;(d<fe||f)&&Q--;d++)We=f*c+(U[d]||0),_[d]=We/N|0,f=We%N|0;x=f||d<fe}else{for(f=c/(N[0]+1)|0,f>1&&(N=e(N,f,c),U=e(U,f,c),H=N.length,fe=U.length),xe=H,C=U.slice(0,H),D=C.length;D<H;)C[D++]=0;Pe=N.slice(),Pe.unshift(0),qe=N[0],N[1]>=c/2&&++qe;do f=0,u=t(N,C,H,D),u<0?(Te=C[0],H!=D&&(Te=Te*c+(C[1]||0)),f=Te/qe|0,f>1?(f>=c&&(f=c-1),y=e(N,f,c),B=y.length,D=C.length,u=t(y,C,B,D),u==1&&(f--,n(y,H<B?Pe:N,B,c))):(f==0&&(u=f=1),y=N.slice()),B=y.length,B<D&&y.unshift(0),n(C,y,D,c),u==-1&&(D=C.length,u=t(N,C,H,D),u<1&&(f++,n(C,H<D?Pe:N,D,c))),D=C.length):u===0&&(f++,C=[0]),_[d++]=f,u&&C[0]?C[D++]=U[xe]||0:(C=[U[xe]],D=1);while((xe++<fe||C[0]!==void 0)&&Q--);x=C[0]!==void 0}_[0]||_.shift()}if(p==1)S.e=l,xt=x;else{for(d=1,f=_[0];f>=10;f/=10)d++;S.e=d+l*p-1,h(S,a?i+S.e+1:i,s,x)}return S}}();function h(e,t,n,r){var o,i,s,a,c,u,l,d,f,p=e.constructor;e:if(t!=null){if(d=e.d,!d)return e;for(o=1,a=d[0];a>=10;a/=10)o++;if(i=t-o,i<0)i+=w,s=t,l=d[f=0],c=l/V(10,o-s-1)%10|0;else if(f=Math.ceil((i+1)/w),a=d.length,f>=a)if(r){for(;a++<=f;)d.push(0);l=c=0,o=1,i%=w,s=i-w+1}else break e;else{for(l=a=d[f],o=1;a>=10;a/=10)o++;i%=w,s=i-w+o,c=s<0?0:l/V(10,o-s-1)%10|0}if(r=r||t<0||d[f+1]!==void 0||(s<0?l:l%V(10,o-s-1)),u=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(i>0?s>0?l/V(10,o-s):0:d[f-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,u?(t-=e.e+1,d[0]=V(10,(w-t%w)%w),e.e=-t||0):d[0]=e.e=0,e;if(i==0?(d.length=f,a=1,f--):(d.length=f+1,a=V(10,w-i),d[f]=s>0?(l/V(10,o-s)%V(10,s)|0)*a:0),u)for(;;)if(f==0){for(i=1,s=d[0];s>=10;s/=10)i++;for(s=d[0]+=a,a=1;s>=10;s/=10)a++;i!=a&&(e.e++,d[0]==Z&&(d[0]=1));break}else{if(d[f]+=a,d[f]!=Z)break;d[f--]=0,a=1}for(i=d.length;d[--i]===0;)d.pop()}return b&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function z(e,t,n){if(!e.isFinite())return It(e);var r,o=e.e,i=K(e.d),s=i.length;return t?(n&&(r=n-s)>0?i=i.charAt(0)+"."+i.slice(1)+te(r):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(e.e<0?"e":"e+")+e.e):o<0?(i="0."+te(-o-1)+i,n&&(r=n-s)>0&&(i+=te(r))):o>=s?(i+=te(o+1-s),n&&(r=n-o-1)>0&&(i=i+"."+te(r))):((r=o+1)<s&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-s)>0&&(o+1===s&&(i+="."),i+=te(r))),i}function Ne(e,t){var n=e[0];for(t*=w;n>=10;n/=10)t++;return t}function Ce(e,t,n){if(t>xn)throw b=!0,n&&(e.precision=n),Error(Pt);return h(new e(Be),t,1,!0)}function j(e,t,n){if(t>Je)throw Error(Pt);return h(new e(ke),t,n,!0)}function Bt(e){var t=e.length-1,n=t*w+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function te(e){for(var t="";e--;)t+="0";return t}function kt(e,t,n,r){var o,i=new e(1),s=Math.ceil(r/w+4);for(b=!1;;){if(n%2&&(i=i.times(t),bt(i.d,s)&&(o=!0)),n=W(n/2),n===0){n=i.d.length-1,o&&i.d[n]===0&&++i.d[n];break}t=t.times(t),bt(t.d,s)}return b=!0,i}function yt(e){return e.d[e.d.length-1]&1}function Ct(e,t,n){for(var r,o=new e(t[0]),i=0;++i<t.length;)if(r=new e(t[i]),r.s)o[n](r)&&(o=r);else{o=r;break}return o}function Ye(e,t){var n,r,o,i,s,a,c,u=0,l=0,d=0,f=e.constructor,p=f.rounding,x=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(b=!1,c=x):c=t,a=new f(.03125);e.e>-2;)e=e.times(a),d+=5;for(r=Math.log(V(2,d))/Math.LN10*2+5|0,c+=r,n=i=s=new f(1),f.precision=c;;){if(i=h(i.times(e),c,1),n=n.times(++l),a=s.plus(I(i,n,c,1)),K(a.d).slice(0,c)===K(s.d).slice(0,c)){for(o=d;o--;)s=h(s.times(s),c,1);if(t==null)if(u<3&&me(s.d,c-r,p,u))f.precision=c+=10,n=i=a=new f(1),l=0,u++;else return h(s,f.precision=x,p,b=!0);else return f.precision=x,s}s=a}}function ne(e,t){var n,r,o,i,s,a,c,u,l,d,f,p=1,x=10,y=e,B=y.d,S=y.constructor,_=S.rounding,C=S.precision;if(y.s<0||!B||!B[0]||!y.e&&B[0]==1&&B.length==1)return new S(B&&!B[0]?-1/0:y.s!=1?NaN:B?0:y);if(t==null?(b=!1,l=C):l=t,S.precision=l+=x,n=K(B),r=n.charAt(0),Math.abs(i=y.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)y=y.times(e),n=K(y.d),r=n.charAt(0),p++;i=y.e,r>1?(y=new S("0."+n),i++):y=new S(r+"."+n.slice(1))}else return u=Ce(S,l+2,C).times(i+""),y=ne(new S(r+"."+n.slice(1)),l-x).plus(u),S.precision=C,t==null?h(y,C,_,b=!0):y;for(d=y,c=s=y=I(y.minus(1),y.plus(1),l,1),f=h(y.times(y),l,1),o=3;;){if(s=h(s.times(f),l,1),u=c.plus(I(s,new S(o),l,1)),K(u.d).slice(0,l)===K(c.d).slice(0,l))if(c=c.times(2),i!==0&&(c=c.plus(Ce(S,l+2,C).times(i+""))),c=I(c,new S(p),l,1),t==null)if(me(c.d,l-x,_,a))S.precision=l+=x,u=s=y=I(d.minus(1),d.plus(1),l,1),f=h(y.times(y),l,1),o=a=1;else return h(c,S.precision=C,_,b=!0);else return S.precision=C,c;c=u,o+=2}}function It(e){return String(e.s*e.s/0)}function $e(e,t){var n,r,o;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(o=t.length;t.charCodeAt(o-1)===48;--o);if(t=t.slice(r,o),t){if(o-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%w,n<0&&(r+=w),r<o){for(r&&e.d.push(+t.slice(0,r)),o-=w;r<o;)e.d.push(+t.slice(r,r+=w));t=t.slice(r),r=w-t.length}else r-=o;for(;r--;)t+="0";e.d.push(+t),b&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Sn(e,t){var n,r,o,i,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),At.test(t))return $e(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(yn.test(t))n=16,t=t.toLowerCase();else if(wn.test(t))n=2;else if(bn.test(t))n=8;else throw Error(re+t);for(i=t.search(/p/i),i>0?(c=+t.slice(i+1),t=t.substring(2,i)):t=t.slice(2),i=t.indexOf("."),s=i>=0,r=e.constructor,s&&(t=t.replace(".",""),a=t.length,i=a-i,o=kt(r,new r(n),i,i*2)),u=Ae(t,n,Z),l=u.length-1,i=l;u[i]===0;--i)u.pop();return i<0?new r(e.s*0):(e.e=Ne(u,l),e.d=u,b=!1,s&&(e=I(e,o,a*4)),c&&(e=e.times(Math.abs(c)<54?V(2,c):ve.pow(2,c))),b=!0,e)}function Ln(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:ce(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/Re(5,n)),t=ce(e,2,t,t);for(var o,i=new e(5),s=new e(16),a=new e(20);n--;)o=t.times(t),t=t.times(i.plus(o.times(s.times(o).minus(a))));return t}function ce(e,t,n,r,o){var i,s,a,c,u=1,l=e.precision,d=Math.ceil(l/w);for(b=!1,c=n.times(n),a=new e(r);;){if(s=I(a.times(c),new e(t++*t++),l,1),a=o?r.plus(s):r.minus(s),r=I(s.times(c),new e(t++*t++),l,1),s=a.plus(r),s.d[d]!==void 0){for(i=d;s.d[i]===a.d[i]&&i--;);if(i==-1)break}i=a,a=r,r=s,s=i,u++}return b=!0,s.d.length=d+1,s}function Re(e,t){for(var n=e;--t;)n*=e;return n}function Nt(e,t){var n,r=t.s<0,o=j(e,e.precision,1),i=o.times(.5);if(t=t.abs(),t.lte(i))return X=r?4:1,t;if(n=t.divToInt(o),n.isZero())X=r?3:2;else{if(t=t.minus(n.times(o)),t.lte(i))return X=yt(n)?r?2:3:r?4:1,t;X=yt(n)?r?1:4:r?3:2}return t.minus(o).abs()}function et(e,t,n,r){var o,i,s,a,c,u,l,d,f,p=e.constructor,x=n!==void 0;if(x?(q(n,1,oe),r===void 0?r=p.rounding:q(r,0,8)):(n=p.precision,r=p.rounding),!e.isFinite())l=It(e);else{for(l=z(e),s=l.indexOf("."),x?(o=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):o=t,s>=0&&(l=l.replace(".",""),f=new p(1),f.e=l.length-s,f.d=Ae(z(f),10,o),f.e=f.d.length),d=Ae(l,10,o),i=c=d.length;d[--c]==0;)d.pop();if(!d[0])l=x?"0p+0":"0";else{if(s<0?i--:(e=new p(e),e.d=d,e.e=i,e=I(e,f,n,r,0,o),d=e.d,i=e.e,u=xt),s=d[n],a=o/2,u=u||d[n+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(e.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&d[n-1]&1||r===(e.s<0?8:7)),d.length=n,u)for(;++d[--n]>o-1;)d[n]=0,n||(++i,d.unshift(1));for(c=d.length;!d[c-1];--c);for(s=0,l="";s<c;s++)l+=Qe.charAt(d[s]);if(x){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(d=Ae(l,o,t),c=d.length;!d[c-1];--c);for(s=1,l="1.";s<c;s++)l+=Qe.charAt(d[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)l="0"+l;l="0."+l}else if(++i>c)for(i-=c;i--;)l+="0";else i<c&&(l=l.slice(0,i)+"."+l.slice(i))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function bt(e,t){if(e.length>t)return e.length=t,!0}function An(e){return new this(e).abs()}function Bn(e){return new this(e).acos()}function kn(e){return new this(e).acosh()}function Cn(e,t){return new this(e).plus(t)}function In(e){return new this(e).asin()}function Nn(e){return new this(e).asinh()}function Rn(e){return new this(e).atan()}function vn(e){return new this(e).atanh()}function Mn(e,t){e=new this(e),t=new this(t);var n,r=this.precision,o=this.rounding,i=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=j(this,i,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?j(this,r,o):new this(0),n.s=e.s):!e.d||t.isZero()?(n=j(this,i,1).times(.5),n.s=e.s):t.s<0?(this.precision=i,this.rounding=1,n=this.atan(I(e,t,i,1)),t=j(this,i,1),this.precision=r,this.rounding=o,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(I(e,t,i,1)),n}function Fn(e){return new this(e).cbrt()}function En(e){return h(e=new this(e),e.e+1,2)}function _n(e,t,n){return new this(e).clamp(t,n)}function Vn(e){if(!e||typeof e!="object")throw Error(Ie+"Object expected");var t,n,r,o=e.defaults===!0,i=["precision",1,oe,"rounding",0,8,"toExpNeg",-ue,0,"toExpPos",0,ue,"maxE",0,ue,"minE",-ue,0,"modulo",0,9];for(t=0;t<i.length;t+=3)if(n=i[t],o&&(this[n]=Xe[n]),(r=e[n])!==void 0)if(W(r)===r&&r>=i[t+1]&&r<=i[t+2])this[n]=r;else throw Error(re+n+": "+r);if(n="crypto",o&&(this[n]=Xe[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(St);else this[n]=!1;else throw Error(re+n+": "+r);return this}function Dn(e){return new this(e).cos()}function On(e){return new this(e).cosh()}function Rt(e){var t,n,r;function o(i){var s,a,c,u=this;if(!(u instanceof o))return new o(i);if(u.constructor=o,Tt(i)){u.s=i.s,b?!i.d||i.e>o.maxE?(u.e=NaN,u.d=null):i.e<o.minE?(u.e=0,u.d=[0]):(u.e=i.e,u.d=i.d.slice()):(u.e=i.e,u.d=i.d?i.d.slice():i.d);return}if(c=typeof i,c==="number"){if(i===0){u.s=1/i<0?-1:1,u.e=0,u.d=[0];return}if(i<0?(i=-i,u.s=-1):u.s=1,i===~~i&&i<1e7){for(s=0,a=i;a>=10;a/=10)s++;b?s>o.maxE?(u.e=NaN,u.d=null):s<o.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[i]):(u.e=s,u.d=[i]);return}else if(i*0!==0){i||(u.s=NaN),u.e=NaN,u.d=null;return}return $e(u,i.toString())}else if(c!=="string")throw Error(re+i);return(a=i.charCodeAt(0))===45?(i=i.slice(1),u.s=-1):(a===43&&(i=i.slice(1)),u.s=1),At.test(i)?$e(u,i):Sn(u,i)}if(o.prototype=m,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=Vn,o.clone=Rt,o.isDecimal=Tt,o.abs=An,o.acos=Bn,o.acosh=kn,o.add=Cn,o.asin=In,o.asinh=Nn,o.atan=Rn,o.atanh=vn,o.atan2=Mn,o.cbrt=Fn,o.ceil=En,o.clamp=_n,o.cos=Dn,o.cosh=On,o.div=Kn,o.exp=Un,o.floor=Wn,o.hypot=qn,o.ln=Gn,o.log=Hn,o.log10=Zn,o.log2=jn,o.max=zn,o.min=Qn,o.mod=Xn,o.mul=Jn,o.pow=Yn,o.random=$n,o.round=er,o.sign=tr,o.sin=nr,o.sinh=rr,o.sqrt=or,o.sub=ir,o.sum=sr,o.tan=ar,o.tanh=ur,o.trunc=cr,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return o.config(e),o}function Kn(e,t){return new this(e).div(t)}function Un(e){return new this(e).exp()}function Wn(e){return h(e=new this(e),e.e+1,3)}function qn(){var e,t,n=new this(0);for(b=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return b=!0,new this(1/0);n=t}return b=!0,n.sqrt()}function Tt(e){return e instanceof ve||e&&e.toStringTag===Lt||!1}function Gn(e){return new this(e).ln()}function Hn(e,t){return new this(e).log(t)}function jn(e){return new this(e).log(2)}function Zn(e){return new this(e).log(10)}function zn(){return Ct(this,arguments,"lt")}function Qn(){return Ct(this,arguments,"gt")}function Xn(e,t){return new this(e).mod(t)}function Jn(e,t){return new this(e).mul(t)}function Yn(e,t){return new this(e).pow(t)}function $n(e){var t,n,r,o,i=0,s=new this(1),a=[];if(e===void 0?e=this.precision:q(e,1,oe),r=Math.ceil(e/w),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));i<r;)o=t[i],o>=429e7?t[i]=crypto.getRandomValues(new Uint32Array(1))[0]:a[i++]=o%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);i<r;)o=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+((t[i+3]&127)<<24),o>=214e7?crypto.randomBytes(4).copy(t,i):(a.push(o%1e7),i+=4);i=r/4}else throw Error(St);else for(;i<r;)a[i++]=Math.random()*1e7|0;for(r=a[--i],e%=w,r&&e&&(o=V(10,w-e),a[i]=(r/o|0)*o);a[i]===0;i--)a.pop();if(i<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=w)a.shift();for(r=1,o=a[0];o>=10;o/=10)r++;r<w&&(n-=w-r)}return s.e=n,s.d=a,s}function er(e){return h(e=new this(e),e.e+1,this.rounding)}function tr(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function nr(e){return new this(e).sin()}function rr(e){return new this(e).sinh()}function or(e){return new this(e).sqrt()}function ir(e,t){return new this(e).sub(t)}function sr(){var e=0,t=arguments,n=new this(t[e]);for(b=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return b=!0,h(n,this.precision,this.rounding)}function ar(e){return new this(e).tan()}function ur(e){return new this(e).tanh()}function cr(e){return h(e=new this(e),e.e+1,1)}m[Symbol.for("nodejs.util.inspect.custom")]=m.toString;m[Symbol.toStringTag]="Decimal";var ve=m.constructor=Rt(Xe);Be=new ve(Be);ke=new ve(ke);import wr from"big.js";import Ee from"bn.js";import lr from"toformat";var dr=lr,pe=dr;import Fe from"big.js";import mr from"bn.js";import pr from"decimal.js-light";import ge from"bn.js";var vt=9007199254740991;function F(e){let t=O("Raydium_parseBigNumberish");if(e instanceof ge)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new ge(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=vt||e<=-vt)&&t.logWithError(`BigNumberish number overflow: ${e}`),new ge(String(e))):typeof e=="bigint"?new ge(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new ge(0))}var Me=O("module/fraction"),tt=pe(Fe),he=pe(pr),gr={[0]:he.ROUND_DOWN,[1]:he.ROUND_HALF_UP,[2]:he.ROUND_UP},hr={[0]:Fe.roundDown,[1]:Fe.roundHalfUp,[2]:Fe.roundUp},k=class{numerator;denominator;constructor(t,n=new mr(1)){this.numerator=F(t),this.denominator=F(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new k(this.denominator,this.numerator)}add(t){let n=t instanceof k?t:new k(F(t));return this.denominator.eq(n.denominator)?new k(this.numerator.add(n.numerator),this.denominator):new k(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof k?t:new k(F(t));return this.denominator.eq(n.denominator)?new k(this.numerator.sub(n.numerator),this.denominator):new k(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof k?t:new k(F(t));return new k(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof k?t:new k(F(t));return new k(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||Me.logWithError(`${t} is not an integer.`),t<=0&&Me.logWithError(`${t} is not positive.`),he.set({precision:t+1,rounding:gr[r]});let o=new he(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return o.toFormat(o.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||Me.logWithError(`${t} is not an integer.`),t<0&&Me.logWithError(`${t} is negative.`),tt.DP=t,tt.RM=hr[r]||1,new tt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var yr=O("Raydium_amount"),Mt=pe(wr);function br(e,t){let n="0",r="0";if(e.includes(".")){let o=e.split(".");o.length===2?([n,r]=o,r=r.padEnd(t,"0")):yr.logWithError(`invalid number string, num: ${e}`)}else n=e;return[n,r.slice(0,t)||r]}var J=class extends k{token;logger;constructor(t,n,r=!0,o){let i=new Ee(0),s=nt.pow(new Ee(t.decimals));if(r)i=F(n);else{let a=new Ee(0),c=new Ee(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[u,l]=br(n.toString(),t.decimals);a=F(u),c=F(l)}a=a.mul(s),i=a.add(c)}super(i,s),this.logger=O(o||"TokenAmount"),this.token=t}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(t){return this.token.equals(t.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(t.raw)}lt(t){return this.token.equals(t.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(t.raw)}add(t){return this.token.equals(t.token)||this.logger.logWithError("add token not equals"),new J(this.token,this.raw.add(t.raw))}subtract(t){return this.token.equals(t.token)||this.logger.logWithError("sub token not equals"),new J(this.token,this.raw.sub(t.raw))}toSignificant(t=this.token.decimals,n,r=0){return super.toSignificant(t,n,r)}toFixed(t=this.token.decimals,n,r=0){return t>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(t,n,r)}toExact(t={groupSeparator:""}){return Mt.DP=this.token.decimals,new Mt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t)}};import{PublicKey as Tr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ft}from"@solana/spl-token";var Et={chainId:101,address:Tr.default.toBase58(),programId:Ft.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ie={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Ft.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as it}from"@solana/web3.js";import{PublicKey as R,SystemProgram as _t,SYSVAR_RENT_PUBKEY as xr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Pr}from"@solana/spl-token";function rt({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var ti=[rt({pubkey:Pr,isWritable:!1}),rt({pubkey:_t.programId,isWritable:!1}),rt({pubkey:xr,isWritable:!1})];function Vt({publicKey:e,transformSol:t}){let n=ot(e.toString());if(n instanceof R)return t&&n.equals(we)?ze:n;if(t&&n.toString()===we.toBase58())return ze;if(typeof n=="string"){if(n===R.default.toBase58())return R.default;try{return new R(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function ot(e){try{return new R(e)}catch{return e}}var ni=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ri=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),oi=new R("SysvarRent111111111111111111111111111111111"),ii=new R("SysvarC1ock11111111111111111111111111111111"),si=new R("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),ai=new R("Sysvar1nstructions1111111111111111111111111"),ui=_t.programId,ci=new R("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),li=new R("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),di=new R("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),fi=new R("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),mi=new R("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),pi=new R("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),gi=new R("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),hi=new R("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),wi=new R("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),yi=new R("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),bi=new R("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ze=new R("So11111111111111111111111111111111111111112"),we=R.default;var st=class{symbol;name;decimals;isToken2022;mint;constructor({mint:t,decimals:n,symbol:r,name:o,skipMint:i=!1,isToken2022:s=!1}){if(t===we.toBase58()||t instanceof it&&we.equals(t)){this.decimals=ie.decimals,this.symbol=ie.symbol,this.name=ie.name,this.mint=new it(ie.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=o||t.toString().substring(0,6),this.mint=i?it.default:Vt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},se=st;Le(se,"WSOL",new st({...ie,mint:ie.address}));var at=class{symbol;name;decimals;constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},_e=at;Le(_e,"SOL",new at(Et));import Sr from"bn.js";var Dt=new k(new Sr(100)),le=class extends k{toSignificant(t=5,n,r){return this.mul(Dt).toSignificant(t,n,r)}toFixed(t=2,n,r){return this.mul(Dt).toFixed(t,n,r)}};var Lr=O("Raydium_price"),Y=class extends k{baseToken;quoteToken;scalar;constructor(t){let{baseToken:n,quoteToken:r,numerator:o,denominator:i}=t;super(o,i),this.baseToken=n,this.quoteToken=r,this.scalar=new k(ut(n.decimals),ut(r.decimals))}get raw(){return new k(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new Y({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(t){this.quoteToken!==t.baseToken&&Lr.logWithError("mul token not equals");let n=super.mul(t);return new Y({baseToken:this.baseToken,quoteToken:t.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(t=this.quoteToken.decimals,n,r){return this.adjusted.toSignificant(t,n,r)}toFixed(t=this.quoteToken.decimals,n,r){return this.adjusted.toFixed(t,n,r)}};import{PublicKey as Br}from"@solana/web3.js";import kr from"bn.js";function Ot(e){return typeof e=="object"&&e!==null&&![se,J,Br,k,kr,Y,le].some(t=>typeof t=="object"&&e instanceof t)}function Ve(e){return typeof e=="string"?ot(e):Array.isArray(e)?e.map(t=>Ve(t)):Ot(e)?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,Ve(n)])):e}var Ar=new $(0),gs=new $(1),hs=new $(2),ws=new $(3),ys=new $(5),nt=new $(10),bs=new $(100),Ts=new $(1e3),xs=new $(1e4);function ut(e){return nt.pow(F(e))}var Kt=e=>typeof e=="number";function Ut(e,t,n){let r=Kt(t)?t*(n?.unit==="s"?1e3:1):t;return new Date(e).getTime()<=r}function Wt(e,t,n){let r=Kt(t)?t*(n?.unit==="s"?1e3:1):t;return new Date(e).getTime()>r}function Ze(e,t=1,n=[]){let r=[...e];if(t<=0)return n;for(;r.length;)n.push(r.splice(0,t));return n}import{PublicKey as Hs}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Zs}from"@solana/spl-token";import{ComputeBudgetProgram as Is,Keypair as vs,PublicKey as Ir,Transaction as Fs,TransactionMessage as _s,VersionedTransaction as Vs}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Us}from"@solana/spl-token";var Ws=O("Raydium_txUtil");function ye(e,t){let[n,r]=Ir.findProgramAddressSync(e,t);return{publicKey:n,nonce:r}}import{PublicKey as T}from"@solana/web3.js";var qt=new T("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Gt=new T("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Ht=new T("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),jt=new T("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Js=new T("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Ys=new T("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),$s=new T("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),ea=new T("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),ta=new T("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),na=new T("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ra=new T("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),oa=new T("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ia=new T("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),sa=new T("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),aa=new T("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),ua=new T("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),ca=new T("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),la=new T("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),da=new T("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),fa=new T("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),ma=new T("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),pa=new T("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Nr=new T("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),Rr=new T("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),vr=new T("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),ga=new T("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Mr=new T("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),ha=new T("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Fr=new T("7AFUeLVRjBfzqK3tTGw8hN48KLQWSk6DTE8xprWdPqix"),wa=new T("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),ya=new T("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Er=new T("LanD8FpTBBvzZFXjTxsAoipkFsxPUCDB4qAqKxYDiNP"),_r=new T("HYNHiyKJ3gGVFvyxJAurK7qr7P2o5J9THmvCGMdULtpW");var ba={SERUM_MARKET:T.default,OPENBOOK_MARKET:new T("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:T.default,FarmV3:new T("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new T("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new T("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new T("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new T("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new T("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),CLMM_LOCK_PROGRAM_ID:new T("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),CLMM_LOCK_AUTH_ID:new T("8qmHNvu2Kr2C7U8mJL4Vz1vTDxMhVuXKREwU7TNoaVEo"),Router:new T("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:Nr,CREATE_CPMM_POOL_AUTH:Rr,CREATE_CPMM_POOL_FEE_ACC:vr,FEE_DESTINATION_ID:new T("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR"),LOCK_CPMM_PROGRAM:Mr,LCOK_CPMM_AUTH:Fr,LAUNCHPAD_PROGRAM:Er,LAUNCHPAD_AUTH:_r};import Pa from"bn.js";import{PublicKey as Vr,AddressLookupTableAccount as Zt}from"@solana/web3.js";var Dr={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new Zt({key:new Vr("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:Zt.deserialize(Buffer.from("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","base64"))})};import{PublicKey as Oa,sendAndConfirmTransaction as Ka,SystemProgram as qa,Transaction as Ga,TransactionMessage as ja,VersionedTransaction as Za}from"@solana/web3.js";import Qa from"axios";import Or from"bn.js";var nu=new Or(1e6);import{PublicKey as jr}from"@solana/web3.js";import Jt,{isBN as Yt}from"bn.js";import{bits as Lu,BitStructure as Au,blob as Kr,Blob as Bu,cstr as ku,f32 as Cu,f32be as Iu,f64 as Nu,f64be as Ru,greedy as vu,Layout as Ur,ns64 as Mu,ns64be as Fu,nu64 as Eu,nu64be as _u,offset as Vu,s16 as Du,s16be as Ou,s24 as Ku,s24be as Uu,s32 as Wu,s32be as qu,s40 as Gu,s40be as Hu,s48 as ju,s48be as Zu,s8 as zu,seq as Wr,struct as Qu,Structure as qr,u16 as Xu,u16be as Ju,u24 as Yu,u24be as $u,u32 as ec,u32be as tc,u40 as nc,u40be as rc,u48 as oc,u48be as ic,u8 as Gr,UInt as Hr,union as sc,Union as ac,unionLayoutDiscriminator as uc,utf8 as cc}from"@solana/buffer-layout";var ct=Ur,zt=qr;var lt=Hr;var Qt=Gr;var Xt=Wr;var ae=Kr;var de=class extends ct{blob;signed;constructor(t,n,r){super(t,r),this.blob=ae(t),this.signed=n}decode(t,n=0){let r=new Jt(this.blob.decode(t,n),10,"le");return this.signed?r.fromTwos(this.span*8).clone():r}encode(t,n,r=0){return typeof t=="number"&&(t=new Jt(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,r)}};function E(e){return new lt(1,e)}function Oe(e){return new lt(4,e)}function g(e){return new de(8,!1,e)}function ee(e){return new de(16,!1,e)}function $t(e){return new de(1,!0,e)}function Ke(e){return new de(8,!0,e)}var De=class extends ct{layout;decoder;encoder;constructor(t,n,r,o){super(t.span,o),this.layout=t,this.decoder=n,this.encoder=r}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,r){return this.layout.encode(this.encoder(t),n,r)}getSpan(t,n){return this.layout.getSpan(t,n)}};function P(e){return new De(ae(32),t=>new jr(t),t=>t.toBuffer(),e)}function ft(e){return new De(Qt(),Zr,zr,e)}function Zr(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function zr(e){return e?1:0}var dt=class extends zt{decode(t,n){return super.decode(t,n)}};function v(e,t,n){return new dt(e,t,n)}function M(e,t,n){let r,o=typeof t=="number"?t:Yt(t)?t.toNumber():new Proxy(t,{get(i,s){if(!r){let a=Reflect.get(i,"count");r=Yt(a)?a.toNumber():a,Reflect.set(i,"count",r)}return Reflect.get(i,s)},set(i,s,a){return s==="count"&&(r=a),Reflect.set(i,s,a)}});return Xt(e,o,n)}var mt=v([P("mint"),P("owner"),g("amount"),Oe("delegateOption"),P("delegate"),E("state"),Oe("isNativeOption"),g("isNative"),g("delegatedAmount"),Oe("closeAuthorityOption"),P("closeAuthority")]);import{PublicKey as cn}from"@solana/web3.js";var Ic=v([E("instruction")]),Nc=v([E("instruction")]),Qr=v([g("rewardState"),g("rewardOpenTime"),g("rewardEndTime"),g("rewardLastUpdateTime"),g("totalReward"),g("totalRewardEmissioned"),g("rewardClaimed"),g("rewardPerSecond"),ee("accRewardPerShare"),P("rewardVault"),P("rewardMint"),P("rewardSender"),g("rewardType"),M(g(),15,"padding")]),Xr=v([g("state"),g("nonce"),P("lpVault"),P("rewardVault"),P(),P(),g(),g(),g("totalReward"),ee("perShareReward"),g("lastSlot"),g("perSlotReward")]),Jr=v([g("state"),g("nonce"),P("lpVault"),P("rewardVaultA"),g("totalRewardA"),ee("perShareRewardA"),g("perSlotRewardA"),E("option"),P("rewardVaultB"),ae(7),g("totalRewardB"),ee("perShareRewardB"),g("perSlotRewardB"),g("lastSlot"),P()]),Yr=v([g(),g("state"),g("nonce"),g("validRewardTokenNum"),ee("rewardMultiplier"),g("rewardPeriodMax"),g("rewardPeriodMin"),g("rewardPeriodExtend"),P("lpMint"),P("lpVault"),M(Qr,5,"rewardInfos"),P("creator"),P(),M(g(),32,"padding")]),en=new Proxy(Xr,{get(e,t,n){return t==="decode"?(...r)=>{let o=e.decode(...r);return{...o,version:3,rewardInfos:[{rewardVault:o.rewardVault,totalReward:o.totalReward,perSlotReward:o.perSlotReward,perShareReward:o.perShareReward}]}}:Reflect.get(e,t,n)}}),tn=new Proxy(Jr,{get(e,t,n){return t==="decode"?(...r)=>{let o=e.decode(...r);return{...o,version:5,rewardInfos:[{rewardVault:o.rewardVaultA,totalReward:o.totalRewardA,perSlotReward:o.perSlotRewardA,perShareReward:o.perShareRewardA},{rewardVault:o.rewardVaultB,totalReward:o.totalRewardB,perSlotReward:o.perSlotRewardB,perShareReward:o.perShareRewardB}]}}:Reflect.get(e,t,n)}}),nn=new Proxy(Yr,{get(e,t,n){return t==="decode"?(...r)=>{let o=e.decode(...r);return{...o,version:6,rewardInfos:o.rewardInfos.map(i=>({...i,rewardType:(Object.entries(Ue).find(s=>String(s[1])===i.rewardType.toString())??["Standard SPL"])[0]}))}}:Reflect.get(e,t,n)}}),$r=v([g("isSet"),g("rewardPerSecond"),g("rewardOpenTime"),g("rewardEndTime"),g("rewardType")]),Rc=v([E("instruction"),g("nonce"),M($r,5,"rewardTimeInfo")]),vc=v([E("instruction"),g("rewardReopenTime"),g("rewardEndTime"),g("rewardPerSecond")]),Mc=v([E("instruction"),g("isSet"),g("rewardPerSecond"),g("rewardOpenTime"),g("rewardEndTime"),g("rewardType")]),Fc=v([g("state"),P("id"),P("owner"),g("deposited"),M(g(),1,"rewardDebts")]),rn=v([g("state"),P("id"),P("owner"),g("deposited"),M(ee(),1,"rewardDebts"),g(""),g("voteLockedBalance"),M(g(),15)]),Ec=v([g("state"),P("id"),P("owner"),g("deposited"),M(g(),2,"rewardDebts")]),on=v([g("state"),P("id"),P("owner"),g("deposited"),M(ee(),2,"rewardDebts"),M(g(),17)]),sn=v([g(),g("state"),P("id"),P("owner"),g("deposited"),M(ee(),5,"rewardDebts"),M(g(),16)]),_c=v([E("instruction"),g("amount")]),eo=v([P("mint"),P("grantAuthority"),g("baselineVoteWeightScaledFactor"),g("maxExtraLockupVoteWeightScaledFactor"),g("lockupSaturationSecs"),$t("digitShift"),M(E(),7,"reserved1"),M(g(),7,"reserved2")]),an=v([ae(8),P("governanceProgramId"),P("realm"),P("realmGoverningTokenMint"),P("realmAuthority"),M(E(),32,"reserved1"),M(eo,4,"votingMints"),Ke("timeOffset"),E("bump"),M(E(),7,"reserved2"),M(g(),11,"reserved3")]),to=v([Ke("startTime"),Ke("endTime"),E("kind"),M(E(),15,"reserved")]),no=v([M(to,1,"lockup"),g("amountDeposited_native"),g("amountInitiallyLockedNative"),ft("isUsed"),ft("allowClawback"),E("votingMintConfigIdx"),M(E(),29,"reserved")]),un=v([ae(8),P("voterAuthority"),P("registrar"),M(no,32,"deposits"),E("voterBump"),E("voterWweightRecordBump"),M(E(),94,"reserved")]);var Gc=O("Raydium_farm_config"),Hc=new cn("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),jc=new cn("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1"),ln={3:en,5:tn,6:nn},dn={3:rn,5:on,6:sn};var Ue={"Standard SPL":0,"Option tokens":1},Zc={[qt.toString()]:3,[Gt.toString()]:4,[Ht.toString()]:5,[jt.toString()]:6};var be=O("Raydium.farm.util");function ul({programId:e,poolId:t,mint:n,type:r}){let{publicKey:o}=ye([t.toBuffer(),n.toBuffer(),Buffer.from(r==="lpVault"?"lp_vault_associated_seed":r==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],e);return o}function ro({programId:e,poolId:t,owner:n,version:r}){let{publicKey:o}=ye([t.toBuffer(),n.toBuffer(),Buffer.from(r===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],e);return o}var cl=({programId:e,poolId:t})=>ye([t.toBuffer()],e);function ll(e){return{isSet:new G(1),rewardPerSecond:F(e.perSecond),rewardOpenTime:F(e.openTime),rewardEndTime:F(e.endTime),rewardType:F(Ue[e.rewardType])}}function dl(e){return F(e.endTime).sub(F(e.openTime)).mul(F(e.perSecond))}function oo(e){let t=dn[e];return t||be.logWithError("invalid version",e),t}function io(e){let t=ln[e];return t||be.logWithError("invalid version",e),t}function so(e,t,n,r){if(e.version===3||e.version===5){if(e.lastSlot.gte(new G(n)))return e;let o=new G(n).sub(e.lastSlot);e.lastSlot=new G(n);for(let i of e.rewardInfos){if(t.amount.eq(new G(0)))continue;let s=i.perSlotReward.mul(o);i.perShareReward=i.perShareReward.add(s.mul(new G(10).pow(new G(e.version===3?9:15))).div(t.amount)),i.totalReward=i.totalReward.add(s)}}else if(e.version===6)for(let o of e.rewardInfos){if(o.rewardState.eq(new G(0)))continue;let i=G.min(new G(r),o.rewardEndTime);if(o.rewardOpenTime.gte(i))continue;let a=i.sub(o.rewardLastUpdateTime).mul(o.rewardPerSecond),c=o.totalReward.sub(o.totalRewardEmissioned);c.lt(a)?(a=c,o.rewardLastUpdateTime=o.rewardLastUpdateTime.add(c.div(o.rewardPerSecond))):o.rewardLastUpdateTime=i,!t.amount.eq(new G(0))&&(o.accRewardPerShare=o.accRewardPerShare.add(a.mul(e.rewardMultiplier).div(t.amount)),o.totalRewardEmissioned=o.totalRewardEmissioned.add(a))}return e}async function fl({connection:e,farmPools:t,owner:n,config:r,chainTime:o}){let i=!1,s=!1,a=new G(10),c=[];for(let f of t){let p=Ve(f);p.version===6?s=!0:i=!0,c.push({pubkey:p.id,version:p.version,key:"state",poolId:p.id},{pubkey:p.lpVault,version:p.version,key:"lpVault",poolId:p.id}),n&&c.push({pubkey:ro({programId:p.programId,poolId:p.id,owner:n,version:f.version}),version:p.version,key:"ledger",poolId:p.id})}let u={},l=await wt(e,c,r);for(let{pubkey:f,version:p,key:x,poolId:y,accountInfo:B}of l){let S=y.toBase58();if(u[S]={...u[S]},x==="state"){let _=io(p);(!B||!B.data||B.data.length!==_.span)&&be.logWithError(`invalid farm state account info, pools.id, ${f}`),u[S].state=_.decode(B.data)}else if(x==="lpVault")(!B||!B.data||B.data.length!==mt.span)&&be.logWithError(`invalid farm lp vault account info, pools.lpVault, ${f}`),u[S].lpVault=mt.decode(B.data);else if(x==="ledger"){let _=oo(p);B&&B.data&&(B.data.length!==_.span&&be.logWithError(`invalid farm ledger account info, ledger, ${f}`),u[S].ledger=_.decode(B.data))}}let d=s||i?await e.getSlot():0;for(let f of Object.keys(u))u[f]!==void 0&&(u[f].state=so(u[f].state,u[f].lpVault,d,o));for(let[f,{state:p,ledger:x}]of Object.entries(u))if(x){let y=p.version===6?p.rewardMultiplier:p.rewardInfos.length===1?a.pow(new G(9)):a.pow(new G(15)),B=p.rewardInfos.map((S,_)=>{let C=x.rewardDebts[_];return x.deposited.mul(p.version===6?S.accRewardPerShare:S.perShareReward).div(y).sub(C)});u[f].wrapped={...u[f].wrapped,pendingRewards:B}}return u}function ml(e,t=Date.now()){if(e.version===6){let n=e.state.rewardInfos;if(n.every(({rewardOpenTime:r})=>Ut(t,r.toNumber(),{unit:"s"})))return"upcoming pool";if(n.every(({rewardEndTime:r})=>Wt(t,r.toNumber(),{unit:"s"})))return"closed pool"}else{let n=e.state.rewardInfos.map(({perSlotReward:r})=>r);if(n.length===2){if(String(n[0])==="0"&&String(n[1])!=="0")return"normal fusion pool";if(String(n[0])!=="0"&&String(n[1])!=="0")return"dual fusion pool";if(String(n[0])==="0"&&String(n[1])==="0")return"closed pool"}else if(n.length===1&&String(n[0])==="0")return"closed pool"}}async function pl(e,t,n,r){let o=await e.getAccountInfo(t);if(o===null)throw Error("registrar info check error");let s=an.decode(o.data).votingMints.findIndex(l=>l.mint.equals(r));if(s===-1)throw Error("find voter mint error");let a=await e.getAccountInfo(n);if(a===null)return{index:s,isInit:!1};let u=un.decode(a.data).deposits.findIndex(l=>l.isUsed&&l.votingMintConfigIdx===s);return u===-1?{index:s,isInit:!1}:{index:u,isInit:!0}}export{dl as calFarmRewardAmount,ll as farmRewardInfoToConfig,fl as fetchMultipleFarmInfoAndUpdate,cl as getAssociatedAuthority,ro as getAssociatedLedgerAccount,ul as getAssociatedLedgerPoolAccount,pl as getDepositEntryIndex,oo as getFarmLedgerLayout,io as getFarmStateLayout,ml as judgeFarmType,so as updateFarmPoolInfo};
//# sourceMappingURL=util.mjs.map