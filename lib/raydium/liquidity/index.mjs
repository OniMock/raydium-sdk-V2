var kn=Object.defineProperty;var Sn=(e,t,n)=>t in e?kn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Fe=(e,t,n)=>(Sn(e,typeof t!="symbol"?t+"":t,n),n);import Dt from"bn.js";var Li=new Dt(25),Ni=new Dt(1e4),In={4:3,5:3};import{PublicKey as Kn}from"@solana/web3.js";import Vt,{isBN as Ft}from"bn.js";import{bits as Ki,BitStructure as Ei,blob as Bn,Blob as Ri,cstr as vi,f32 as Di,f32be as _i,f64 as Oi,f64be as Vi,greedy as Fi,Layout as Ln,ns64 as Wi,ns64be as qi,nu64 as Ui,nu64be as Gi,offset as Hi,s16 as ji,s16be as Qi,s24 as zi,s24be as Zi,s32 as Yi,s32be as Xi,s40 as Ji,s40be as $i,s48 as eo,s48be as to,s8 as no,seq as Nn,struct as ro,Structure as Cn,u16 as io,u16be as oo,u24 as so,u24be as ao,u32 as uo,u32be as co,u40 as lo,u40be as mo,u48 as po,u48be as fo,u8 as go,UInt as Mn,union as bo,Union as ho,unionLayoutDiscriminator as yo,utf8 as To}from"@solana/buffer-layout";var nt=Ln,_t=Cn;var rt=Mn;var Ot=Nn;var it=Bn;var We=class extends nt{blob;signed;constructor(t,n,r){super(t,r),this.blob=it(t),this.signed=n}decode(t,n=0){let r=new Vt(this.blob.decode(t,n),10,"le");return this.signed?r.fromTwos(this.span*8).clone():r}encode(t,n,r=0){return typeof t=="number"&&(t=new Vt(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,r)}};function v(e){return new rt(1,e)}function pe(e){return new rt(4,e)}function d(e){return new We(8,!1,e)}function X(e){return new We(16,!1,e)}var ot=class extends nt{layout;decoder;encoder;constructor(t,n,r,i){super(t.span,i),this.layout=t,this.decoder=n,this.encoder=r}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,r){return this.layout.encode(this.encoder(t),n,r)}getSpan(t,n){return this.layout.getSpan(t,n)}};function S(e){return new ot(it(32),t=>new Kn(t),t=>t.toBuffer(),e)}var st=class extends _t{decode(t,n){return super.decode(t,n)}};function D(e,t,n){return new st(e,t,n)}function Be(e,t,n){let r,i=typeof t=="number"?t:Ft(t)?t.toNumber():new Proxy(t,{get(o,s){if(!r){let a=Reflect.get(o,"count");r=Ft(a)?a.toNumber():a,Reflect.set(o,"count",r)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(r=a),Reflect.set(o,s,a)}});return Ot(e,i,n)}var at=D([v("instruction"),d("amountIn"),d("minAmountOut")]),ut=D([v("instruction"),d("maxAmountIn"),d("amountOut")]),vo=D([v("instruction"),v("nonce")]),ct=D([v("instruction"),v("nonce"),d("startTime")]),lt=D([d("status"),d("nonce"),d("maxOrder"),d("depth"),d("baseDecimal"),d("quoteDecimal"),d("state"),d("resetFlag"),d("minSize"),d("volMaxCutRatio"),d("amountWaveRatio"),d("baseLotSize"),d("quoteLotSize"),d("minPriceMultiplier"),d("maxPriceMultiplier"),d("systemDecimalValue"),d("minSeparateNumerator"),d("minSeparateDenominator"),d("tradeFeeNumerator"),d("tradeFeeDenominator"),d("pnlNumerator"),d("pnlDenominator"),d("swapFeeNumerator"),d("swapFeeDenominator"),d("baseNeedTakePnl"),d("quoteNeedTakePnl"),d("quoteTotalPnl"),d("baseTotalPnl"),d("poolOpenTime"),d("punishPcAmount"),d("punishCoinAmount"),d("orderbookToInitTime"),X("swapBaseInAmount"),X("swapQuoteOutAmount"),d("swapBase2QuoteFee"),X("swapQuoteInAmount"),X("swapBaseOutAmount"),d("swapQuote2BaseFee"),S("baseVault"),S("quoteVault"),S("baseMint"),S("quoteMint"),S("lpMint"),S("openOrders"),S("marketId"),S("marketProgramId"),S("targetOrders"),S("withdrawQueue"),S("lpVault"),S("owner"),d("lpReserve"),Be(d(),3,"padding")]),En=D([d("accountType"),d("status"),d("nonce"),d("maxOrder"),d("depth"),d("baseDecimal"),d("quoteDecimal"),d("state"),d("resetFlag"),d("minSize"),d("volMaxCutRatio"),d("amountWaveRatio"),d("baseLotSize"),d("quoteLotSize"),d("minPriceMultiplier"),d("maxPriceMultiplier"),d("systemDecimalsValue"),d("abortTradeFactor"),d("priceTickMultiplier"),d("priceTick"),d("minSeparateNumerator"),d("minSeparateDenominator"),d("tradeFeeNumerator"),d("tradeFeeDenominator"),d("pnlNumerator"),d("pnlDenominator"),d("swapFeeNumerator"),d("swapFeeDenominator"),d("baseNeedTakePnl"),d("quoteNeedTakePnl"),d("quoteTotalPnl"),d("baseTotalPnl"),d("poolOpenTime"),d("punishPcAmount"),d("punishCoinAmount"),d("orderbookToInitTime"),X("swapBaseInAmount"),X("swapQuoteOutAmount"),X("swapQuoteInAmount"),X("swapBaseOutAmount"),d("swapQuote2BaseFee"),d("swapBase2QuoteFee"),S("baseVault"),S("quoteVault"),S("baseMint"),S("quoteMint"),S("lpMint"),S("modelDataAccount"),S("openOrders"),S("marketId"),S("marketProgramId"),S("targetOrders"),S("owner"),Be(d(),64,"padding")]),mt=D([v("instruction"),d("baseAmountIn"),d("quoteAmountIn"),d("fixedSide"),d("otherAmountMin")]),pt=D([v("instruction"),d("lpAmount"),d("baseAmountMin"),d("quoteAmountMin")]),Do={4:lt,5:En},_o=D([d("fee")]);import{PublicKey as _e}from"@solana/web3.js";import De from"bn.js";var Te=9e15,ue=1e9,ft="0123456789abcdef",Ue="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ge="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",dt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Te,maxE:Te,crypto:!1},Gt,J,A=!0,je="[DecimalError] ",ae=je+"Invalid argument: ",Ht=je+"Precision limit exceeded",jt=je+"crypto unavailable",Qt="[object Decimal]",U=Math.floor,_=Math.pow,Rn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,vn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Dn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,zt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,z=1e7,T=7,_n=9007199254740991,On=Ue.length-1,gt=Ge.length-1,g={toStringTag:Qt};g.absoluteValue=g.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),y(e)};g.ceil=function(){return y(new this.constructor(this),this.e+1,2)};g.clampedTo=g.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(ae+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};g.comparedTo=g.cmp=function(e){var t,n,r,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,c=o.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(r=s.length,i=a.length,t=0,n=r<i?r:i;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};g.cosine=g.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+T,r.rounding=1,n=Vn(r,$t(r,n)),r.precision=e,r.rounding=t,y(J==2||J==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};g.cubeRoot=g.cbrt=function(){var e,t,n,r,i,o,s,a,c,u,l=this,m=l.constructor;if(!l.isFinite()||l.isZero())return new m(l);for(A=!1,o=l.s*_(l.s*l,1/3),!o||Math.abs(o)==1/0?(n=F(l.d),e=l.e,(o=(e-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=_(n,1/3),e=U((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?n="5e"+e:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new m(n),r.s=l.s):r=new m(o.toString()),s=(e=m.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(l),r=C(u.plus(l).times(a),u.plus(c),s+2,1),F(a.d).slice(0,s)===(n=F(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(y(a,e+1,0),a.times(a).times(a).eq(l))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(y(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return A=!0,y(r,e,m.rounding,t)};g.decimalPlaces=g.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-U(this.e/T))*T,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};g.dividedBy=g.div=function(e){return C(this,new this.constructor(e))};g.dividedToIntegerBy=g.divToInt=function(e){var t=this,n=t.constructor;return y(C(t,new n(e),0,1,1),n.precision,n.rounding)};g.equals=g.eq=function(e){return this.cmp(e)===0};g.floor=function(){return y(new this.constructor(this),this.e+1,3)};g.greaterThan=g.gt=function(e){return this.cmp(e)>0};g.greaterThanOrEqualTo=g.gte=function(e){var t=this.cmp(e);return t==1||t===0};g.hyperbolicCosine=g.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/ze(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=we(s,1,o.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=o.times(o),o=a.minus(c.times(l.minus(c.times(l))));return y(o,s.precision=n,s.rounding=r,!0)};g.hyperbolicSine=g.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=we(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/ze(5,e)),i=we(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=t,o.rounding=n,y(i,t,n,!0)};g.hyperbolicTangent=g.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,C(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};g.inverseCosine=g.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?t.isNeg()?Q(n,i,o):new n(0):new n(NaN):t.isZero()?Q(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=Q(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))};g.inverseHyperbolicCosine=g.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,A=!1,n=n.times(n).minus(1).sqrt().plus(n),A=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};g.inverseHyperbolicSine=g.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,A=!1,n=n.times(n).plus(1).sqrt().plus(n),A=!0,r.precision=e,r.rounding=t,n.ln())};g.inverseHyperbolicTangent=g.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?y(new o(i),e,t,!0):(o.precision=n=r-i.e,i=C(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};g.inverseSine=g.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?t===0?(e=Q(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};g.inverseTangent=g.atan=function(){var e,t,n,r,i,o,s,a,c,u=this,l=u.constructor,m=l.precision,p=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&m+4<=gt)return s=Q(l,m+4,p).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(m+4<=gt)return s=Q(l,m+4,p).times(.5),s.s=u.s,s}for(l.precision=a=m+10,l.rounding=1,n=Math.min(28,a/T+2|0),e=n;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(A=!1,t=Math.ceil(a/T),r=1,c=u.times(u),s=new l(u),i=u;e!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),A=!0,y(s,l.precision=m,l.rounding=p,!0)};g.isFinite=function(){return!!this.d};g.isInteger=g.isInt=function(){return!!this.d&&U(this.e/T)>this.d.length-2};g.isNaN=function(){return!this.s};g.isNegative=g.isNeg=function(){return this.s<0};g.isPositive=g.isPos=function(){return this.s>0};g.isZero=function(){return!!this.d&&this.d[0]===0};g.lessThan=g.lt=function(e){return this.cmp(e)<0};g.lessThanOrEqualTo=g.lte=function(e){return this.cmp(e)<1};g.logarithm=g.log=function(e){var t,n,r,i,o,s,a,c,u=this,l=u.constructor,m=l.precision,p=l.rounding,b=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=u.d,u.s<0||!n||!n[0]||u.eq(1))return new l(n&&!n[0]?-1/0:u.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(A=!1,a=m+b,s=se(u,a),r=t?He(l,a+10):se(e,a),c=C(s,r,a,1),Le(c.d,i=m,p))do if(a+=10,s=se(u,a),r=t?He(l,a+10):se(e,a),c=C(s,r,a,1),!o){+F(c.d).slice(i+1,i+15)+1==1e14&&(c=y(c,m+1,0));break}while(Le(c.d,i+=10,p));return A=!0,y(c,m,p)};g.minus=g.sub=function(e){var t,n,r,i,o,s,a,c,u,l,m,p,b=this,w=b.constructor;if(e=new w(e),!b.d||!e.d)return!b.s||!e.s?e=new w(NaN):b.d?e.s=-e.s:e=new w(e.d||b.s!==e.s?b:NaN),e;if(b.s!=e.s)return e.s=-e.s,b.plus(e);if(u=b.d,p=e.d,a=w.precision,c=w.rounding,!u[0]||!p[0]){if(p[0])e.s=-e.s;else if(u[0])e=new w(b);else return new w(c===3?-0:0);return A?y(e,a,c):e}if(n=U(e.e/T),l=U(b.e/T),u=u.slice(),o=l-n,o){for(m=o<0,m?(t=u,o=-o,s=p.length):(t=p,n=l,s=u.length),r=Math.max(Math.ceil(a/T),s)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=u.length,s=p.length,m=r<s,m&&(s=r),r=0;r<s;r++)if(u[r]!=p[r]){m=u[r]<p[r];break}o=0}for(m&&(t=u,u=p,p=t,e.s=-e.s),s=u.length,r=p.length-s;r>0;--r)u[s++]=0;for(r=p.length;r>o;){if(u[--r]<p[r]){for(i=r;i&&u[--i]===0;)u[i]=z-1;--u[i],u[r]+=z}u[r]-=p[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=Qe(u,n),A?y(e,a,c):e):new w(c===3?-0:0)};g.modulo=g.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?y(new r(n),r.precision,r.rounding):(A=!1,r.modulo==9?(t=C(n,e.abs(),0,3,1),t.s*=e.s):t=C(n,e,0,r.modulo,1),t=t.times(e),A=!0,n.minus(t))};g.naturalExponential=g.exp=function(){return bt(this)};g.naturalLogarithm=g.ln=function(){return se(this)};g.negated=g.neg=function(){var e=new this.constructor(this);return e.s=-e.s,y(e)};g.plus=g.add=function(e){var t,n,r,i,o,s,a,c,u,l,m=this,p=m.constructor;if(e=new p(e),!m.d||!e.d)return!m.s||!e.s?e=new p(NaN):m.d||(e=new p(e.d||m.s===e.s?m:NaN)),e;if(m.s!=e.s)return e.s=-e.s,m.minus(e);if(u=m.d,l=e.d,a=p.precision,c=p.rounding,!u[0]||!l[0])return l[0]||(e=new p(m)),A?y(e,a,c):e;if(o=U(m.e/T),r=U(e.e/T),u=u.slice(),i=o-r,i){for(i<0?(n=u,i=-i,s=l.length):(n=l,r=o,s=u.length),o=Math.ceil(a/T),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=u.length,i=l.length,s-i<0&&(i=s,n=l,l=u,u=n),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/z|0,u[i]%=z;for(t&&(u.unshift(t),++r),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=Qe(u,r),A?y(e,a,c):e};g.precision=g.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ae+e);return n.d?(t=Zt(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};g.round=function(){var e=this,t=e.constructor;return y(new t(e),e.e+1,t.rounding)};g.sine=g.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+T,r.rounding=1,n=Wn(r,$t(r,n)),r.precision=e,r.rounding=t,y(J>2?n.neg():n,e,t,!0)):new r(NaN)};g.squareRoot=g.sqrt=function(){var e,t,n,r,i,o,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(A=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=F(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=U((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new l(t)):r=new l(u.toString()),n=(c=l.precision)+3;;)if(o=r,r=o.plus(C(s,o,n+2,1)).times(.5),F(o.d).slice(0,n)===(t=F(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(y(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(y(r,c+1,1),e=!r.times(r).eq(s));break}return A=!0,y(r,c,l.rounding,e)};g.tangent=g.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=C(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,y(J==2||J==4?n.neg():n,e,t,!0)):new r(NaN)};g.times=g.mul=function(e){var t,n,r,i,o,s,a,c,u,l=this,m=l.constructor,p=l.d,b=(e=new m(e)).d;if(e.s*=l.s,!p||!p[0]||!b||!b[0])return new m(!e.s||p&&!p[0]&&!b||b&&!b[0]&&!p?NaN:!p||!b?e.s/0:e.s*0);for(n=U(l.e/T)+U(e.e/T),c=p.length,u=b.length,c<u&&(o=p,p=b,b=o,s=c,c=u,u=s),o=[],s=c+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,i=c+r;i>r;)a=o[i]+b[r]*p[i-r-1]+t,o[i--]=a%z|0,t=a/z|0;o[i]=(o[i]+t)%z|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=Qe(o,n),A?y(e,m.precision,m.rounding):e};g.toBinary=function(e,t){return yt(this,2,e,t)};g.toDecimalPlaces=g.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(G(e,0,ue),t===void 0?t=r.rounding:G(t,0,8),y(n,e+n.e+1,t))};g.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=Z(r,!0):(G(e,0,ue),t===void 0?t=i.rounding:G(t,0,8),r=y(new i(r),e+1,t),n=Z(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};g.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return e===void 0?n=Z(i):(G(e,0,ue),t===void 0?t=o.rounding:G(t,0,8),r=y(new o(i),e+i.e+1,t),n=Z(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};g.toFraction=function(e){var t,n,r,i,o,s,a,c,u,l,m,p,b=this,w=b.d,h=b.constructor;if(!w)return new h(b);if(u=n=new h(1),r=c=new h(0),t=new h(r),o=t.e=Zt(w)-b.e-1,s=o%T,t.d[0]=_(10,s<0?T+s:s),e==null)e=o>0?t:u;else{if(a=new h(e),!a.isInt()||a.lt(u))throw Error(ae+a);e=a.gt(t)?o>0?t:u:a}for(A=!1,a=new h(F(w)),l=h.precision,h.precision=o=w.length*T*2;m=C(a,t,0,1,1),i=n.plus(m.times(r)),i.cmp(e)!=1;)n=r,r=i,i=u,u=c.plus(m.times(i)),c=i,i=t,t=a.minus(m.times(i)),a=i;return i=C(e.minus(n),r,0,1,1),c=c.plus(i.times(u)),n=n.plus(i.times(r)),c.s=u.s=b.s,p=C(u,r,o,1).minus(b).abs().cmp(C(c,n,o,1).minus(b).abs())<1?[u,r]:[c,n],h.precision=l,A=!0,p};g.toHexadecimal=g.toHex=function(e,t){return yt(this,16,e,t)};g.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:G(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(A=!1,n=C(n,e,0,t,1).times(e),A=!0,y(n)):(e.s=n.s,n=e),n};g.toNumber=function(){return+this};g.toOctal=function(e,t){return yt(this,8,e,t)};g.toPower=g.pow=function(e){var t,n,r,i,o,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(_(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,o=c.rounding,e.eq(1))return y(a,r,o);if(t=U(e.e/T),t>=e.d.length-1&&(n=u<0?-u:u)<=_n)return i=Yt(c,a,n,r),e.s<0?new c(1).div(i):y(i,r,o);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=_(+a,u),t=n==0||!isFinite(n)?U(u*(Math.log("0."+F(a.d))/Math.LN10+a.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(A=!1,c.rounding=a.s=1,n=Math.min(12,(t+"").length),i=bt(e.times(se(a,r+n)),r),i.d&&(i=y(i,r+5,1),Le(i.d,r,o)&&(t=r+10,i=y(bt(e.times(se(a,t+n)),t),t+5,1),+F(i.d).slice(r+1,r+15)+1==1e14&&(i=y(i,r+1,0)))),i.s=s,A=!0,c.rounding=o,y(i,r,o))};g.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=Z(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(G(e,1,ue),t===void 0?t=i.rounding:G(t,0,8),r=y(new i(r),e,t),n=Z(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};g.toSignificantDigits=g.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(G(e,1,ue),t===void 0?t=r.rounding:G(t,0,8)),y(new r(n),e,t)};g.toString=function(){var e=this,t=e.constructor,n=Z(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};g.truncated=g.trunc=function(){return y(new this.constructor(this),this.e+1,1)};g.valueOf=g.toJSON=function(){var e=this,t=e.constructor,n=Z(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function F(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",n=T-r.length,n&&(o+=oe(n)),o+=r;s=e[t],r=s+"",n=T-r.length,n&&(o+=oe(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function G(e,t,n){if(e!==~~e||e<t||e>n)throw Error(ae+e)}function Le(e,t,n,r){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=T,i=0):(i=Math.ceil((t+1)/T),t%=T),o=_(10,T-t),a=e[i]%o|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(e[i+1]/o/100|0)==_(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==_(10,t-3)-1,s}function qe(e,t,n){for(var r,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=ft.indexOf(e.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function Vn(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/ze(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=we(e,1,t.times(i),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var C=function(){function e(r,i,o){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+a,r[c]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function t(r,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,c){var u,l,m,p,b,w,h,R,L,W,I,V,he,H,Ie,le,me,ye,j,Oe,Ve=r.constructor,tt=r.s==i.s?1:-1,q=r.d,M=i.d;if(!q||!q[0]||!M||!M[0])return new Ve(!r.s||!i.s||(q?M&&q[0]==M[0]:!M)?NaN:q&&q[0]==0||!M?tt*0:tt/0);for(c?(b=1,l=r.e-i.e):(c=z,b=T,l=U(r.e/b)-U(i.e/b)),j=M.length,me=q.length,L=new Ve(tt),W=L.d=[],m=0;M[m]==(q[m]||0);m++);if(M[m]>(q[m]||0)&&l--,o==null?(H=o=Ve.precision,s=Ve.rounding):a?H=o+(r.e-i.e)+1:H=o,H<0)W.push(1),w=!0;else{if(H=H/b+2|0,m=0,j==1){for(p=0,M=M[0],H++;(m<me||p)&&H--;m++)Ie=p*c+(q[m]||0),W[m]=Ie/M|0,p=Ie%M|0;w=p||m<me}else{for(p=c/(M[0]+1)|0,p>1&&(M=e(M,p,c),q=e(q,p,c),j=M.length,me=q.length),le=j,I=q.slice(0,j),V=I.length;V<j;)I[V++]=0;Oe=M.slice(),Oe.unshift(0),ye=M[0],M[1]>=c/2&&++ye;do p=0,u=t(M,I,j,V),u<0?(he=I[0],j!=V&&(he=he*c+(I[1]||0)),p=he/ye|0,p>1?(p>=c&&(p=c-1),h=e(M,p,c),R=h.length,V=I.length,u=t(h,I,R,V),u==1&&(p--,n(h,j<R?Oe:M,R,c))):(p==0&&(u=p=1),h=M.slice()),R=h.length,R<V&&h.unshift(0),n(I,h,V,c),u==-1&&(V=I.length,u=t(M,I,j,V),u<1&&(p++,n(I,j<V?Oe:M,V,c))),V=I.length):u===0&&(p++,I=[0]),W[m++]=p,u&&I[0]?I[V++]=q[le]||0:(I=[q[le]],V=1);while((le++<me||I[0]!==void 0)&&H--);w=I[0]!==void 0}W[0]||W.shift()}if(b==1)L.e=l,Gt=w;else{for(m=1,p=W[0];p>=10;p/=10)m++;L.e=m+l*b-1,y(L,a?o+L.e+1:o,s,w)}return L}}();function y(e,t,n,r){var i,o,s,a,c,u,l,m,p,b=e.constructor;e:if(t!=null){if(m=e.d,!m)return e;for(i=1,a=m[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=T,s=t,l=m[p=0],c=l/_(10,i-s-1)%10|0;else if(p=Math.ceil((o+1)/T),a=m.length,p>=a)if(r){for(;a++<=p;)m.push(0);l=c=0,i=1,o%=T,s=o-T+1}else break e;else{for(l=a=m[p],i=1;a>=10;a/=10)i++;o%=T,s=o-T+i,c=s<0?0:l/_(10,i-s-1)%10|0}if(r=r||t<0||m[p+1]!==void 0||(s<0?l:l%_(10,i-s-1)),u=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?l/_(10,i-s):0:m[p-1])%10&1||n==(e.s<0?8:7)),t<1||!m[0])return m.length=0,u?(t-=e.e+1,m[0]=_(10,(T-t%T)%T),e.e=-t||0):m[0]=e.e=0,e;if(o==0?(m.length=p,a=1,p--):(m.length=p+1,a=_(10,T-o),m[p]=s>0?(l/_(10,i-s)%_(10,s)|0)*a:0),u)for(;;)if(p==0){for(o=1,s=m[0];s>=10;s/=10)o++;for(s=m[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,m[0]==z&&(m[0]=1));break}else{if(m[p]+=a,m[p]!=z)break;m[p--]=0,a=1}for(o=m.length;m[--o]===0;)m.pop()}return A&&(e.e>b.maxE?(e.d=null,e.e=NaN):e.e<b.minE&&(e.e=0,e.d=[0])),e}function Z(e,t,n){if(!e.isFinite())return Jt(e);var r,i=e.e,o=F(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+oe(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+oe(-i-1)+o,n&&(r=n-s)>0&&(o+=oe(r))):i>=s?(o+=oe(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+oe(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=oe(r))),o}function Qe(e,t){var n=e[0];for(t*=T;n>=10;n/=10)t++;return t}function He(e,t,n){if(t>On)throw A=!0,n&&(e.precision=n),Error(Ht);return y(new e(Ue),t,1,!0)}function Q(e,t,n){if(t>gt)throw Error(Ht);return y(new e(Ge),t,n,!0)}function Zt(e){var t=e.length-1,n=t*T+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function oe(e){for(var t="";e--;)t+="0";return t}function Yt(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/T+4);for(A=!1;;){if(n%2&&(o=o.times(t),qt(o.d,s)&&(i=!0)),n=U(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}t=t.times(t),qt(t.d,s)}return A=!0,o}function Wt(e){return e.d[e.d.length-1]&1}function Xt(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function bt(e,t){var n,r,i,o,s,a,c,u=0,l=0,m=0,p=e.constructor,b=p.rounding,w=p.precision;if(!e.d||!e.d[0]||e.e>17)return new p(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(A=!1,c=w):c=t,a=new p(.03125);e.e>-2;)e=e.times(a),m+=5;for(r=Math.log(_(2,m))/Math.LN10*2+5|0,c+=r,n=o=s=new p(1),p.precision=c;;){if(o=y(o.times(e),c,1),n=n.times(++l),a=s.plus(C(o,n,c,1)),F(a.d).slice(0,c)===F(s.d).slice(0,c)){for(i=m;i--;)s=y(s.times(s),c,1);if(t==null)if(u<3&&Le(s.d,c-r,b,u))p.precision=c+=10,n=o=a=new p(1),l=0,u++;else return y(s,p.precision=w,b,A=!0);else return p.precision=w,s}s=a}}function se(e,t){var n,r,i,o,s,a,c,u,l,m,p,b=1,w=10,h=e,R=h.d,L=h.constructor,W=L.rounding,I=L.precision;if(h.s<0||!R||!R[0]||!h.e&&R[0]==1&&R.length==1)return new L(R&&!R[0]?-1/0:h.s!=1?NaN:R?0:h);if(t==null?(A=!1,l=I):l=t,L.precision=l+=w,n=F(R),r=n.charAt(0),Math.abs(o=h.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)h=h.times(e),n=F(h.d),r=n.charAt(0),b++;o=h.e,r>1?(h=new L("0."+n),o++):h=new L(r+"."+n.slice(1))}else return u=He(L,l+2,I).times(o+""),h=se(new L(r+"."+n.slice(1)),l-w).plus(u),L.precision=I,t==null?y(h,I,W,A=!0):h;for(m=h,c=s=h=C(h.minus(1),h.plus(1),l,1),p=y(h.times(h),l,1),i=3;;){if(s=y(s.times(p),l,1),u=c.plus(C(s,new L(i),l,1)),F(u.d).slice(0,l)===F(c.d).slice(0,l))if(c=c.times(2),o!==0&&(c=c.plus(He(L,l+2,I).times(o+""))),c=C(c,new L(b),l,1),t==null)if(Le(c.d,l-w,W,a))L.precision=l+=w,u=s=h=C(m.minus(1),m.plus(1),l,1),p=y(h.times(h),l,1),i=a=1;else return y(c,L.precision=I,W,A=!0);else return L.precision=I,c;c=u,i+=2}}function Jt(e){return String(e.s*e.s/0)}function ht(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%T,n<0&&(r+=T),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=T;r<i;)e.d.push(+t.slice(r,r+=T));t=t.slice(r),r=T-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),A&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Fn(e,t){var n,r,i,o,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),zt.test(t))return ht(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(vn.test(t))n=16,t=t.toLowerCase();else if(Rn.test(t))n=2;else if(Dn.test(t))n=8;else throw Error(ae+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,r=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=Yt(r,new r(n),o,o*2)),u=qe(t,n,z),l=u.length-1,o=l;u[o]===0;--o)u.pop();return o<0?new r(e.s*0):(e.e=Qe(u,l),e.d=u,A=!1,s&&(e=C(e,i,a*4)),c&&(e=e.times(Math.abs(c)<54?_(2,c):Ne.pow(2,c))),A=!0,e)}function Wn(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:we(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/ze(5,n)),t=we(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function we(e,t,n,r,i){var o,s,a,c,u=1,l=e.precision,m=Math.ceil(l/T);for(A=!1,c=n.times(n),a=new e(r);;){if(s=C(a.times(c),new e(t++*t++),l,1),a=i?r.plus(s):r.minus(s),r=C(s.times(c),new e(t++*t++),l,1),s=a.plus(r),s.d[m]!==void 0){for(o=m;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,u++}return A=!0,s.d.length=m+1,s}function ze(e,t){for(var n=e;--t;)n*=e;return n}function $t(e,t){var n,r=t.s<0,i=Q(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return J=r?4:1,t;if(n=t.divToInt(i),n.isZero())J=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return J=Wt(n)?r?2:3:r?4:1,t;J=Wt(n)?r?1:4:r?3:2}return t.minus(i).abs()}function yt(e,t,n,r){var i,o,s,a,c,u,l,m,p,b=e.constructor,w=n!==void 0;if(w?(G(n,1,ue),r===void 0?r=b.rounding:G(r,0,8)):(n=b.precision,r=b.rounding),!e.isFinite())l=Jt(e);else{for(l=Z(e),s=l.indexOf("."),w?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,s>=0&&(l=l.replace(".",""),p=new b(1),p.e=l.length-s,p.d=qe(Z(p),10,i),p.e=p.d.length),m=qe(l,10,i),o=c=m.length;m[--c]==0;)m.pop();if(!m[0])l=w?"0p+0":"0";else{if(s<0?o--:(e=new b(e),e.d=m,e.e=o,e=C(e,p,n,r,0,i),m=e.d,o=e.e,u=Gt),s=m[n],a=i/2,u=u||m[n+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(e.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&m[n-1]&1||r===(e.s<0?8:7)),m.length=n,u)for(;++m[--n]>i-1;)m[n]=0,n||(++o,m.unshift(1));for(c=m.length;!m[c-1];--c);for(s=0,l="";s<c;s++)l+=ft.charAt(m[s]);if(w){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(m=qe(l,i,t),c=m.length;!m[c-1];--c);for(s=1,l="1.";s<c;s++)l+=ft.charAt(m[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>c)for(o-=c;o--;)l+="0";else o<c&&(l=l.slice(0,o)+"."+l.slice(o))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function qt(e,t){if(e.length>t)return e.length=t,!0}function qn(e){return new this(e).abs()}function Un(e){return new this(e).acos()}function Gn(e){return new this(e).acosh()}function Hn(e,t){return new this(e).plus(t)}function jn(e){return new this(e).asin()}function Qn(e){return new this(e).asinh()}function zn(e){return new this(e).atan()}function Zn(e){return new this(e).atanh()}function Yn(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=Q(this,o,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?Q(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=Q(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(C(e,t,o,1)),t=Q(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(C(e,t,o,1)),n}function Xn(e){return new this(e).cbrt()}function Jn(e){return y(e=new this(e),e.e+1,2)}function $n(e,t,n){return new this(e).clamp(t,n)}function er(e){if(!e||typeof e!="object")throw Error(je+"Object expected");var t,n,r,i=e.defaults===!0,o=["precision",1,ue,"rounding",0,8,"toExpNeg",-Te,0,"toExpPos",0,Te,"maxE",0,Te,"minE",-Te,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=dt[n]),(r=e[n])!==void 0)if(U(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(ae+n+": "+r);if(n="crypto",i&&(this[n]=dt[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(jt);else this[n]=!1;else throw Error(ae+n+": "+r);return this}function tr(e){return new this(e).cos()}function nr(e){return new this(e).cosh()}function en(e){var t,n,r;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,Ut(o)){u.s=o.s,A?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;A?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return ht(u,o.toString())}else if(c!=="string")throw Error(ae+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),zt.test(o)?ht(u,o):Fn(u,o)}if(i.prototype=g,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=er,i.clone=en,i.isDecimal=Ut,i.abs=qn,i.acos=Un,i.acosh=Gn,i.add=Hn,i.asin=jn,i.asinh=Qn,i.atan=zn,i.atanh=Zn,i.atan2=Yn,i.cbrt=Xn,i.ceil=Jn,i.clamp=$n,i.cos=tr,i.cosh=nr,i.div=rr,i.exp=ir,i.floor=or,i.hypot=sr,i.ln=ar,i.log=ur,i.log10=lr,i.log2=cr,i.max=mr,i.min=pr,i.mod=fr,i.mul=dr,i.pow=gr,i.random=br,i.round=hr,i.sign=yr,i.sin=Tr,i.sinh=wr,i.sqrt=Pr,i.sub=xr,i.sum=Ar,i.tan=kr,i.tanh=Sr,i.trunc=Ir,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function rr(e,t){return new this(e).div(t)}function ir(e){return new this(e).exp()}function or(e){return y(e=new this(e),e.e+1,3)}function sr(){var e,t,n=new this(0);for(A=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return A=!0,new this(1/0);n=t}return A=!0,n.sqrt()}function Ut(e){return e instanceof Ne||e&&e.toStringTag===Qt||!1}function ar(e){return new this(e).ln()}function ur(e,t){return new this(e).log(t)}function cr(e){return new this(e).log(2)}function lr(e){return new this(e).log(10)}function mr(){return Xt(this,arguments,"lt")}function pr(){return Xt(this,arguments,"gt")}function fr(e,t){return new this(e).mod(t)}function dr(e,t){return new this(e).mul(t)}function gr(e,t){return new this(e).pow(t)}function br(e){var t,n,r,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:G(e,1,ue),r=Math.ceil(e/T),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(jt);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],e%=T,r&&e&&(i=_(10,T-e),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=T)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<T&&(n-=T-r)}return s.e=n,s.d=a,s}function hr(e){return y(e=new this(e),e.e+1,this.rounding)}function yr(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Tr(e){return new this(e).sin()}function wr(e){return new this(e).sinh()}function Pr(e){return new this(e).sqrt()}function xr(e,t){return new this(e).sub(t)}function Ar(){var e=0,t=arguments,n=new this(t[e]);for(A=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return A=!0,y(n,this.precision,this.rounding)}function kr(e){return new this(e).tan()}function Sr(e){return new this(e).tanh()}function Ir(e){return y(e=new this(e),e.e+1,1)}g[Symbol.for("nodejs.util.inspect.custom")]=g.toString;g[Symbol.toStringTag]="Decimal";var Ne=g.constructor=en(dt);Ue=new Ne(Ue);Ge=new Ne(Ge);var Pe=Ne;import{TOKEN_PROGRAM_ID as Ai}from"@solana/spl-token";import{ComputeBudgetProgram as Ho,Keypair as zo,PublicKey as rn,Transaction as wt,TransactionMessage as Xo,VersionedTransaction as Jo}from"@solana/web3.js";import{get as tn,set as Br}from"lodash";var Tt=class{logLevel;name;constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},nn={},Lr={};function O(e){let t=tn(nn,e);if(!t){let n=tn(Lr,e);t=new Tt({name:e,logLevel:n}),Br(nn,e,t)}return t}var Ce={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip",NonceAccount:"NonceAccount"};import{TOKEN_PROGRAM_ID as ns}from"@solana/spl-token";var $=O("Raydium_txUtil"),Nr=1644;function Cr(e,t){e.length<1&&$.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&$.logWithError(`no signers provided:, ${t.toString()}`);let n=new wt;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=t[0],n.add(...e);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<Nr}catch{return!1}}async function on(e,t,n,r=!0){let i=new rn("RaydiumSimuLateTransaction11111111111111111"),o=[],s=new wt;s.feePayer=i;for(let u of t)Cr([...s.instructions,u],[i])||(o.push(s),s=new wt,s.feePayer=i),s.add(u);s.instructions.length>0&&o.push(s);let a=[];try{if(a=await Mr(e,o,r),a.find(u=>u.err!==null))throw Error("rpc simulateTransaction error")}catch(u){u instanceof Error&&$.logWithError("failed to simulate for instructions","RPC_ERROR",{message:u.message})}let c=[];for(let u of a)if($.debug("simulate result:",u),u.logs){let l=u.logs.filter(m=>m&&m.includes(n));$.debug("filteredLog:",c),l.length||$.logWithError("simulate log not match keyword","keyword",n),c.push(...l)}return c}function sn(e,t){let n=e.match(/{["\w:,]+}/g);return!n||n.length!==1?$.logWithError(`simulate log fail to match json, keyword: ${t}`):n[0]}function ee(e,t){let r=new RegExp(`"${t}":(\\d+)`,"g").exec(e);return!r||r.length!==2?$.logWithError(`simulate log fail to match key", key: ${t}`):r[1]}function xe(e,t){let[n,r]=rn.findProgramAddressSync(e,t);return{publicKey:n,nonce:r}}async function Mr(e,t,n){let r=[];if(n){let i=await e.getLatestBlockhash(),o=[];for(let u of t){u.recentBlockhash=i.blockhash,u.lastValidBlockHeight=i.lastValidBlockHeight;let m=u._compile().serialize(),b=u._serialize(m).toString("base64");o.push(b)}let s=o.map(u=>{let l=e._buildArgs([u],void 0,"base64");return{methodName:"simulateTransaction",args:l}}),a=[],c=20;for(let u=0;u<Math.ceil(s.length/c);u++)a.push(s.slice(u*c,(u+1)*c));r=await(await Promise.all(a.map(async u=>(await e._rpcBatchRequest(u)).map(l=>l.result.value)))).flat()}else try{r=await Promise.all(t.map(async i=>await(await e.simulateTransaction(i)).value))}catch(i){i instanceof Error&&$.logWithError("failed to get info for multiple accounts","RPC_ERROR",{message:i.message})}return r}import{PublicKey as rl}from"@solana/web3.js";import{MintLayout as ol,TOKEN_PROGRAM_ID as al}from"@solana/spl-token";import ni from"big.js";import Je from"bn.js";import re from"bn.js";import{PublicKey as Kr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as an}from"@solana/spl-token";var Pt={chainId:101,address:Kr.default.toBase58(),programId:an.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},te={chainId:101,address:"So11111111111111111111111111111111111111112",programId:an.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as It}from"@solana/web3.js";import{PublicKey as E,SystemProgram as un,SYSVAR_RENT_PUBKEY as Er}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Rr}from"@solana/spl-token";function f({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var ls=[f({pubkey:Rr,isWritable:!1}),f({pubkey:un.programId,isWritable:!1}),f({pubkey:Er,isWritable:!1})];function At({publicKey:e,transformSol:t}){let n=kt(e.toString());if(n instanceof E)return t&&n.equals(Me)?xt:n;if(t&&n.toString()===Me.toBase58())return xt;if(typeof n=="string"){if(n===E.default.toBase58())return E.default;try{return new E(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function kt(e){try{return new E(e)}catch{return e}}var ms=new E("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ps=new E("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),cn=new E("SysvarRent111111111111111111111111111111111"),fs=new E("SysvarC1ock11111111111111111111111111111111"),ds=new E("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),gs=new E("Sysvar1nstructions1111111111111111111111111"),bs=un.programId,hs=new E("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),ys=new E("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Ts=new E("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),ws=new E("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Ps=new E("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),xs=new E("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),As=new E("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),ks=new E("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Ss=new E("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Is=new E("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Bs=new E("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),xt=new E("So11111111111111111111111111111111111111112"),Me=E.default;function St(e){return At({publicKey:e,transformSol:!0})}var Bt=class{symbol;name;decimals;isToken2022;mint;constructor({mint:t,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===Me.toBase58()||t instanceof It&&Me.equals(t)){this.decimals=te.decimals,this.symbol=te.symbol,this.name=te.name,this.mint=new It(te.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?It.default:At({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},ce=Bt;Fe(ce,"WSOL",new Bt({...te,mint:te.address}));var Lt=class{symbol;name;decimals;constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},Ze=Lt;Fe(Ze,"SOL",new Lt(Pt));import Xe from"big.js";import Or from"bn.js";import Vr from"decimal.js-light";import Ke from"bn.js";var ln=9007199254740991;function K(e){let t=O("Raydium_parseBigNumberish");if(e instanceof Ke)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new Ke(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=ln||e<=-ln)&&t.logWithError(`BigNumberish number overflow: ${e}`),new Ke(String(e))):typeof e=="bigint"?new Ke(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new Ke(0))}import vr from"toformat";var Dr=vr,Ee=Dr;var Ye=O("module/fraction"),Nt=Ee(Xe),Re=Ee(Vr),Fr={[0]:Re.ROUND_DOWN,[1]:Re.ROUND_HALF_UP,[2]:Re.ROUND_UP},Wr={[0]:Xe.roundDown,[1]:Xe.roundHalfUp,[2]:Xe.roundUp},B=class{numerator;denominator;constructor(t,n=new Or(1)){this.numerator=K(t),this.denominator=K(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new B(this.denominator,this.numerator)}add(t){let n=t instanceof B?t:new B(K(t));return this.denominator.eq(n.denominator)?new B(this.numerator.add(n.numerator),this.denominator):new B(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof B?t:new B(K(t));return this.denominator.eq(n.denominator)?new B(this.numerator.sub(n.numerator),this.denominator):new B(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof B?t:new B(K(t));return new B(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof B?t:new B(K(t));return new B(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||Ye.logWithError(`${t} is not an integer.`),t<=0&&Ye.logWithError(`${t} is not positive.`),Re.set({precision:t+1,rounding:Fr[r]});let i=new Re(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||Ye.logWithError(`${t} is not an integer.`),t<0&&Ye.logWithError(`${t} is negative.`),Nt.DP=t,Nt.RM=Wr[r]||1,new Nt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};import qr from"bn.js";var mn=new B(new qr(100)),Ae=class extends B{toSignificant(t=5,n,r){return this.mul(mn).toSignificant(t,n,r)}toFixed(t=2,n,r){return this.mul(mn).toFixed(t,n,r)}};var Ur=O("Raydium_price"),ne=class extends B{baseToken;quoteToken;scalar;constructor(t){let{baseToken:n,quoteToken:r,numerator:i,denominator:o}=t;super(i,o),this.baseToken=n,this.quoteToken=r,this.scalar=new B(Ct(n.decimals),Ct(r.decimals))}get raw(){return new B(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new ne({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(t){this.quoteToken!==t.baseToken&&Ur.logWithError("mul token not equals");let n=super.mul(t);return new ne({baseToken:this.baseToken,quoteToken:t.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(t=this.quoteToken.decimals,n,r){return this.adjusted.toSignificant(t,n,r)}toFixed(t=this.quoteToken.decimals,n,r){return this.adjusted.toFixed(t,n,r)}};import{PublicKey as Gr}from"@solana/web3.js";import Hr from"bn.js";function pn(e){return typeof e=="object"&&e!==null&&![ce,Y,Gr,B,Hr,ne,Ae].some(t=>typeof t=="object"&&e instanceof t)}function fe(e){return typeof e=="string"?kt(e):Array.isArray(e)?e.map(t=>fe(t)):pn(e)?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,fe(n)])):e}var Mt=new re(0),fn=new re(1),Ia=new re(2),Ba=new re(3),La=new re(5),Kt=new re(10),Na=new re(100),Ca=new re(1e3),Ma=new re(1e4);function Ct(e){return Kt.pow(K(e))}import{PublicKey as Oa}from"@solana/web3.js";import{MINT_SIZE as qa,TOKEN_PROGRAM_ID as Ua,getTransferFeeConfig as Ga,unpackMint as Ha}from"@solana/spl-token";var ja=O("Raydium_accountInfo_util");import{PublicKey as $a}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as tu}from"@solana/spl-token";import{PublicKey as k}from"@solana/web3.js";var ou=new k("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),su=new k("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),au=new k("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),uu=new k("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),cu=new k("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),lu=new k("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),mu=new k("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),pu=new k("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),fu=new k("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),du=new k("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),gu=new k("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),bu=new k("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),hu=new k("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),yu=new k("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Tu=new k("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),wu=new k("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Pu=new k("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),xu=new k("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Au=new k("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),ku=new k("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Su=new k("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Iu=new k("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),jr=new k("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),Qr=new k("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),zr=new k("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),Bu=new k("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Zr=new k("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),Lu=new k("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Yr=new k("7AFUeLVRjBfzqK3tTGw8hN48KLQWSk6DTE8xprWdPqix"),Nu=new k("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Cu=new k("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Xr=new k("LanD8FpTBBvzZFXjTxsAoipkFsxPUCDB4qAqKxYDiNP"),Jr=new k("HYNHiyKJ3gGVFvyxJAurK7qr7P2o5J9THmvCGMdULtpW");var Mu={SERUM_MARKET:k.default,OPENBOOK_MARKET:new k("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:k.default,FarmV3:new k("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new k("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new k("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new k("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new k("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new k("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),CLMM_LOCK_PROGRAM_ID:new k("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),CLMM_LOCK_AUTH_ID:new k("8qmHNvu2Kr2C7U8mJL4Vz1vTDxMhVuXKREwU7TNoaVEo"),Router:new k("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:jr,CREATE_CPMM_POOL_AUTH:Qr,CREATE_CPMM_POOL_FEE_ACC:zr,FEE_DESTINATION_ID:new k("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR"),LOCK_CPMM_PROGRAM:Zr,LCOK_CPMM_AUTH:Yr,LAUNCHPAD_PROGRAM:Xr,LAUNCHPAD_AUTH:Jr};import Ru from"bn.js";import{PublicKey as $r,AddressLookupTableAccount as dn}from"@solana/web3.js";var ei={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new dn({key:new $r("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:dn.deserialize(Buffer.from("AQAAAP//////////I1rcEwAAAAAvAQYwun9CU6c5Ikm2pAj+D9IEnCOR45nK+SFTGSdpd6J6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBt324e51j94YQl285GzN2rYa/E2DuQ0n/r35KNihi/wFSlNQ+F3IgtYUpVZyeIopbd8eq6vQpgZ4iEky9O72oAVKU1qZKSEGTSTocWDaOHx8NbXdvJK7geQfqEBBBUSNBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvBkX2T9y7AHdNGviJAqQNtlDUDCnauQRWybsLji6nPM8Qkw5asQRvCdB3MbX6IEBwytOrpM32l4jQygKG9TKgR0vZScQ2AsM/IHeQ7RajUkyhuZdc8SGiqQz/7H34torNR/Wir3sl0ruUrVxJWEZfUg+QLNAxxODdBi53/OP7Ioil1cqeBM9dtZC3FLov4yyxWRM/wcGStyJX/QfTnLBAHqkqWotPKVlShCVQqpP9W5W1rOao65IMk5QuQ2kMIOxzDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu/YsA/yfEEFGcr8Z57VKDw8uQzpiru7g4lvjnfapW62W030syevD8k07SGoxUHiuT/ai7gAHWWhDsVmg/C63ajgpkH7Sn3GdutArDTfyqOkdqv4/IPC/EFFy7mGkfDd2C57N5a/4jC+BbmJy7wQaSEZr0CQU88lPtUxIVvzGjC95b8Ooss2TqmkrayGKofkPMGQn7Ux+9lfwBSNfxwH8NgbpqC/7LNlV4I7nCvsXf3p+ohQk9NrAJb2KAFpUqEIJ9ZBV7BYDzHF/ORKYlgtvPnXjudZQ6CEo5OzUDaNIomTCCsvhD16TxJjsbgne1kGnQPCFSoaxUbq2V1bPMFQ3VYP6wDZ9bKStCFKx9A3tNbwZFC5ZGAN83MFK7XoTy+OmmcFEr6rLOjfSuTfPvHJkSVxW6Qllwkl67XcBi5v00u2gQsbu+38sp+rd5pA/LvyWj4P94ZGZwc1tE2P88xekCLcAwZGb+UhFzL/7K26csOb57yM5bvF9xJrLEObOkAAAAAn+HWRkdcPKyFFMnVwEoD7vnD0jCKFIU1sImubYCxNTSVzsKpaQX+fzNxrLAI3L14JQnJx/D6Uk2LADIHGqnGELzjEbkBDAlaM77NkXMPfqXNLSveCkWI7UEgNs31WEWB6XHSYI/v5DklHOb4QTtDOR804PVbi3fjloZeLR2F8d4FuZmMMO7ck3Fnkn2zEMG5gOmqsygb6PjTitArVl52NhcSznTxVnguaIJxiZkAnurDmn3MWR0PC2GLghp2KJqHCc6QQ85odeIjFHKOlRlJyeSXVJmL8vb1UgOzsbJPVP8p6zM4M3C1Sd7uWIHP33G42AP2Zg8ucn/n6meQjjD266JgCWdxZD6PXs9CsnIeL7SSG0/6lGb9xfP0ZcWkCXB/3hjxHYVXjra/GPOeXGk0fLLKjCbk+mgs2w6d2oCwimBipTzuoZ30GiI8ij8VRzD5CzMWtu2m21eDBIfjGAEo4pQeNNonKcqzV/cleX8ySZLOHsz8PtBCrLqF+VkLm9hOzIT+6i/nIf6keR4GWKMOD4AvqfpjHoD4DuhBpz8P28+DxkGrDXXr/nr20x291VPvcTU/b+b+o2kC9G0kcXeTlLjU6a2TQXWlZ4gBUdBl1jgT7mObSTpLblNiXZsLkbmVXZwvFKXua5cUKlWed/w30skmEUraTuQqtqr5fHZPW9n57EmeTif6LjHL2YJFZkQU+TrJmFzqzmF4/b8OwrPQAprl8mX3q4LUIdAS/a+11B6DWD1Xk2++Sn94dLC4xjkO4Wtlw8c4XuzciVbepHOmnoWzVu/0y3KCrLCSfQxQ3br8DJCoVzhgtPsS2nZZjsBGIZgnU0QpMv+2MnRsnKwdp1VsrCX84j/qvaZn4WhKunippgTbN2EUs0tPTP55Qfgj+nKmjtWW5IYs72FrEwJKYoNfsmqaF4o5pf4v9zgPwVwY/5I4XJKUL2L25m9kAQcW/K+H1RTFEUoj8Z4ajpOmAB/dG0COmCphVMW2CCMvnxhcGiSgPnpDuWu6qiJ7NG7ye5kvHgefgqPLeicspNJ5EpL3XiRNLM2tmJLI1awAwOyd6iHv0dCkMYRKaa6rcaZeYwmKCkckm0kM2JNmnmmAaBQQ7mwmIM0IMxX4f5W6j9PqZWcJxF7r17T/lQBAmcjoupRiJifbnXCNUv9GhpRF19WcBdeKbivRJVlGop6I2RS6lGImJ9udcI1S/0aGlEXX1ZwF14puK9ElWUainojZFYVHLHD6dIP2ESjqBzg3ol1/wB7+/ylGwd9LS7wSZ2A630CJSVKwH47K9P4bB8PEQP8BwjMFa7xQHOqZFP1XqaQ==","base64"))})};import{PublicKey as Ju,sendAndConfirmTransaction as $u,SystemProgram as nc,Transaction as rc,TransactionMessage as oc,VersionedTransaction as sc}from"@solana/web3.js";import uc from"axios";import ti from"bn.js";var gc=new ti(1e6);var ri=O("Raydium_amount"),gn=Ee(ni);function ii(e,t){let n="0",r="0";if(e.includes(".")){let i=e.split(".");i.length===2?([n,r]=i,r=r.padEnd(t,"0")):ri.logWithError(`invalid number string, num: ${e}`)}else n=e;return[n,r.slice(0,t)||r]}var Y=class extends B{token;logger;constructor(t,n,r=!0,i){let o=new Je(0),s=Kt.pow(new Je(t.decimals));if(r)o=K(n);else{let a=new Je(0),c=new Je(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[u,l]=ii(n.toString(),t.decimals);a=K(u),c=K(l)}a=a.mul(s),o=a.add(c)}super(o,s),this.logger=O(i||"TokenAmount"),this.token=t}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(t){return this.token.equals(t.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(t.raw)}lt(t){return this.token.equals(t.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(t.raw)}add(t){return this.token.equals(t.token)||this.logger.logWithError("add token not equals"),new Y(this.token,this.raw.add(t.raw))}subtract(t){return this.token.equals(t.token)||this.logger.logWithError("sub token not equals"),new Y(this.token,this.raw.sub(t.raw))}toSignificant(t=this.token.decimals,n,r=0){return super.toSignificant(t,n,r)}toFixed(t=this.token.decimals,n,r=0){return t>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(t,n,r)}toExact(t={groupSeparator:""}){return gn.DP=this.token.decimals,new gn(this.numerator.toString()).div(this.denominator.toString()).toFormat(t)}};var $e=({address:e,programId:t,decimals:n,...r})=>({chainId:101,address:St(e).toBase58(),programId:t,logoURI:"",symbol:"",name:"",decimals:n,tags:[],extensions:r.extensions||{},...r});import{PublicKey as N,SystemProgram as Tn,SYSVAR_RENT_PUBKEY as hi,TransactionInstruction as ie}from"@solana/web3.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as yi,TOKEN_PROGRAM_ID as Se}from"@solana/spl-token";import{PublicKey as oi}from"@solana/web3.js";var ke=new oi("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ge=5e4,si=D([d("x"),d("y"),d("price")]),ai=D([d("accountType"),d("status"),d("multiplier"),d("validDataCount"),Be(si,ge,"DataElement")]);function ui(e,t){return[0,ge-2]}function ci(e){return[0,ge-2]}function li(e){return[0,ge-2]}function mi(e,t,n){let[r,i]=ui(t,n),o=r,s=i,a=0,c=t*e.multiplier/n;for(;o<=s;){if(a=Math.floor((s+o)/2),a===0||a>=ge-2)return[a,a,!1];let u=e.DataElement[a].x*e.multiplier/e.DataElement[a].y,l=e.DataElement[a-1].x*e.multiplier/e.DataElement[a-1].y,m=e.DataElement[a+1].x*e.multiplier/e.DataElement[a+1].y;if(c===u)return[a,a,!0];if(c===l)return[a-1,a-1,!0];if(c===m)return[a+1,a+1,!0];if(c<l)s=a-1;else{if(c>l&&c<u)return[a-1,a,!0];if(c>u&&c<m)return[a,a+1,!0];o=a+1}}return[a,a,!1]}function Et(e,t,n){let[r,i,o]=mi(e,t,n);if(!o)return 0;if(r===i){let s=e.DataElement[r].x;return t*e.multiplier/s}else{let s=e.DataElement[r].x,a=e.DataElement[r].y,c=e.DataElement[i].x,u=e.DataElement[i].y,l=n*(c*a-s*u),m=s*l,p=(c-s)*(t*a-s*n)*u,b=m+p;return t*e.multiplier*l/b}}function de(e,t,n){return t*e.multiplier/n}function bn(e,t,n){return t*n/e.multiplier}function pi(e,t){let[n,r]=ci(t),i=n,o=r,s=0,a=t;for(;i<o;){if(s=Math.floor((o+i)/2),s<=0||s>ge-2)return[s,s,!1];let c=e.DataElement[s].x,u=e.DataElement[s-1].x,l=e.DataElement[s+1].x;if(a===c)return[s,s,!0];if(a===u)return[s-1,s-1,!0];if(a===l)return[s+1,s+1,!0];if(a<u)o=s-1;else{if(a>u&&a<c)return[s-1,s,!0];if(a>c&&a<l)return[s,s+1,!0];i=s+1}}return[s,s,!1]}function fi(e,t){let[n,r]=li(t),i=n,o=r,s=0,a=t;for(;i<=o;){if(s=Math.floor((o+i)/2),s<=0||s>=ge-2)return[s,s,!1];let c=e.DataElement[s].y,u=e.DataElement[s-1].y,l=e.DataElement[s+1].y;if(a===c)return[s,s,!0];if(a===u)return[s-1,s-1,!0];if(a===l)return[s+1,s+1,!0];if(a<l)i=s+1;else{if(a<u&&a>c)return[s-1,s,!0];if(a<c&&a>l)return[s,s+1,!0];o=s-1}}return[s,s,!1]}function hn(e,t,n,r){let i=r?t+n:t-n,[o,s,a]=pi(e,i);if(!a)return[0,0,!1,a];if(o===s)return[e.DataElement[s].price,e.DataElement[s].y,!1,a];{let c=e.DataElement[o].x,u=e.DataElement[s].x,l=e.DataElement[o].price,m=e.DataElement[s].price,p=e.DataElement[o].y,b=e.DataElement[s].y;if(t>=c&&t<=u)return r?[m,b,!0,a]:[l,p,!0,a];{let w,h;return r?(w=l+(m-l)*(t-c)/(u-c),h=p-(i-c)*e.multiplier/m):(w=l+(m-l)*(t-c)/(u-c),h=b+(u-i)*e.multiplier/l),[w,h,!1,a]}}}function di(e,t,n,r){let i=r?t-n:t+n,[o,s,a]=fi(e,i);if(!a)return[0,0,!1,a];if(o===s)return[e.DataElement[s].price,e.DataElement[s].x,!1,a];{let c=e.DataElement[o].x,u=e.DataElement[s].x,l=e.DataElement[o].price,m=e.DataElement[s].price,p=e.DataElement[o].y,b=e.DataElement[s].y;if(t>=b&&t<=p)return r?[m,u,!0,a]:[l,c,!0,a];{let w,h;return r?(w=l+(m-l)*(p-t)/(p-b),h=c+m*(p-i)/e.multiplier):(w=l+(m-l)*(p-t)/(p-b),h=u-l*(i-b)/e.multiplier),[w,h,!1,a]}}}function gi(e,t){let n=hn(e,t,0,!1);return n[3]?n[0]:0}function bl(e,t,n,r){let i=Et(e,t,n),o=de(e,t,i),s=de(e,n,i),a=de(e,r,i),c=!0,[u,l,m,p]=hn(e,o,a,c);if(!p)return 0;if(m)return r*e.multiplier/u;{let b=s-l;return bn(e,b,i)}}function hl(e,t,n,r){let i=Et(e,t,n),o=de(e,t,i),s=de(e,n,i),a=de(e,r,i),c=!1,[u,l,m,p]=di(e,s,a,c);if(!p)return 0;if(m)return r*u/e.multiplier;{let b=o-l;return bn(e,b,i)}}function bi(e){let t=ai.decode(e);return{accountType:t.accountType.toNumber(),status:t.status.toNumber(),multiplier:t.multiplier.toNumber(),validDataCount:t.validDataCount.toNumber(),DataElement:t.DataElement.map(n=>({x:n.x.toNumber(),y:n.y.toNumber(),price:n.price.toNumber()}))}}function yl(e,t,n,r){let i=gi(e,de(e,t,Et(e,t,n)))/e.multiplier;return r?i:1/i}var et=class{connection;_layoutData={accountType:0,status:0,multiplier:0,validDataCount:0,DataElement:[]};constructor({connection:t}){this.connection=t}get stableModelData(){return this._layoutData}async initStableModelLayout(){if(this._layoutData.validDataCount===0&&this.connection){let t=await this.connection.getAccountInfo(ke);t&&(this._layoutData=bi(t?.data))}}};var yn=O("Raydium_liquidity_instruction");function Cl(e){let{poolInfo:t,poolKeys:n,userKeys:r,baseAmountIn:i,quoteAmountIn:o,fixedSide:s,otherAmountMin:a}=e,c=Buffer.alloc(mt.span);mt.encode({instruction:3,baseAmountIn:K(i),quoteAmountIn:K(o),otherAmountMin:K(a),fixedSide:s==="base"?Mt:fn},c);let u=[f({pubkey:Se,isWritable:!1}),f({pubkey:new N(t.id)}),f({pubkey:new N(n.authority),isWritable:!1}),f({pubkey:new N(n.openOrders),isWritable:!1}),f({pubkey:new N(n.targetOrders)}),f({pubkey:new N(t.lpMint.address)}),f({pubkey:new N(n.vault.A)}),f({pubkey:new N(n.vault.B)})];return t.pooltype.includes("StablePool")&&u.push(f({pubkey:ke})),u.push(f({pubkey:new N(t.marketId),isWritable:!1}),f({pubkey:r.baseTokenAccount}),f({pubkey:r.quoteTokenAccount}),f({pubkey:r.lpTokenAccount}),f({pubkey:r.owner,isWritable:!1,isSigner:!0}),f({pubkey:new N(n.marketEventQueue),isWritable:!1})),new ie({programId:new N(t.programId),keys:u,data:c})}function Ml(e){let{poolInfo:t,poolKeys:n,userKeys:r,lpAmount:i,baseAmountMin:o,quoteAmountMin:s}=e,a=fe(n),c=4;if(t.pooltype.includes("StablePool")&&(c=5),c===4||c===5){let u=Buffer.alloc(pt.span);pt.encode({instruction:4,lpAmount:K(i),baseAmountMin:K(o),quoteAmountMin:K(s)},u);let l=[f({pubkey:Se,isWritable:!1}),f({pubkey:a.id}),f({pubkey:a.authority,isWritable:!1}),f({pubkey:a.openOrders}),f({pubkey:a.targetOrders}),f({pubkey:a.mintLp.address}),f({pubkey:a.vault.A}),f({pubkey:a.vault.B})];return c===5?l.push(f({pubkey:ke})):(l.push(f({pubkey:a.id})),l.push(f({pubkey:a.id}))),l.push(f({pubkey:a.marketProgramId,isWritable:!1}),f({pubkey:a.marketId}),f({pubkey:a.marketBaseVault}),f({pubkey:a.marketQuoteVault}),f({pubkey:a.marketAuthority,isWritable:!1}),f({pubkey:r.lpTokenAccount}),f({pubkey:r.baseTokenAccount}),f({pubkey:r.quoteTokenAccount}),f({pubkey:r.owner,isWritable:!1,isSigner:!0}),f({pubkey:a.marketEventQueue}),f({pubkey:a.marketBids}),f({pubkey:a.marketAsks})),new ie({programId:a.programId,keys:l,data:u})}return new ie({programId:a.programId,keys:[]})}function Kl({programId:e,ammId:t,ammAuthority:n,ammOpenOrders:r,lpMint:i,coinMint:o,pcMint:s,coinVault:a,pcVault:c,withdrawQueue:u,ammTargetOrders:l,poolTempLp:m,marketProgramId:p,marketId:b,userWallet:w,userCoinVault:h,userPcVault:R,userLpVault:L,nonce:W,openTime:I,coinAmount:V,pcAmount:he,ammConfigId:H,feeDestinationId:Ie}){let le=D([v("instruction"),v("nonce"),d("openTime"),d("pcAmount"),d("coinAmount")]),me=[{pubkey:Se,isSigner:!1,isWritable:!1},{pubkey:yi,isSigner:!1,isWritable:!1},{pubkey:Tn.programId,isSigner:!1,isWritable:!1},{pubkey:cn,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:H,isSigner:!1,isWritable:!1},{pubkey:Ie,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!0,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:R,isSigner:!1,isWritable:!0},{pubkey:L,isSigner:!1,isWritable:!0}],ye=Buffer.alloc(le.span);return le.encode({instruction:1,nonce:W,openTime:I,coinAmount:V,pcAmount:he},ye),{instruction:new ie({keys:me,programId:e,data:ye}),instructionType:Ce.AmmV4CreatePool}}function El(e){let t=D([v("instruction"),v("simulateType")]),n=Buffer.alloc(t.span);t.encode({instruction:12,simulateType:0},n);let r=[f({pubkey:new N(e.id),isWritable:!1}),f({pubkey:new N(e.authority),isWritable:!1}),f({pubkey:new N(e.openOrders),isWritable:!1}),f({pubkey:new N(e.vault.A),isWritable:!1}),f({pubkey:new N(e.vault.B),isWritable:!1}),f({pubkey:new N(e.mintLp.address),isWritable:!1}),f({pubkey:new N(e.marketId),isWritable:!1}),f({pubkey:new N(e.marketEventQueue),isWritable:!1})];return new ie({programId:new N(e.programId),keys:r,data:n})}function Ti({poolKeys:e,userKeys:t,amountIn:n,minAmountOut:r},i){let o=fe(e),s=Buffer.alloc(at.span);at.encode({instruction:9,amountIn:K(n),minAmountOut:K(r)},s);let a=[f({pubkey:Se,isWritable:!1}),f({pubkey:o.id}),f({pubkey:o.authority,isWritable:!1}),f({pubkey:o.openOrders})];return i===4&&a.push(f({pubkey:o.targetOrders})),a.push(f({pubkey:o.vault.A}),f({pubkey:o.vault.B})),i===5&&a.push(f({pubkey:ke})),a.push(f({pubkey:o.marketProgramId,isWritable:!1}),f({pubkey:o.marketId}),f({pubkey:o.marketBids}),f({pubkey:o.marketAsks}),f({pubkey:o.marketEventQueue}),f({pubkey:o.marketBaseVault}),f({pubkey:o.marketQuoteVault}),f({pubkey:o.marketAuthority,isWritable:!1}),f({pubkey:t.tokenAccountIn}),f({pubkey:t.tokenAccountOut}),f({pubkey:t.owner,isWritable:!1,isSigner:!0})),new ie({programId:o.programId,keys:a,data:s})}function wi({poolKeys:e,userKeys:t,maxAmountIn:n,amountOut:r},i){let o=fe(e),s=Buffer.alloc(ut.span);ut.encode({instruction:11,maxAmountIn:K(n),amountOut:K(r)},s);let a=[f({pubkey:Se,isWritable:!1}),f({pubkey:o.id}),f({pubkey:o.authority,isWritable:!1}),f({pubkey:o.openOrders}),f({pubkey:o.targetOrders}),f({pubkey:o.vault.A}),f({pubkey:o.vault.B})];return i===5&&a.push(f({pubkey:ke})),a.push(f({pubkey:o.marketProgramId,isWritable:!1}),f({pubkey:o.marketId}),f({pubkey:o.marketBids}),f({pubkey:o.marketAsks}),f({pubkey:o.marketEventQueue}),f({pubkey:o.marketBaseVault}),f({pubkey:o.marketQuoteVault}),f({pubkey:o.marketAuthority,isWritable:!1}),f({pubkey:t.tokenAccountIn}),f({pubkey:t.tokenAccountOut}),f({pubkey:t.owner,isWritable:!1,isSigner:!0})),new ie({programId:o.programId,keys:a,data:s})}function Rl(e){let{poolKeys:t,version:n,userKeys:r,amountIn:i,amountOut:o,fixedSide:s}=e;if(n===4||n===5){let a={poolKeys:t,userKeys:r};if(s==="in")return Ti({...a,amountIn:i,minAmountOut:o},n);if(s==="out")return wi({...a,maxAmountIn:i,amountOut:o},n);yn.logWithError("invalid params","params",e)}throw yn.logWithError("invalid version","poolKeys.version",n),new Error("invalid version")}function vl({poolKeys:e,userKeys:t,startTime:n}){let r=Buffer.alloc(ct.span);ct.encode({instruction:0,nonce:5,startTime:K(n)},r);let i=fe(e),o=[f({pubkey:Se,isWritable:!1}),f({pubkey:Tn.programId,isWritable:!1}),f({pubkey:hi,isWritable:!1}),f({pubkey:i.id}),f({pubkey:i.authority,isWritable:!1}),f({pubkey:i.openOrders}),f({pubkey:i.mintLp.address}),f({pubkey:i.mintA.address,isWritable:!1}),f({pubkey:i.mintB.address,isWritable:!1}),f({pubkey:i.vault.A,isWritable:!1}),f({pubkey:i.vault.B,isWritable:!1}),f({pubkey:i.id}),f({pubkey:i.targetOrders}),f({pubkey:t.lpTokenAccount}),f({pubkey:i.id,isWritable:!1}),f({pubkey:i.marketProgramId,isWritable:!1}),f({pubkey:i.marketId,isWritable:!1}),f({pubkey:t.payer,isSigner:!0})];return new ie({programId:i.programId,keys:o,data:r})}function wn({poolKeys:e}){let t=D([v("instruction"),v("simulateType")]),n=Buffer.alloc(t.span);t.encode({instruction:12,simulateType:0},n);let r=[f({pubkey:new N(e.id),isWritable:!1}),f({pubkey:new N(e.authority),isWritable:!1}),f({pubkey:new N(e.openOrders),isWritable:!1}),f({pubkey:new N(e.vault.A),isWritable:!1}),f({pubkey:new N(e.vault.B),isWritable:!1}),f({pubkey:new N(e.mintLp.address),isWritable:!1}),f({pubkey:new N(e.marketId),isWritable:!1}),f({pubkey:new N(e.marketEventQueue),isWritable:!1})];return{instruction:new ie({programId:new N(e.programId),keys:r,data:n})}}import{PublicKey as Pi}from"@solana/web3.js";var xi=O("Raydium_liquidity_serum");function Pn({programId:e,marketId:t}){let n=[t.toBuffer()],r=0,i;for(;r<100;){try{let o=n.concat(Buffer.from([r]),Buffer.alloc(7));i=Pi.createProgramAddressSync(o,e)}catch(o){if(o instanceof TypeError)throw o;r++;continue}return{publicKey:i,nonce:r}}throw xi.logWithError("unable to find a viable program address nonce","params",{programId:e,marketId:t}),new Error("unable to find a viable program address nonce")}var ve=D([S("mint"),S("owner"),d("amount"),pe("delegateOption"),S("delegate"),v("state"),pe("isNativeOption"),d("isNative"),d("delegatedAmount"),pe("closeAuthorityOption"),S("closeAuthority")]);import{Keypair as Ql,PublicKey as zl}from"@solana/web3.js";import Xl from"bn.js";import{TOKEN_PROGRAM_ID as em}from"@solana/spl-token";var nm=O("Raydium_Util");import{PublicKey as um,SystemProgram as lm}from"@solana/web3.js";import fm from"bn.js";import{createCloseAccountInstruction as hm,createInitializeAccountInstruction as ym,createTransferInstruction as Tm,TOKEN_PROGRAM_ID as wm}from"@solana/spl-token";var xn=D([pe("mintAuthorityOption"),S("mintAuthority"),d("supply"),v("decimals"),v("isInitialized"),pe("freezeAuthorityOption"),S("freezeAuthority")]);function An({programId:e}){let{publicKey:t}=xe([Buffer.from("amm_config_account_seed","utf-8")],e);return t}function be({name:e,programId:t,marketId:n}){let{publicKey:r}=xe([t.toBuffer(),n.toBuffer(),Buffer.from(e,"utf-8")],t);return r}function ki({programId:e,marketId:t}){let{publicKey:n}=xe([e.toBuffer(),t.toBuffer(),Buffer.from("open_order_associated_seed","utf-8")],e);return n}function Si({programId:e}){return xe([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],e)}function Xm({version:e,marketVersion:t,marketId:n,baseMint:r,quoteMint:i,baseDecimals:o,quoteDecimals:s,programId:a,marketProgramId:c}){let u=be({name:"amm_associated_seed",programId:a,marketId:n}),l=be({name:"lp_mint_associated_seed",programId:a,marketId:n}),{publicKey:m,nonce:p}=Si({programId:a}),b=be({name:"coin_vault_associated_seed",programId:a,marketId:n}),w=be({name:"pc_vault_associated_seed",programId:a,marketId:n}),h=be({name:"temp_lp_token_associated_seed",programId:a,marketId:n}),R=ki({programId:a,marketId:n}),L=be({name:"target_associated_seed",programId:a,marketId:n}),W=be({name:"withdraw_associated_seed",programId:a,marketId:n}),{publicKey:I}=Pn({programId:c,marketId:n});return{id:u,baseMint:r,quoteMint:i,lpMint:l,baseDecimals:o,quoteDecimals:s,lpDecimals:o,version:e,programId:a,authority:m,nonce:p,baseVault:b,quoteVault:w,lpVault:h,openOrders:R,targetOrders:L,withdrawQueue:W,marketVersion:t,marketProgramId:c,marketId:n,marketAuthority:I,lookupTableAccount:_e.default,configId:An({programId:a})}}var Rt;async function Jm({connection:e,poolKeysList:t,config:n}){return t.find(i=>i.modelDataAccount)&&(Rt||(Rt=new et({connection:e}),await Rt.initStableModelLayout())),await Promise.all(t.map(async i=>{if(i.modelDataAccount){let o=wn({poolKeys:i});return(await on(e,[o.instruction],"GetPoolData")).map(c=>{let u=sn(c,"GetPoolData"),l=new De(ee(u,"status")),m=Number(ee(u,"coin_decimals")),p=Number(ee(u,"pc_decimals")),b=Number(ee(u,"lp_decimals")),w=new De(ee(u,"pool_coin_amount")),h=new De(ee(u,"pool_pc_amount")),R=new De(ee(u,"pool_lp_supply")),L="0";try{L=ee(u,"pool_open_time")}catch{}return{status:l,baseDecimals:m,quoteDecimals:p,lpDecimals:b,baseReserve:w,quoteReserve:h,lpSupply:R,startTime:new De(L)}})[0]}else{let[o,s,a,c]=await e.getMultipleAccountsInfo([new _e(i.id),new _e(i.vault.A),new _e(i.vault.B),new _e(i.mintLp.address)]);if(o===null)throw Error("fetch pool error");if(s===null)throw Error("fetch vaultAccA error");if(a===null)throw Error("fetch vaultAccB error");if(c===null)throw Error("fetch mintAccLp error");let u=lt.decode(o.data),l=ve.decode(s.data),m=ve.decode(a.data),p=xn.decode(c.data);return{status:u.status,baseDecimals:u.baseDecimal.toNumber(),quoteDecimals:u.quoteDecimal.toNumber(),lpDecimals:p.decimals,baseReserve:l.amount.sub(u.baseNeedTakePnl),quoteReserve:m.amount.sub(u.quoteNeedTakePnl),lpSupply:u.lpReserve,startTime:u.poolOpenTime}}}))}var vt={volume:0,volumeQuote:0,volumeFee:0,apr:0,feeApr:0,priceMin:0,priceMax:0,rewardApr:[]},$m=e=>{let t={},n=Ai.toBase58();return Object.keys(e).map(r=>{let i=e[r],[o,s]=[i.baseMint.toBase58(),i.quoteMint.toBase58()];t[r]={id:r,version:4,status:i.status.toNumber(),programId:i.programId.toBase58(),mintA:$e({address:o,programId:n,decimals:i.baseDecimal.toNumber()}),mintB:$e({address:s,programId:n,decimals:i.quoteDecimal.toNumber()}),rewardDefaultInfos:[],rewardDefaultPoolInfos:"Ecosystem",price:i.poolPrice.toNumber(),mintAmountA:new Pe(i.mintAAmount.toString()).div(10**i.baseDecimal.toNumber()).toNumber(),mintAmountB:new Pe(i.mintBAmount.toString()).div(10**i.quoteDecimal.toNumber()).toNumber(),baseReserve:i.baseReserve,quoteReserve:i.quoteReserve,feeRate:new Pe(i.tradeFeeNumerator.toString()).div(i.tradeFeeDenominator.toString()).toNumber(),openTime:i.poolOpenTime.toString(),tvl:0,day:vt,week:vt,month:vt,pooltype:[],farmUpcomingCount:0,farmOngoingCount:0,farmFinishedCount:0,type:"Standard",marketId:i.marketId.toBase58(),configId:An({programId:i.programId}).toBase58(),lpPrice:0,lpAmount:new Pe(i.lpReserve.toString()).div(10**Math.min(i.baseDecimal.toNumber(),i.quoteDecimal.toNumber())).toNumber(),lpMint:$e({address:i.lpMint.toBase58(),programId:n,decimals:Math.min(i.baseDecimal.toNumber(),i.quoteDecimal.toNumber())}),burnPercent:0}}),t};export{si as DataElement,Ni as LIQUIDITY_FEES_DENOMINATOR,Li as LIQUIDITY_FEES_NUMERATOR,In as LIQUIDITY_VERSION_TO_SERUM_VERSION,Do as LIQUIDITY_VERSION_TO_STATE_LAYOUT,ke as MODEL_DATA_PUBKEY,et as StableLayout,mt as addLiquidityLayout,_o as createPoolFeeLayout,Kl as createPoolV4InstructionV2,vo as createPoolV4Layout,Jm as fetchMultipleInfo,at as fixedSwapInLayout,ut as fixedSwapOutLayout,bi as formatLayout,An as getAssociatedConfigId,ki as getAssociatedOpenOrders,Xm as getAssociatedPoolKeys,hl as getDxByDyBaseIn,bl as getDyByDxBaseIn,Si as getLiquidityAssociatedAuthority,be as getLiquidityAssociatedId,yl as getStablePrice,ct as initPoolLayout,lt as liquidityStateV4Layout,En as liquidityStateV5Layout,Rl as makeAMMSwapInstruction,Cl as makeAddLiquidityInstruction,vl as makeInitPoolInstructionV4,wn as makeSimulatePoolInfoInstruction,Ti as makeSwapFixedInInstruction,wi as makeSwapFixedOutInstruction,ai as modelDataInfoLayout,Ml as removeLiquidityInstruction,pt as removeLiquidityLayout,El as simulatePoolInfoInstruction,$m as toAmmComputePoolInfo};
//# sourceMappingURL=index.mjs.map